
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.8">
    
    
      
        <title>四. 正则化 - 大白的知识库</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.644de097.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../.." title="大白的知识库" class="md-header__button md-logo" aria-label="大白的知识库" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            大白的知识库
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              四. 正则化
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="搜索" placeholder="搜索" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="查找">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="清空当前内容" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            正在初始化搜索引擎
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      首页
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        机器学习
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../math%20in%20ML/" class="md-tabs__link">
        机器学习中的数学知识
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="大白的知识库" class="md-nav__button md-logo" aria-label="大白的知识库" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    大白的知识库
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        首页
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          机器学习
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="机器学习" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          机器学习
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        前言和目录
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.%20linear%20regression-1%20v/" class="md-nav__link">
        一. 单变量线性回归
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../2.%20linear%20regression-m%20v/" class="md-nav__link">
        二. 多变量线性回归
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../3.%20logistic%20regression/" class="md-nav__link">
        三. 逻辑回归
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          四. 正则化
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        四. 正则化
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1、过拟合问题
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2、代价函数
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3、线性回归正则化
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4、逻辑回归正则化
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          机器学习中的数学知识
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="机器学习中的数学知识" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          机器学习中的数学知识
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../math%20in%20ML/" class="md-nav__link">
        前言和目录
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../math%20in%20ML/1.%20M%20derivation%20essence/" class="md-nav__link">
        一. 矩阵求导本质
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../math%20in%20ML/2.%20M%20derivation/" class="md-nav__link">
        二. 矩阵求导
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1、过拟合问题
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2、代价函数
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3" class="md-nav__link">
    3、线性回归正则化
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4" class="md-nav__link">
    4、逻辑回归正则化
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


  <h1>四. 正则化</h1>

<div class="admonition info">
<p>参考链接:
https://scruel.gitee.io/ml-andrewng-notes/week3.html</p>
</div>
<!--
下面这个css用于控制p标签的两端对齐
-->
<style type="text/css">
p {
    text-align: justify;  /*文本两端对齐*/
}
center img{
    border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);
}
center div{
    color:orange; 
    border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;
}
</style>

<h2 id="1">1、过拟合问题</h2>
<div class="admonition info">
<p>参考视频:
7 - 1 - The Problem of Overfitting (10 min).mkv</p>
</div>
<p>对于拟合的表现，可以分为三类情况：</p>
<ul>
<li>
<p>欠拟合(Underfitting)</p>
<p>无法很好的拟合训练集中的数据，预测值和实际值的误差很大，这类情况被称为欠拟合。拟合模型比较简单（特征选少了）时易出现这类情况。类似于，你上课不好好听，啥都不会，下课也差不多啥都不会。</p>
</li>
<li>
<p>优良的拟合(Just right)</p>
<p>不论是训练集数据还是不在训练集中的预测数据，都能给出较为正确的结果。类似于，学霸学神！</p>
</li>
<li>
<p>过拟合(Overfitting)</p>
<p>能很好甚至完美拟合训练集中的数据，即 <span class="arithmatex">\(J(\theta)\)</span>
，但是对于不在训练集中的<strong>新数据</strong>，预测值和实际值的误差会很大，<strong>泛化能力弱</strong>，这类情况被称为过拟合。拟合模型过于复杂（特征选多了）时易出现这类情况。类似于，你上课跟着老师做题都会都听懂了，下课遇到新题就懵了不会拓展。</p>
</li>
</ul>
<p>线性模型中的拟合情况(左图欠拟合，右图过拟合):</p>
<p><center>
    <img src="../../assets/images/4_1_1.png">
    <br>
    <div>图4.1.1 线性回归中的拟合情况</div>
</center></p>
<p>逻辑回归模型中的拟合情况:</p>
<p><center>
    <img src="../../assets/images/4_1_2.png">
    <br>
    <div>图4.1.2 逻辑回归中的拟合情况</div>
</center></p>
<p>为了度量拟合表现，引入：</p>
<ul>
<li>
<p>偏差(bias)</p>
<p>指模型的预测值与真实值的<strong>偏离程度</strong>。偏差越大，预测值偏离真实值越厉害。偏差低意味着能较好地反应训练集中的数据情况。</p>
</li>
<li>
<p>方差(Variance)</p>
<p>指模型预测值的<strong>离散程度或者变化范围</strong>。方差越大，数据的分布越分散，函数波动越大，泛化能力越差。方差低意味着拟合曲线的稳定性高，波动小。</p>
</li>
</ul>
<p>高偏差意味着欠拟合，高方差意味着过拟合。</p>
<p>我们应尽量使得拟合模型处于低方差（较好地拟合数据）状态且同时处于低偏差（较好地预测新值）的状态。</p>
<p>避免过拟合的方法有：</p>
<ul>
<li>
<p>减少特征的数量</p>
<ul>
<li>
<p>手动选取需保留的特征</p>
</li>
<li>
<p>使用模型选择算法来选取合适的特征(如 PCA 算法)</p>
</li>
<li>
<p>减少特征的方式易丢失有用的特征信息</p>
</li>
</ul>
</li>
<li>
<p>正则化(Regularization)</p>
<ul>
<li>
<p>可保留所有参数（许多有用的特征都能轻微影响结果）</p>
</li>
<li>
<p>减少/惩罚各参数大小(magnitude)，以减轻各参数对模型的影响程度</p>
</li>
<li>
<p>当有很多参数对于模型只有轻微影响时，正则化方法的表现很好</p>
</li>
</ul>
</li>
</ul>
<h2 id="2">2、代价函数</h2>
<div class="admonition info">
<p>参考视频:
7 - 2 - Cost Function (10 min).mkv</p>
</div>
<p>很多时候由于特征数量过多, 过拟合时我们很难选出要保留的特征, 这时候应用正则化方法则是很好的选择。</p>
<p>上文中, <span class="arithmatex">\(\theta_0+\theta_1x+\theta_2x^2+\theta_3x^3+\theta_4x^4\)</span> 这样一个复杂的多项式比较容易过拟合, 在不减少特征的情况下, <strong>如果能消除类似于</strong> <span class="arithmatex">\(\theta_3x^3, \theta_4x^4\)</span> <strong>等复杂部分, 那复杂函数就变得简单了。</strong></p>
<p>为了保留各个参数的信息, 不修改假设函数, 改而修改代价函数:</p>
<div class="arithmatex">\[
\min_{\theta}\frac{1}{2m}\sum_{i=1}^m{\big( h_\theta(x^{(i)})-y^{(i)} \big)^2+1000\cdot \theta_3^2+1000\cdot \theta_4^2}
\]</div>
<p>上式中, 我们在代价函数中增加了 <span class="arithmatex">\(\theta_3, \theta_4\)</span> 的惩罚项(penalty term) <span class="arithmatex">\(1000\cdot \theta_3^2+1000\cdot \theta_4^2\)</span> , 如果要最小化代价函数, 那么势必需要极大地减小 <span class="arithmatex">\(\theta_3, \theta_4\)</span> , 从而使得假设函数中的 <span class="arithmatex">\(\theta_3x^3, \theta_4x^4\)</span> 这两项的参数非常小, 就相当于没有了, 假设函数也就"变得"简单了, 从而在保留各参数的情况下避免了过拟合问题。</p>
<p><center>
    <img src="../../assets/images/4_2_1.png">
    <br>
    <div>图4.2.1 正则化后的拟合情况</div>
</center></p>
<p>根据上面的讨论，有时也无法决定要减少哪个参数，故统一惩罚除了 <span class="arithmatex">\(\theta_0\)</span> 外的所有参数。(不惩罚 <span class="arithmatex">\(\theta_0\)</span> 是约定俗成的, 实际上惩罚和不惩罚的结果差不多)</p>
<p>代价函数：</p>
<div class="arithmatex">\[
J(\theta)=\frac{1}{2m}\bigg[\sum_{i=1}^m{\big( h_\theta(x^{(i)})-y^{(i)} \big)^2+\lambda \sum_{j=1}^n \theta_j^2}\bigg]
\]</div>
<blockquote>
<p><span class="arithmatex">\(\lambda\)</span>  正则化参数(Regularization Parameter), <span class="arithmatex">\(\lambda&gt;0\)</span></p>
<p><span class="arithmatex">\(\sum_{j=1}^n\)</span> : 不惩罚基础参数 <span class="arithmatex">\(\theta_0\)</span></p>
<p><span class="arithmatex">\(\lambda \sum_{j=1}^n \theta_j^2\)</span> : 正则化项</p>
</blockquote>
<p><span class="arithmatex">\(\lambda\)</span> 正则化参数类似于学习速率，也需要我们自行对其选择一个合适的值。</p>
<ul>
<li>
<p>过大</p>
<ul>
<li>
<p>导致模型欠拟合(假设可能会变成近乎 <span class="arithmatex">\(x=\theta_0\)</span> 的直线 )</p>
</li>
<li>
<p>无法正常去过拟问题</p>
</li>
<li>梯度下降可能无法收敛</li>
</ul>
</li>
<li>
<p>过小</p>
<ul>
<li>无法避免过拟合（等于没有）</li>
</ul>
</li>
</ul>
<h2 id="3">3、线性回归正则化</h2>
<div class="admonition info">
<p>参考视频:
7 - 3 - Regularized Linear Regression (11 min).mkv</p>
</div>
<p>Regularized linear regression</p>
<div class="arithmatex">\[
J(\theta)=\frac{1}{2m}\bigg[\sum_{i=1}^m{\big( h_\theta(x^{(i)})-y^{(i)} \big)^2+\lambda \sum_{j=1}^n \theta_j^2}\bigg]
\]</div>
<p>Goal:</p>
<div class="arithmatex">\[\min_{\theta}J(\theta)\]</div>
<p>首先是使用梯度下降法完成这个目标:</p>
<p>Repeat  {</p>
<div class="arithmatex">\[
\theta_0:=\theta_0-\alpha \frac{1}{m} \sum_{i=1}^m \big(h_\theta(x^{(i)})-y^{(i)} \big) x_0^{(i)}
\]</div>
<div class="arithmatex">\[
\theta_j:=\theta_j-\alpha \bigg [\frac{1}{m} \sum_{i=1}^m \big(h_\theta(x^{(i)})-y^{(i)} \big) x_j^{(i)}+ \frac{\lambda}{m} \theta_j \bigg ]
\]</div>
<p>其中, <span class="arithmatex">\(j\in \{1,2,\cdots ,n\}\)</span></p>
<p>}</p>
<blockquote>
<p>这里更新 <span class="arithmatex">\(\theta_j\)</span> 相比于没正则化只多了一项 <span class="arithmatex">\(\frac{\lambda}{m}\theta_j\)</span>, 大家仔细研究会发现就是 <span class="arithmatex">\(J(\theta)\)</span> 中一个平方项求导产生, 因为比较简单, 所以这里就不做推导了。</p>
</blockquote>
<p>上式的第二项也可以移项得到更新表达式的另一种形式</p>
<div class="arithmatex">\[
\theta_j:=\theta_j(1- \alpha \frac{\lambda}{m})- \alpha \frac{1}{m} \sum_{i=1}^m \big(h_\theta(x^{(i)})-y^{(i)} \big) x_j^{(i)} 
\]</div>
<blockquote>
<p><span class="arithmatex">\(\frac{\lambda}{m} \theta_j\)</span> :正则化项</p>
</blockquote>
<p>应用正则化的正规方程法:</p>
<div class="arithmatex">\[
\theta = (X^TX+ \lambda \cdot L )^{-1}X^Ty
\]</div>
<p>其中, <span class="arithmatex">\(L=
\begin{bmatrix}
0 &amp;   &amp;  &amp;  &amp;   \\
  &amp; 1 &amp;   &amp;  &amp; \\
  &amp;   &amp; 1 &amp;   &amp;   \\
  &amp;   &amp;   &amp; \ddots &amp;  \\
  &amp;   &amp; &amp; &amp; 1 \\
\end{bmatrix}\)</span></p>
<blockquote>
<p><span class="arithmatex">\(\lambda \cdot L\)</span>: 正则化项</p>
<p><span class="arithmatex">\(L\)</span> : 第一行第一列为 0 的 <span class="arithmatex">\(n+1\)</span> 维单位矩阵</p>
</blockquote>
<p>前文提到正则化可以解决正规方程中不可逆问题, 即加入了 <span class="arithmatex">\(\lambda \cdot L\)</span> 正则化项后, 可以保证 <span class="arithmatex">\(X^TX+\lambda \cdot L\)</span> 可逆(invertible), 即便 <span class="arithmatex">\(X^TX\)</span> 不可逆(non-invertible)。</p>
<p>下面对应用正则化的正规方程法结论进行推导</p>
<p>Cost Function</p>
<div class="arithmatex">\[
J(\theta)=\frac{1}{2m}\bigg[\sum_{i=1}^m{\big( h_\theta(x^{(i)})-y^{(i)} \big)^2+\lambda \sum_{j=1}^n \theta_j^2}\bigg]
\]</div>
<p>我们先假设连 <span class="arithmatex">\(\theta_0\)</span> 一起惩罚 并将上式向量化</p>
<div class="arithmatex">\[
J(\theta)=\frac{1}{2m}\bigg[(X\theta-\vec{y})^T(X\theta-\vec{y})+\lambda \theta^T \theta \bigg]
\]</div>
<p>然后开始求 <span class="arithmatex">\(J(\theta)\)</span> 关于 <span class="arithmatex">\(\theta\)</span> 的梯度, 即</p>
<div class="arithmatex">\[
\nabla _\theta J(\theta)=\nabla _\theta \frac{1}{2m}\bigg[(X\theta-\vec{y})^T(X\theta-\vec{y})+\lambda \theta^T \theta \bigg]
\]</div>
<p>由之前的结论</p>
<div class="arithmatex">\[
\nabla _\theta \frac{1}{2}(X\theta-\vec{y})^T(X\theta-\vec{y})= X^TX \theta-X^T \vec{y}
\]</div>
<p>所以我们现在只要关注后一项, 即</p>
<div class="arithmatex">\[
\nabla _\theta \frac{1}{2m} \cdot \lambda \theta^T \theta
\]</div>
<p>利用之前的结论</p>
<div class="arithmatex">\[ \nabla_A \operatorname{tr}(AB)=B^T\\\\ \]</div>
<div class="arithmatex">\[ \nabla_{A^T}f(A) = \big(\nabla_Af(A)\big)^T \\\\\]</div>
<div class="arithmatex">\[ \nabla_A \operatorname{tr}ABA^TC=CAB+C^TAB^T \\\\ \]</div>
<p>我们撇开系数, 先推导 <span class="arithmatex">\(\nabla_\theta \theta^T \theta\)</span> </p>
<div class="arithmatex">\[
\begin{aligned}
\nabla_\theta \theta^T \theta &amp;= (\nabla_{\theta^T}  \theta^T \theta)^T\\\\
&amp;= \big(\nabla_{\theta^T} \operatorname{tr}(\theta^T \theta) \big)^T\\\\
\end{aligned}
\]</div>
<p>然后, 可以令 <span class="arithmatex">\(\theta^T=A, B=C=I\)</span> 即</p>
<div class="arithmatex">\[
\begin{aligned}
\nabla_\theta \theta^T \theta &amp;=  \big(\nabla_{\theta^T} \operatorname{tr}(\theta^T \theta) \big)^T\\\\
&amp;= \big(\nabla_A \operatorname{tr}(ABA^TC)\big)^T\\\\
&amp;= \big(CAB+C^TAB^T\big)^T\\\\
&amp;= 2 A ^T \\\\
&amp;= 2 \theta
\end{aligned}
\]</div>
<p>所以</p>
<div class="arithmatex">\[
\nabla_\theta J(\theta)=\frac{1}{m}(X^TX \theta-X^T \vec{y}+\lambda \cdot \theta)
\]</div>
<p>为求 <span class="arithmatex">\(J(\theta)\)</span> 最小, 就是要令 <span class="arithmatex">\(\nabla_\theta J=0\)</span>, 所以</p>
<div class="arithmatex">\[
X^TX \theta-X^T \vec{y}+\lambda \cdot \theta=0
\]</div>
<p>解出 <span class="arithmatex">\(\theta\)</span> 为</p>
<div class="arithmatex">\[
\theta=(X^TX+\lambda \cdot E)^{-1}X^T \vec{y}
\]</div>
<p>其中, <span class="arithmatex">\(E\)</span> 为单位阵。</p>
<p>因为 <span class="arithmatex">\(\theta_0\)</span> 不参与正则, 我们仔细观察我们推导的结果与原来正规方程推导的结果, 就是多了一个 <span class="arithmatex">\(\lambda \cdot E\)</span> 这一项, 要让 <span class="arithmatex">\(\theta_0\)</span> 维持原来的结果, 我们只要让 <span class="arithmatex">\(E\)</span> 的第一行第一列为0, 这样和 <span class="arithmatex">\(\lambda\)</span> 相乘为0, 那么 <span class="arithmatex">\(\theta_0\)</span> 就会保持不变。</p>
<p>综上, 不惩罚 <span class="arithmatex">\(\theta_0\)</span> 的正规方程结论就是:</p>
<div class="arithmatex">\[
\theta = (X^TX+ \lambda \cdot L )^{-1}X^Ty
\]</div>
<p>其中, <span class="arithmatex">\(L=
\begin{bmatrix}
0 &amp;   &amp;  &amp;  &amp;   \\
  &amp; 1 &amp;   &amp;  &amp; \\
  &amp;   &amp; 1 &amp;   &amp;   \\
  &amp;   &amp;   &amp; \ddots &amp;  \\
  &amp;   &amp; &amp; &amp; 1 \\
\end{bmatrix}\)</span></p>
<h2 id="4">4、逻辑回归正则化</h2>
<div class="admonition info">
<p>参考视频:
7 - 4 - Regularized Logistic Regression (9 min).mkv</p>
</div>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            回到页面顶部
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="页脚">
      
        
        <a href="../3.%20logistic%20regression/" class="md-footer__link md-footer__link--prev" aria-label="上一页: 三. 逻辑回归" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                上一页
              </span>
              三. 逻辑回归
            </div>
          </div>
        </a>
      
      
        
        <a href="../../math%20in%20ML/" class="md-footer__link md-footer__link--next" aria-label="下一页: 前言和目录" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                下一页
              </span>
              前言和目录
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.top"], "search": "../../assets/javascripts/workers/search.5e67fbfe.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c44cc438.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>