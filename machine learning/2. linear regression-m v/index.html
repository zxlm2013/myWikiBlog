
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.8">
    
    
      
        <title>äºŒ. å¤šå˜é‡çº¿æ€§å›å½’ - å¤§ç™½çš„çŸ¥è¯†åº“</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.644de097.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1" class="md-skip">
          è·³è½¬è‡³
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="é¡µçœ‰">
    <a href="../.." title="å¤§ç™½çš„çŸ¥è¯†åº“" class="md-header__button md-logo" aria-label="å¤§ç™½çš„çŸ¥è¯†åº“" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            å¤§ç™½çš„çŸ¥è¯†åº“
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              äºŒ. å¤šå˜é‡çº¿æ€§å›å½’
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="æœç´¢" placeholder="æœç´¢" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="æŸ¥æ‰¾">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="æ¸…ç©ºå½“å‰å†…å®¹" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            æ­£åœ¨åˆå§‹åŒ–æœç´¢å¼•æ“
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="æ ‡ç­¾" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      é¦–é¡µ
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        æœºå™¨å­¦ä¹ 
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../math%20in%20ML/" class="md-tabs__link">
        æœºå™¨å­¦ä¹ ä¸­çš„æ•°å­¦çŸ¥è¯†
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="å¯¼èˆªæ " data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="å¤§ç™½çš„çŸ¥è¯†åº“" class="md-nav__button md-logo" aria-label="å¤§ç™½çš„çŸ¥è¯†åº“" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    å¤§ç™½çš„çŸ¥è¯†åº“
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        é¦–é¡µ
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          æœºå™¨å­¦ä¹ 
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="æœºå™¨å­¦ä¹ " data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          æœºå™¨å­¦ä¹ 
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        å‰è¨€å’Œç›®å½•
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.%20linear%20regression-1%20v/" class="md-nav__link">
        ä¸€. å•å˜é‡çº¿æ€§å›å½’
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          äºŒ. å¤šå˜é‡çº¿æ€§å›å½’
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        äºŒ. å¤šå˜é‡çº¿æ€§å›å½’
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="ç›®å½•">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ç›®å½•
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1. å¤šç»´ç‰¹å¾
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. å¤šå˜é‡æ¢¯åº¦ä¸‹é™
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-" class="md-nav__link">
    3. æ¢¯åº¦ä¸‹é™æ³• - ç‰¹å¾ç¼©æ”¾
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-" class="md-nav__link">
    4. æ¢¯åº¦ä¸‹é™æ³• - å­¦ä¹ ç‡
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5. ç‰¹å¾å’Œå¤šé¡¹å¼å›å½’
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    6. æ­£è§„æ–¹ç¨‹
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-the-normal-equations" class="md-nav__link">
    7. The normal equations
  </a>
  
    <nav class="md-nav" aria-label="7. The normal equations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-matrix-derivatives" class="md-nav__link">
    7.1 Matrix derivatives
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-least-squares-revisited" class="md-nav__link">
    7.2 Least squares revisited
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8" class="md-nav__link">
    8. æ­£è§„æ–¹ç¨‹åŠä¸å¯é€†æ€§
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    ä¹ é¢˜ &amp;&amp; å‚è€ƒç­”æ¡ˆ
  </a>
  
    <nav class="md-nav" aria-label="ä¹ é¢˜ &amp;&amp; å‚è€ƒç­”æ¡ˆ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    ç¬¬ä¸€é¢˜
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    ç¬¬äºŒé¢˜
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    ç¬¬ä¸‰é¢˜
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    ç¬¬ å›› é¢˜
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    ç¬¬ äº” é¢˜
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    å‚è€ƒç­”æ¡ˆ
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    ä¸Šæœºç»ƒä¹ 
  </a>
  
    <nav class="md-nav" aria-label="ä¸Šæœºç»ƒä¹ ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1feature-normalization" class="md-nav__link">
    1ã€Feature Normalization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2gradient-descent" class="md-nav__link">
    2ã€Gradient Descent
  </a>
  
    <nav class="md-nav" aria-label="2ã€Gradient Descent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-selecting-learning-rates" class="md-nav__link">
    2.1 Selecting learning rates
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3noramal-equation" class="md-nav__link">
    3ã€Noramal Equation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          æœºå™¨å­¦ä¹ ä¸­çš„æ•°å­¦çŸ¥è¯†
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="æœºå™¨å­¦ä¹ ä¸­çš„æ•°å­¦çŸ¥è¯†" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          æœºå™¨å­¦ä¹ ä¸­çš„æ•°å­¦çŸ¥è¯†
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../math%20in%20ML/" class="md-nav__link">
        å‰è¨€å’Œç›®å½•
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../math%20in%20ML/1.%20M%20derivation%20essence/" class="md-nav__link">
        ä¸€. çŸ©é˜µæ±‚å¯¼æœ¬è´¨
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../math%20in%20ML/2.%20M%20derivation/" class="md-nav__link">
        äºŒ. çŸ©é˜µæ±‚å¯¼
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="ç›®å½•">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ç›®å½•
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1. å¤šç»´ç‰¹å¾
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. å¤šå˜é‡æ¢¯åº¦ä¸‹é™
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-" class="md-nav__link">
    3. æ¢¯åº¦ä¸‹é™æ³• - ç‰¹å¾ç¼©æ”¾
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-" class="md-nav__link">
    4. æ¢¯åº¦ä¸‹é™æ³• - å­¦ä¹ ç‡
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5. ç‰¹å¾å’Œå¤šé¡¹å¼å›å½’
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    6. æ­£è§„æ–¹ç¨‹
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-the-normal-equations" class="md-nav__link">
    7. The normal equations
  </a>
  
    <nav class="md-nav" aria-label="7. The normal equations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-matrix-derivatives" class="md-nav__link">
    7.1 Matrix derivatives
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-least-squares-revisited" class="md-nav__link">
    7.2 Least squares revisited
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8" class="md-nav__link">
    8. æ­£è§„æ–¹ç¨‹åŠä¸å¯é€†æ€§
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    ä¹ é¢˜ &amp;&amp; å‚è€ƒç­”æ¡ˆ
  </a>
  
    <nav class="md-nav" aria-label="ä¹ é¢˜ &amp;&amp; å‚è€ƒç­”æ¡ˆ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    ç¬¬ä¸€é¢˜
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    ç¬¬äºŒé¢˜
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    ç¬¬ä¸‰é¢˜
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    ç¬¬ å›› é¢˜
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    ç¬¬ äº” é¢˜
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    å‚è€ƒç­”æ¡ˆ
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    ä¸Šæœºç»ƒä¹ 
  </a>
  
    <nav class="md-nav" aria-label="ä¸Šæœºç»ƒä¹ ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1feature-normalization" class="md-nav__link">
    1ã€Feature Normalization
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2gradient-descent" class="md-nav__link">
    2ã€Gradient Descent
  </a>
  
    <nav class="md-nav" aria-label="2ã€Gradient Descent">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21-selecting-learning-rates" class="md-nav__link">
    2.1 Selecting learning rates
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3noramal-equation" class="md-nav__link">
    3ã€Noramal Equation
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


  <h1>äºŒ. å¤šå˜é‡çº¿æ€§å›å½’</h1>

<h2 id="1">1. å¤šç»´ç‰¹å¾</h2>
<div class="admonition info">
<p>å‚è€ƒè§†é¢‘:
4 - 1 - Multiple Features (8 min).mkv</p>
</div>
<p>ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬æ¢è®¨äº†å•å˜é‡/ç‰¹å¾çš„å›å½’æ¨¡å‹ï¼Œç°åœ¨æˆ‘ä»¬å¯¹æˆ¿ä»·æ¨¡å‹å¢åŠ æ›´å¤šçš„ç‰¹å¾ï¼Œä¾‹å¦‚æˆ¿é—´æ•°æ¥¼å±‚ç­‰ï¼Œæ„æˆä¸€ä¸ªå«æœ‰å¤šä¸ªå˜é‡çš„æ¨¡å‹ï¼Œæ¨¡å‹ä¸­çš„ç‰¹å¾ä¸º<span class="arithmatex">\(\left( {x_{1}},{x_{2}},...,{x_{n}} \right)\)</span>ã€‚</p>
<table>
<thead>
<tr>
<th align="center">Size (feet2)</th>
<th align="center">Number   of bedrooms</th>
<th align="center">Number   of floors</th>
<th align="center">Age of home (years)</th>
<th align="center">Price   ($1000)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">2104</td>
<td align="center">5</td>
<td align="center">1</td>
<td align="center">45</td>
<td align="center">460</td>
</tr>
<tr>
<td align="center">1416</td>
<td align="center">3</td>
<td align="center">2</td>
<td align="center">40</td>
<td align="center">232</td>
</tr>
<tr>
<td align="center">1534</td>
<td align="center">3</td>
<td align="center">2</td>
<td align="center">30</td>
<td align="center">315</td>
</tr>
<tr>
<td align="center">852</td>
<td align="center">2</td>
<td align="center">1</td>
<td align="center">36</td>
<td align="center">178</td>
</tr>
<tr>
<td align="center">â€¦</td>
<td align="center">â€¦</td>
<td align="center">â€¦</td>
<td align="center">â€¦</td>
<td align="center">â€¦</td>
</tr>
</tbody>
</table>
<p>å¢æ·»æ›´å¤šç‰¹å¾åï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ç³»åˆ—æ–°çš„æ³¨é‡Šï¼š</p>
<p><span class="arithmatex">\(n\)</span> ä»£è¡¨ç‰¹å¾çš„æ•°é‡</p>
<p><span class="arithmatex">\({x^{\left( i \right)}}\)</span> ä»£è¡¨ç¬¬ <span class="arithmatex">\(i\)</span> ä¸ªè®­ç»ƒå®ä¾‹ï¼Œæ˜¯ç‰¹å¾çŸ©é˜µä¸­çš„ç¬¬<span class="arithmatex">\(i\)</span>è¡Œï¼Œæ˜¯ä¸€ä¸ª<strong>å‘é‡</strong>ï¼ˆ<strong>vector</strong>ï¼‰ã€‚</p>
<p>æ¯”æ–¹è¯´ï¼Œä¸Šå›¾çš„</p>
<p><span class="arithmatex">\({x}^{(2)}\text{=}\begin{bmatrix} 1416\\\ 3\\\ 2\\\ 40 \end{bmatrix}\)</span>ï¼Œ</p>
<p><span class="arithmatex">\({x}_{j}^{\left( i \right)}\)</span>ä»£è¡¨ç‰¹å¾çŸ©é˜µä¸­ç¬¬ <span class="arithmatex">\(i\)</span> è¡Œçš„ç¬¬ <span class="arithmatex">\(j\)</span> ä¸ªç‰¹å¾ï¼Œä¹Ÿå°±æ˜¯ç¬¬ <span class="arithmatex">\(i\)</span> ä¸ªè®­ç»ƒå®ä¾‹çš„ç¬¬ <span class="arithmatex">\(j\)</span> ä¸ªç‰¹å¾ã€‚</p>
<p>å¦‚ä¸Šå›¾çš„<span class="arithmatex">\(x_{2}^{\left( 2 \right)}=3,x_{3}^{\left( 2 \right)}=2\)</span>ï¼Œ</p>
<p>æ”¯æŒå¤šå˜é‡çš„å‡è®¾ <span class="arithmatex">\(h\)</span> è¡¨ç¤ºä¸ºï¼š<span class="arithmatex">\(h_{\theta}\left( x \right)={\theta_{0}}+{\theta_{1}}{x_{1}}+{\theta_{2}}{x_{2}}+...+{\theta_{n}}{x_{n}}\)</span>ï¼Œ</p>
<p>è¿™ä¸ªå…¬å¼ä¸­æœ‰<span class="arithmatex">\(n+1\)</span>ä¸ªå‚æ•°å’Œ<span class="arithmatex">\(n\)</span>ä¸ªå˜é‡ï¼Œä¸ºäº†ä½¿å¾—å…¬å¼èƒ½å¤Ÿç®€åŒ–ä¸€äº›ï¼Œå¼•å…¥<span class="arithmatex">\(x_{0}=1\)</span>ï¼Œåˆ™å…¬å¼è½¬åŒ–ä¸ºï¼š<span class="arithmatex">\(h_{\theta} \left( x \right)={\theta_{0}}{x_{0}}+{\theta_{1}}{x_{1}}+{\theta_{2}}{x_{2}}+...+{\theta_{n}}{x_{n}}\)</span></p>
<p><img alt="2_1_1_theta_T_X" src="../../assets/images/2_1_1_theta_T_X.png" /></p>
<p>æ­¤æ—¶æ¨¡å‹ä¸­çš„å‚æ•°æ˜¯ä¸€ä¸ª<span class="arithmatex">\(n+1\)</span>ç»´çš„å‘é‡ï¼Œä»»ä½•ä¸€ä¸ªè®­ç»ƒå®ä¾‹ä¹Ÿéƒ½æ˜¯<span class="arithmatex">\(n+1\)</span>ç»´çš„å‘é‡ï¼Œç‰¹å¾çŸ©é˜µ<span class="arithmatex">\(X\)</span>çš„ç»´åº¦æ˜¯ <span class="arithmatex">\(m*(n+1)\)</span>ã€‚ å› æ­¤å…¬å¼å¯ä»¥ç®€åŒ–ä¸ºï¼š<span class="arithmatex">\(h_{\theta} \left( x \right)={\theta^{T}}X\)</span>ï¼Œå…¶ä¸­ä¸Šæ ‡  <span class="arithmatex">\(T\)</span> ä»£è¡¨çŸ©é˜µè½¬ç½®ã€‚</p>
<p>æ³¨æ„ï¼š
ä»ä¸Šå›¾å¯çŸ¥, <span class="arithmatex">\(\theta\)</span>, <span class="arithmatex">\(X\)</span> æˆ‘ä»¬æ˜¯ç”¨<strong>åˆ—å‘é‡</strong>æ¥æ ‡è®°ã€‚è®¡ç®— <span class="arithmatex">\(h_{\theta}\left( x \right)={\theta_{0}}+{\theta_{1}}{x_{1}}+{\theta_{2}}{x_{2}}+...+{\theta_{n}}{x_{n}}\)</span> çš„æ—¶å€™, å¯ä»¥å°† <span class="arithmatex">\(h\)</span> è¡¨ç¤ºä¸º <span class="arithmatex">\(\theta^TX.\)</span></p>
<h2 id="2">2. å¤šå˜é‡æ¢¯åº¦ä¸‹é™</h2>
<div class="admonition info">
<p>å‚è€ƒè§†é¢‘:
4 - 2 - Gradient Descent for Multiple Variables (5 min).mkv</p>
</div>
<p>å¿«é€Ÿå›é¡¾æˆ‘ä»¬çš„è®°å·ï¼Œå¹¶ç”¨å‘é‡ç®€åŒ–ã€‚</p>
<p>Hypothesis: <span class="arithmatex">\(h_\theta(x)=\theta_0+\theta_1x+\theta_2x+...+\theta_nx\)</span></p>
<p>ç®€è®°ä¸ºï¼š <span class="arithmatex">\(h_\theta(x)=\theta^TX\)</span></p>
<p>Parameters: <span class="arithmatex">\(\theta_0,\theta_1,\theta_2,...\theta_n\)</span></p>
<p>ç®€è®°ä¸ºï¼š<span class="arithmatex">\(\theta\)</span>, <span class="arithmatex">\(n+1\ dimension\ vector\)</span></p>
<p>Cost Function: </p>
<div class="arithmatex">\[
J(\theta_0,\theta_1,\ \theta_2,...\theta_n)=\frac {1} {2m}\sum\limits_{i=1}^{m}(h_\theta(x^{(i)})-y^{(i)})^2
\]</div>
<p>ç®€è®°ä¸ºï¼š</p>
<div class="arithmatex">\[
J(\theta)=\frac {1} {2m}\sum\limits_{i=1}^{m}(h_\theta(x^{(i)})-y^{(i)})^2
\]</div>
<p>Gradient descent:
<strong>Repeat {</strong></p>
<p>â€‹                <span class="arithmatex">\({\theta_{j}}:={\theta_{j}}-\alpha\frac{\partial}{\partial\theta_j}J(\theta_0,...\theta_n)\)</span></p>
<p>â€‹               <strong>}</strong> (simultaneously update for every j=0, 1, 2, ..., n)
ç®€è®°ä¸ºï¼šæŠŠä¸Šé¢çš„<span class="arithmatex">\(J(\theta_0,...\theta_n)\)</span>æ¢æˆ<span class="arithmatex">\(J(\theta)\)</span></p>
<p><img alt="2_2_1_gradient_descent_v2" src="../../assets/images/2_2_1_gradient_descent_v2.png" /></p>
<p>ä¸å•å˜é‡çº¿æ€§å›å½’ç±»ä¼¼ï¼Œåœ¨å¤šå˜é‡çº¿æ€§å›å½’ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿæ„å»ºä¸€ä¸ªä»£ä»·å‡½æ•°ï¼Œåˆ™è¿™ä¸ªä»£ä»·å‡½æ•°æ˜¯æ‰€æœ‰å»ºæ¨¡è¯¯å·®çš„å¹³æ–¹å’Œï¼Œå³ï¼š<span class="arithmatex">\(J\left( {\theta_{0}},{\theta_{1}}...{\theta_{n}} \right)=\frac{1}{2m}\sum\limits_{i=1}^{m}{{{\left( h_{\theta} \left({x}^{\left( i \right)} \right)-{y}^{\left( i \right)} \right)}^{2}}}\)</span> ï¼Œ</p>
<p>å…¶ä¸­ï¼š<span class="arithmatex">\(h_{\theta}\left( x \right)=\theta^{T}X={\theta_{0}}+{\theta_{1}}{x_{1}}+{\theta_{2}}{x_{2}}+...+{\theta_{n}}{x_{n}}\)</span> ï¼Œ</p>
<p>æˆ‘ä»¬çš„ç›®æ ‡å’Œå•å˜é‡çº¿æ€§å›å½’é—®é¢˜ä¸­ä¸€æ ·ï¼Œæ˜¯è¦æ‰¾å‡ºä½¿å¾—ä»£ä»·å‡½æ•°æœ€å°çš„ä¸€ç³»åˆ—å‚æ•°ã€‚
å¤šå˜é‡çº¿æ€§å›å½’çš„æ‰¹é‡æ¢¯åº¦ä¸‹é™ç®—æ³•ä¸ºï¼š</p>
<p>å½“<span class="arithmatex">\(n&gt;=1\)</span>æ—¶ï¼Œ
<span class="arithmatex">\({{\theta }_{0}}:={{\theta }_{0}}-a\frac{1}{m}\sum\limits_{i=1}^{m}{({{h}_{\theta }}({{x}^{(i)}})-{{y}^{(i)}})}x_{0}^{(i)}\)</span></p>
<p><span class="arithmatex">\({{\theta }_{1}}:={{\theta }_{1}}-a\frac{1}{m}\sum\limits_{i=1}^{m}{({{h}_{\theta }}({{x}^{(i)}})-{{y}^{(i)}})}x_{1}^{(i)}\)</span></p>
<p><span class="arithmatex">\({{\theta }_{2}}:={{\theta }_{2}}-a\frac{1}{m}\sum\limits_{i=1}^{m}{({{h}_{\theta }}({{x}^{(i)}})-{{y}^{(i)}})}x_{2}^{(i)}\)</span></p>
<p>...</p>
<p><span class="arithmatex">\({{\theta }_{n}}:={{\theta }_{n}}-a\frac{1}{m}\sum\limits_{i=1}^{m}{({{h}_{\theta }}({{x}^{(i)}})-{{y}^{(i)}})}x_{n}^{(i)}\)</span></p>
<p>æˆ‘ä»¬å¼€å§‹éšæœºé€‰æ‹©ä¸€ç³»åˆ—çš„å‚æ•°å€¼ï¼Œè®¡ç®—æ‰€æœ‰çš„é¢„æµ‹ç»“æœåï¼Œå†ç»™æ‰€æœ‰çš„å‚æ•°ä¸€ä¸ªæ–°çš„å€¼ï¼Œå¦‚æ­¤å¾ªç¯ç›´åˆ°æ”¶æ•›ã€‚</p>
<p>ä»£ç ç¤ºä¾‹ï¼š</p>
<p>è®¡ç®—ä»£ä»·å‡½æ•°
<span class="arithmatex">\(J\left( \theta  \right)=\frac{1}{2m}\sum\limits_{i=1}^{m}{{{\left( {h_{\theta}}\left( {x^{(i)}} \right)-{y^{(i)}} \right)}^{2}}}\)</span>
å…¶ä¸­ï¼š<span class="arithmatex">\({h_{\theta}}\left( x \right)={\theta^{T}}X={\theta_{0}}{x_{0}}+{\theta_{1}}{x_{1}}+{\theta_{2}}{x_{2}}+...+{\theta_{n}}{x_{n}}\)</span></p>
<p><strong>Python</strong> ä»£ç ï¼š</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">computeCost</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">inner</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(((</span><span class="n">X</span> <span class="o">*</span> <span class="n">theta</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">inner</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</code></pre></div>
<hr>

<p>ä¸‹é¢ï¼Œæˆ‘ä»¬å¼€å§‹æ¨å¯¼<span class="arithmatex">\(\frac{\partial}{\partial\theta}J(\theta)\)</span>ã€‚è¿™é‡Œä¸ºäº†æ™®éæ€§ï¼Œè¿˜åŸäº† <span class="arithmatex">\(\theta\)</span> çš„æ™®éæƒ…å†µï¼Œä¹Ÿå³æœ‰nä¸ª <span class="arithmatex">\(\theta\)</span> çš„æƒ…å†µã€‚</p>
<p>Hypothesis:         <span class="arithmatex">\(h_\theta(x)=\theta^Tx=\theta_0x_0+\theta_1x_1+\theta_2x_2+...+\theta_nx_n\)</span></p>
<p>Parameters:         <span class="arithmatex">\(\theta_0,\theta_1,...,\theta_n\)</span></p>
<p>Cost function: </p>
<div class="arithmatex">\[
J(\theta_0,\theta_1,...,\theta_n)=\frac {1} {2m}\sum\limits_{i=1}^{m}(h_\theta(x^{(i)})-y^{(i)})^2
\]</div>
<p>Gradient descent:
Repeat{
$$
\theta_j :=\theta_j-\alpha\frac{\partial}{\partial \theta_j}J(\theta_0,\theta_1,...,\theta_n)
$$
â€‹        }ï¼ˆsimultaneously update for every j=0, 1, 2, ..., n)ï¼‰</p>
<p>æ¨å¯¼ï¼š <span class="arithmatex">\(\frac{\partial}{\partial \theta_j}J(\theta_0,\theta_1,...,\theta_n)=?\)</span></p>
<p>Let's first work it for the case if we have only one training example <span class="arithmatex">\((x,y)\)</span>, so that we can neglect the sum in the definition <span class="arithmatex">\(J\)</span>. We have:
$$
\begin{split}
\frac{\partial}{\partial \theta_j}J(\theta_0,\theta_1,...,\theta_n) &amp; =  \frac {1} {2}\frac{\partial}{\partial \theta_j}\Big(h_\theta(x)-y\Big)^2 \\
 &amp; = 2\cdot\frac{1}{2}\cdot(h_\theta(x)-y)\cdot\frac{\partial}{\partial \theta_j}(h_\theta(x)-y) \\
 &amp; = (h_\theta(x)-y)\cdot\frac{\partial}{\partial \theta_j}(\theta_0x_0+\theta_1x_1+\theta_2x_2+...+\theta_nx_n) \\
 &amp; = (h_\theta(x)-y)\cdot x_j
\end{split}
$$</p>
<h2 id="3-">3. æ¢¯åº¦ä¸‹é™æ³• - ç‰¹å¾ç¼©æ”¾</h2>
<div class="admonition info">
<p>å‚è€ƒè§†é¢‘:
4 - 3 - Gradient Descent in Practice I - Feature Scaling (9 min).mkv</p>
</div>
<p>åœ¨æˆ‘ä»¬é¢å¯¹å¤šç»´ç‰¹å¾é—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦ä¿è¯è¿™äº›ç‰¹å¾éƒ½å…·æœ‰ç›¸è¿‘çš„å°ºåº¦ï¼Œè¿™å°†å¸®åŠ©æ¢¯åº¦ä¸‹é™ç®—æ³•æ›´å¿«åœ°æ”¶æ•›ã€‚</p>
<p>ä»¥æˆ¿ä»·é—®é¢˜ä¸ºä¾‹ï¼Œå‡è®¾æˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ªç‰¹å¾ï¼Œæˆ¿å±‹çš„å°ºå¯¸å’Œæˆ¿é—´çš„æ•°é‡ï¼Œå°ºå¯¸çš„å€¼ä¸º 0-2000å¹³æ–¹è‹±å°ºï¼Œè€Œæˆ¿é—´æ•°é‡çš„å€¼åˆ™æ˜¯0-5ï¼Œä»¥ä¸¤ä¸ªå‚æ•°åˆ†åˆ«ä¸ºæ¨ªçºµåæ ‡ï¼Œç»˜åˆ¶ä»£ä»·å‡½æ•°çš„ç­‰é«˜çº¿å›¾èƒ½ï¼Œçœ‹å‡ºå›¾åƒä¼šæ˜¾å¾—å¾ˆæ‰ï¼Œæ¢¯åº¦ä¸‹é™ç®—æ³•éœ€è¦éå¸¸å¤šæ¬¡çš„è¿­ä»£æ‰èƒ½æ”¶æ•›ã€‚
è§£å†³çš„æ–¹æ³•æ˜¯å°è¯•å°†æ‰€æœ‰ç‰¹å¾çš„å°ºåº¦éƒ½å°½é‡ç¼©æ”¾åˆ°-1åˆ°1ä¹‹é—´ã€‚å¦‚å›¾ï¼š</p>
<p><img alt="2_3_1_feature_scaling" src="../../assets/images/2_3_1_feature_scaling.png" /></p>
<p>è§†é¢‘é‡Œå´æ©è¾¾è€å¸ˆçš„æ–¹æ³•æ˜¯ä»¤ï¼š<span class="arithmatex">\({{x}_{n}}=\frac{{{x}_{n}}-mean}{{max(x)-min(x)}}\)</span>, å…¶ä¸­ <span class="arithmatex">\(mean\)</span>æ˜¯å¹³å‡å€¼ï¼Œ<span class="arithmatex">\(max(x)-min(x)\)</span>åˆ†åˆ«æ˜¯æœ€å¤§å€¼å’Œæœ€å°å€¼ã€‚</p>
<p>æ›´é€šç”¨çš„æ˜¯ä»¤ï¼š<span class="arithmatex">\({{x}_{n}}=\frac{{{x}_{n}}-{mean}}{\sigma}\)</span>ï¼Œå…¶ä¸­ <span class="arithmatex">\(mean\)</span>æ˜¯å¹³å‡å€¼ï¼Œ<span class="arithmatex">\(\sigma\)</span>æ˜¯æ ‡å‡†å·®ã€‚</p>
<p>pythoné‡Œçš„apiï¼š</p>
<ul>
<li>
<p><strong>sklearn.preprocessing.StandardScaler()</strong></p>
<ul>
<li>å¤„ç†ä¹‹åæ¯åˆ—æ¥è¯´<strong>æ‰€æœ‰æ•°æ®éƒ½èšé›†åœ¨å‡å€¼0é™„è¿‘æ ‡å‡†å·®å·®ä¸º1</strong></li>
<li><strong>StandardScaler.fit_transform(X)</strong><ul>
<li>X:numpy arrayæ ¼å¼çš„æ•°æ®[n_samples,n_features]</li>
</ul>
</li>
<li>è¿”å›å€¼ï¼šè½¬æ¢åçš„å½¢çŠ¶ç›¸åŒçš„array</li>
</ul>
</li>
</ul>
<p>éƒ¨åˆ†å‚è€ƒä»£ç ï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_boston</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="k">def</span> <span class="nf">linear_model1</span><span class="p">():</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>    <span class="c1"># 1.è·å–æ•°æ®</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>    <span class="n">boston</span> <span class="o">=</span> <span class="n">load_boston</span><span class="p">()</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>    <span class="c1"># 2. æ•°æ®é›†åˆ’åˆ†</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>    <span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>        <span class="n">boston</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">boston</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>    <span class="c1"># 3. ç‰¹å¾å·¥ç¨‹-æ ‡å‡†åŒ–</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>    <span class="n">transfer</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>    <span class="n">x_train</span> <span class="o">=</span> <span class="n">transfer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>    <span class="n">x_test</span> <span class="o">=</span> <span class="n">transfer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
</code></pre></div></p>
<h2 id="4-">4. æ¢¯åº¦ä¸‹é™æ³• - å­¦ä¹ ç‡</h2>
<div class="admonition info">
<p>å‚è€ƒè§†é¢‘:
4 - 4 - Gradient Descent in Practice II - Learning Rate (9 min).mkv</p>
</div>
<p>æ¢¯åº¦ä¸‹é™ç®—æ³•æ”¶æ•›æ‰€éœ€è¦çš„è¿­ä»£æ¬¡æ•°æ ¹æ®æ¨¡å‹çš„ä¸åŒè€Œä¸åŒï¼Œæˆ‘ä»¬ä¸èƒ½æå‰é¢„çŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥ç»˜åˆ¶è¿­ä»£æ¬¡æ•°å’Œä»£ä»·å‡½æ•°çš„å›¾è¡¨æ¥è§‚æµ‹ç®—æ³•åœ¨ä½•æ—¶è¶‹äºæ”¶æ•›ã€‚</p>
<p><img alt="2_4_1_J_iterations" src="../../assets/images/2_4_1_J_iterations.png" /></p>
<p>ä¹Ÿæœ‰ä¸€äº›è‡ªåŠ¨æµ‹è¯•æ˜¯å¦æ”¶æ•›çš„æ–¹æ³•ï¼Œä¾‹å¦‚å°†ä»£ä»·å‡½æ•°çš„å˜åŒ–å€¼ä¸æŸä¸ªé˜€å€¼ï¼ˆä¾‹å¦‚0.001ï¼‰è¿›è¡Œæ¯”è¾ƒï¼Œä½†é€šå¸¸çœ‹å·¦ä¸Šæ–¹è¿™æ ·çš„å›¾è¡¨æ›´å¥½ã€‚</p>
<p>ä¸æ­£ç¡®çš„å­¦ä¹ ç‡ï¼Œä¼šäº§ç”Ÿå·¦ä¾§ä¸Šä¸‹ä¸¤ä¸ªå›¾åƒã€‚
<img alt="2_4_2_no_proper_alpha" src="../../assets/images/2_4_2_no_proper_alpha.png" /></p>
<p>æ¢¯åº¦ä¸‹é™ç®—æ³•çš„æ¯æ¬¡è¿­ä»£å—åˆ°å­¦ä¹ ç‡çš„å½±å“ï¼Œå¦‚æœå­¦ä¹ ç‡ <span class="arithmatex">\(\alpha\)</span> è¿‡å°ï¼Œåˆ™è¾¾åˆ°æ”¶æ•›æ‰€éœ€çš„è¿­ä»£æ¬¡æ•°ä¼šéå¸¸é«˜ï¼›å¦‚æœå­¦ä¹ ç‡ <span class="arithmatex">\(\alpha\)</span> è¿‡å¤§ï¼Œæ¯æ¬¡è¿­ä»£å¯èƒ½ä¸ä¼šå‡å°ä»£ä»·å‡½æ•°ï¼Œå¯èƒ½ä¼šè¶Šè¿‡å±€éƒ¨æœ€å°å€¼å¯¼è‡´æ— æ³•æ”¶æ•›ã€‚</p>
<p>é€šå¸¸å¯ä»¥è€ƒè™‘å°è¯•äº›å­¦ä¹ ç‡ï¼š</p>
<p><span class="arithmatex">\(\alpha= 0.001, 0.003, 0.01, 0.03, 0.1, 0.3, 1, 3, 10\)</span></p>
<h2 id="5">5. ç‰¹å¾å’Œå¤šé¡¹å¼å›å½’</h2>
<div class="admonition info">
<p>å‚è€ƒè§†é¢‘:
4 - 5 - Features and Polynomial Regression (8 min).mkv</p>
</div>
<p>å¦‚æˆ¿ä»·é¢„æµ‹é—®é¢˜ï¼Œ</p>
<p><img alt="2_5_1_house" src="../../assets/images/2_5_1_house.png" /></p>
<p><span class="arithmatex">\(h_{\theta}\left( x \right)={\theta_{0}}+{\theta_{1}}\times{frontage}+{\theta_{2}}\times{depth}\)</span> </p>
<p>å½“æˆ‘ä»¬çœŸæ­£åº”ç”¨çº¿æ€§å›å½’æ¨¡å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›é€ è‡ªå·±çš„ç‰¹å¾å³ï¼š
<span class="arithmatex">\({x_{1}}=frontage\)</span>ï¼ˆä¸´è¡—å®½åº¦ï¼‰ï¼Œ<span class="arithmatex">\({x_{2}}=depth\)</span>ï¼ˆçºµå‘æ·±åº¦ï¼‰ï¼Œ<span class="arithmatex">\(x=frontage*depth=area\)</span>ï¼ˆé¢ç§¯ï¼‰ï¼Œ
åˆ™ï¼š<span class="arithmatex">\({h_{\theta}}\left( x \right)={\theta_{0}}+{\theta_{1}}x\)</span>ã€‚</p>
<p><img alt="2_5_2_polynomial_regression" src="../../assets/images/2_5_2_polynomial_regression.png" /></p>
<p>çº¿æ€§å›å½’å¹¶ä¸é€‚ç”¨äºæ‰€æœ‰æ•°æ®ï¼Œæœ‰æ—¶æˆ‘ä»¬éœ€è¦å…¶ä»–æ¨¡å‹æ¥é€‚åº”æˆ‘ä»¬çš„æ•°æ®ï¼Œæ¯”å¦‚ä¸€ä¸ªäºŒæ¬¡æ–¹æ¨¡å‹ï¼š<span class="arithmatex">\(h_{\theta}\left( x \right)={\theta_{0}}+{\theta_{1}}{x_{1}}+{\theta_{2}}{x_{2}^2}\)</span>
 æˆ–è€…ä¸‰æ¬¡æ–¹æ¨¡å‹ï¼š <span class="arithmatex">\(h_{\theta}\left( x \right)={\theta_{0}}+{\theta_{1}}{x_{1}}+{\theta_{2}}{x_{2}^2}+{\theta_{3}}{x_{3}^3}\)</span> </p>
<p>ä»ä¸Šé¢å›¾å³ä¾§ï¼Œå¯ä»¥çœ‹å‡ºå¦‚æœæˆ‘ä»¬é‡‡ç”¨å¤šé¡¹å¼å›å½’æ¨¡å‹ï¼Œåœ¨è¿è¡Œæ¢¯åº¦ä¸‹é™ç®—æ³•å‰ç‰¹å¾ç¼©æ”¾çš„é‡è¦æ€§äº†ã€‚</p>
<p>é€šå¸¸æˆ‘ä»¬éœ€è¦å…ˆè§‚å¯Ÿæ•°æ®ç„¶åå†å†³å®šå‡†å¤‡å°è¯•æ€æ ·çš„æ¨¡å‹ã€‚ å¦å¤–ï¼Œæˆ‘ä»¬å¯ä»¥ä»¤ï¼š</p>
<p><span class="arithmatex">\({{x}_{2}}=x_{2}^{2},{{x}_{3}}=x_{3}^{3}\)</span>ï¼Œä»è€Œå°†æ¨¡å‹è½¬åŒ–ä¸ºçº¿æ€§å›å½’æ¨¡å‹ã€‚</p>
<p>æ ¹æ®å‡½æ•°å›¾å½¢ç‰¹æ€§ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ï¼š</p>
<p><span class="arithmatex">\({{{h}}_{\theta}}(x)={{\theta }_{0}}\text{+}{{\theta }_{1}}(size)+{{\theta}_{2}}{{(size)}^{2}}\)</span></p>
<p>æˆ–è€…:</p>
<p><span class="arithmatex">\({{{h}}_{\theta}}(x)={{\theta }_{0}}\text{+}{{\theta }_{1}}(size)+{{\theta }_{2}}\sqrt{size}\)</span></p>
<p><img alt="2_5_3_choice_of_X" src="../../assets/images/2_5_3_choice_of_X.png" /></p>
<h2 id="6">6. æ­£è§„æ–¹ç¨‹</h2>
<div class="admonition info">
<p>å‚è€ƒè§†é¢‘:
4 - 6 - Normal Equation (16 min).mkv</p>
</div>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬éƒ½åœ¨ä½¿ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼Œä½†æ˜¯å¯¹äºæŸäº›çº¿æ€§å›å½’é—®é¢˜ï¼Œæ­£è§„æ–¹ç¨‹æ–¹æ³•æ˜¯æ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚å¦‚ï¼š</p>
<p><img alt="2_6_1" src="../../assets/images/2_6_1.png" /></p>
<p>æ­£è§„æ–¹ç¨‹æ˜¯é€šè¿‡æ±‚è§£ä¸‹é¢çš„æ–¹ç¨‹æ¥æ‰¾å‡ºä½¿å¾—ä»£ä»·å‡½æ•°æœ€å°çš„å‚æ•°çš„ï¼š<span class="arithmatex">\(\frac{\partial}{\partial{\theta_{j}}}J\left( {\theta_{j}} \right)=0\)</span> ã€‚
 å‡è®¾æˆ‘ä»¬çš„è®­ç»ƒé›†ç‰¹å¾çŸ©é˜µä¸º <span class="arithmatex">\(X\)</span>ï¼ˆåŒ…å«äº† <span class="arithmatex">\({{x}_{0}}=1\)</span>ï¼‰å¹¶ä¸”æˆ‘ä»¬çš„è®­ç»ƒé›†ç»“æœä¸ºå‘é‡ <span class="arithmatex">\(y\)</span>ï¼Œåˆ™åˆ©ç”¨æ­£è§„æ–¹ç¨‹è§£å‡ºå‘é‡ <span class="arithmatex">\(\theta ={{\left( {X^T}X \right)}^{-1}}{X^{T}}y\)</span> ã€‚</p>
<p>ä»¥ä¸‹é¢è¡¨æ ¼æ•°æ®ä¸ºä¾‹ <span class="arithmatex">\(m=4\)</span>ï¼š</p>
<table>
<thead>
<tr>
<th><span class="arithmatex">\(x_0\)</span></th>
<th>Size (feet2)</th>
<th>Number   of bedrooms</th>
<th>Number   of floors</th>
<th>Age of home (years)</th>
<th>Price   ($1000)</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>2104</td>
<td>5</td>
<td>1</td>
<td>45</td>
<td>460</td>
</tr>
<tr>
<td>1</td>
<td>1416</td>
<td>3</td>
<td>2</td>
<td>40</td>
<td>232</td>
</tr>
<tr>
<td>1</td>
<td>1534</td>
<td>3</td>
<td>2</td>
<td>30</td>
<td>315</td>
</tr>
<tr>
<td>1</td>
<td>852</td>
<td>2</td>
<td>1</td>
<td>36</td>
<td>178</td>
</tr>
</tbody>
</table>
<p><span class="arithmatex">\(X\ \text{=}\begin{bmatrix}1 &amp; 2104 &amp; 5 &amp; 1 &amp; 45\\1 &amp; 1416 &amp; 3 &amp; 2 &amp; 40\\ 1 &amp;1534 &amp; 3 &amp; 2 &amp; 30\\ 1 &amp; 852 &amp; 2 &amp; 1 &amp; 36\end{bmatrix}\)</span>ï¼Œ<span class="arithmatex">\(y\ \text{=}\begin{bmatrix} 460\\232\\315\\178\end{bmatrix}\)</span></p>
<p><span class="arithmatex">\(Xç»´åº¦ï¼š(m,n+1),\ yçš„ç»´åº¦ï¼š(m,1)\)</span></p>
<p>è¿™æ—¶å€™æ±‚è§£ <span class="arithmatex">\(\theta\)</span> åªéœ€ä¸€æ­¥:  <span class="arithmatex">\(\theta ={{\left( {X^T}X \right)}^{-1}}{X^{T}}y\)</span>ã€‚</p>
<p>å°†ä¸Šé¢çš„ä¾‹å­æ¨å¹¿åˆ°ä¸€èˆ¬æƒ…å†µ</p>
<p><img alt="2_6_2" src="../../assets/images/2_6_2.png" /></p>
<p>æ³¨ï¼šå¯¹äºé‚£äº›ä¸å¯é€†çš„çŸ©é˜µï¼ˆé€šå¸¸æ˜¯å› ä¸ºç‰¹å¾ä¹‹é—´ä¸ç‹¬ç«‹ï¼Œå¦‚åŒæ—¶åŒ…å«è‹±å°ºä¸ºå•ä½çš„å°ºå¯¸å’Œç±³ä¸ºå•ä½çš„å°ºå¯¸ä¸¤ä¸ªç‰¹å¾ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ç‰¹å¾æ•°é‡å¤§äºè®­ç»ƒé›†çš„æ•°é‡ï¼‰ï¼Œæ­£è§„æ–¹ç¨‹æ–¹æ³•æ˜¯ä¸èƒ½ç”¨çš„ã€‚
åƒä¸‡è¦æ³¨æ„è¿™é‡Œçš„è®¾è®¡çŸ©é˜µXå®ƒçš„æ„æˆï¼Œè®¾è®¡å®Œæˆåï¼Œå‡è®¾å‡½æ•°å¯ä»¥å‘é‡åŒ–ä¸º <span class="arithmatex">\(h_\theta(x)=X\theta\)</span></p>
<p>æ¢¯åº¦ä¸‹é™ä¸æ­£è§„æ–¹ç¨‹çš„æ¯”è¾ƒï¼š</p>
<table>
<thead>
<tr>
<th>æ¢¯åº¦ä¸‹é™</th>
<th>æ­£è§„æ–¹ç¨‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>éœ€è¦é€‰æ‹©å­¦ä¹ ç‡<span class="arithmatex">\(\alpha\)</span></td>
<td>ä¸éœ€è¦</td>
</tr>
<tr>
<td>éœ€è¦å¤šæ¬¡è¿­ä»£</td>
<td>ä¸€æ¬¡è¿ç®—å¾—å‡º</td>
</tr>
<tr>
<td>å½“ç‰¹å¾æ•°é‡<span class="arithmatex">\(n\)</span>å¤§æ—¶ä¹Ÿèƒ½è¾ƒå¥½é€‚ç”¨</td>
<td>éœ€è¦è®¡ç®—<span class="arithmatex">\({{\left( {{X}^{T}}X \right)}^{-1}}\)</span> å¦‚æœç‰¹å¾æ•°é‡nè¾ƒå¤§åˆ™è¿ç®—ä»£ä»·å¤§ï¼Œå› ä¸ºçŸ©é˜µé€†çš„è®¡ç®—æ—¶é—´å¤æ‚åº¦ä¸º<span class="arithmatex">\(O\left( {{n}^{3}} \right)\)</span>ï¼Œé€šå¸¸æ¥è¯´å½“<span class="arithmatex">\(n\)</span>å°äº10000 æ—¶è¿˜æ˜¯å¯ä»¥æ¥å—çš„</td>
</tr>
<tr>
<td>é€‚ç”¨äºå„ç§ç±»å‹çš„æ¨¡å‹</td>
<td>åªé€‚ç”¨äºçº¿æ€§æ¨¡å‹ï¼Œä¸é€‚åˆé€»è¾‘å›å½’æ¨¡å‹ç­‰å…¶ä»–æ¨¡å‹</td>
</tr>
</tbody>
</table>
<p>æ€»ç»“ä¸€ä¸‹ï¼Œåªè¦ç‰¹å¾å˜é‡çš„æ•°ç›®å¹¶ä¸å¤§ï¼Œæ ‡å‡†æ–¹ç¨‹æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è®¡ç®—å‚æ•°$\theta $çš„æ›¿ä»£æ–¹æ³•ã€‚å…·ä½“åœ°è¯´ï¼Œ<strong>åªè¦ç‰¹å¾å˜é‡æ•°é‡å°äºä¸€ä¸‡ï¼Œæˆ‘é€šå¸¸ä½¿ç”¨æ­£è§„æ–¹ç¨‹æ³•ï¼Œè€Œä¸ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•ã€‚</strong></p>
<p>éšç€æˆ‘ä»¬è¦è®²çš„å­¦ä¹ ç®—æ³•è¶Šæ¥è¶Šå¤æ‚ï¼Œä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬è®²åˆ°åˆ†ç±»ç®—æ³•ï¼Œåƒé€»è¾‘å›å½’ç®—æ³•ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ï¼Œå®é™…ä¸Šå¯¹äºé‚£äº›ç®—æ³•ï¼Œå¹¶ä¸èƒ½ä½¿ç”¨æ ‡å‡†æ–¹ç¨‹æ³•ã€‚å¯¹äºé‚£äº›æ›´å¤æ‚çš„å­¦ä¹ ç®—æ³•ï¼Œæˆ‘ä»¬å°†ä¸å¾—ä¸ä»ç„¶ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•ã€‚å› æ­¤ï¼Œæ¢¯åº¦ä¸‹é™æ³•æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„ç®—æ³•ï¼Œå¯ä»¥ç”¨åœ¨æœ‰å¤§é‡ç‰¹å¾å˜é‡çš„çº¿æ€§å›å½’é—®é¢˜ã€‚æˆ–è€…æˆ‘ä»¬ä»¥ååœ¨è¯¾ç¨‹ä¸­ï¼Œä¼šè®²åˆ°çš„ä¸€äº›å…¶ä»–çš„ç®—æ³•ï¼Œå› ä¸ºæ ‡å‡†æ–¹ç¨‹æ³•ä¸é€‚åˆæˆ–è€…ä¸èƒ½ç”¨åœ¨å®ƒä»¬ä¸Šã€‚ä½†å¯¹äºè¿™ä¸ªç‰¹å®šçš„çº¿æ€§å›å½’æ¨¡å‹ï¼Œæ ‡å‡†æ–¹ç¨‹æ³•æ˜¯ä¸€ä¸ªæ¯”æ¢¯åº¦ä¸‹é™æ³•æ›´å¿«çš„æ›¿ä»£ç®—æ³•ã€‚æ‰€ä»¥ï¼Œæ ¹æ®å…·ä½“çš„é—®é¢˜ï¼Œä»¥åŠä½ çš„ç‰¹å¾å˜é‡çš„æ•°é‡ï¼Œè¿™ä¸¤ç§ç®—æ³•éƒ½æ˜¯å€¼å¾—å­¦ä¹ çš„ã€‚</p>
<p>æ­£è§„æ–¹ç¨‹çš„<strong>python</strong>å®ç°ï¼š</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a> <span class="k">def</span> <span class="nf">normalEqn</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>   <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="nd">@X</span><span class="p">)</span><span class="nd">@X</span><span class="o">.</span><span class="n">T</span><span class="nd">@y</span> <span class="c1">#X.T@Xç­‰ä»·äºX.T.dot(X)</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>   <span class="k">return</span> <span class="n">theta</span>
</code></pre></div>
<p><br>
<br>
<br></p>
<div class="admonition info">
<p><strong>ä»¥ä¸‹æ˜¯æ­£è§„æ–¹ç¨‹è‹±æ–‡ç‰ˆ(æœ‰è¯¦ç»†æ¨å¯¼-è‡ªå·±åŠ ä¸Šçš„)ï¼Œå…¶ä»–å†…å®¹æ¥æºäº2006å¹´éº»çœç†å·¥cs 2009æœºå™¨å­¦ä¹ çš„noteã€‚</strong></p>
</div>
<h2 id="7-the-normal-equations">7. The normal equations</h2>
<!--
ä¸‹é¢è¿™ä¸ªcssç”¨äºæ§åˆ¶pæ ‡ç­¾çš„ä¸¤ç«¯å¯¹é½
-->
<style type="text/css">
p {
    text-align: justify;  /*æ–‡æœ¬ä¸¤ç«¯å¯¹é½*/
}
</style>

<p>Gradient descent gives one way of minimizing <span class="arithmatex">\(J\)</span>. Lets discuss a second way of doing so, this time performing the minimization explicitly and without resorting to an iterative algorithm. In this method, we will minimize <span class="arithmatex">\(J\)</span> by explicitly taking its derivatives with respect to the <span class="arithmatex">\(Î¸_j's\)</span>, and setting them to zero. To enable us to do this without having to write reams of algebra and pages full of matrices of derivatives, lets introduce some notation for doing calculus with matrices. </p>
<h3 id="71-matrix-derivatives">7.1 Matrix derivatives</h3>
<p>For a function <span class="arithmatex">\(f\)</span> : <span class="arithmatex">\(\mathbb{R^{m\times n}} \rightarrow \mathbb{R}\)</span> mapping from <span class="arithmatex">\(\text{m-by-n}\)</span> matrices to the real numbers, we define the derivative of f with respect to A to be:</p>
<div class="arithmatex">\[
\nabla _Af(A)=\begin{bmatrix} \frac{\partial f}{\partial A_{11}} &amp; \cdots  &amp; \frac{\partial f}{\partial A_{1n}} \\\\ 
\vdots  &amp; \ddots &amp; \vdots \\\\
\frac{\partial f}{\partial A_{m1}} &amp; \cdots  &amp; \frac{\partial f}{\partial A_{mn}}\end{bmatrix}
\]</div>
<p>Thus, the gradient <span class="arithmatex">\(\nabla _Af(A)\)</span> is itself an <span class="arithmatex">\(\text{m-by-n}\)</span>  matrix, whose <span class="arithmatex">\((i,j)\)</span>-element is <span class="arithmatex">\(\frac{\partial f}{\partial A_{ij}}\)</span>. For example, suppose <span class="arithmatex">\(A =\bigl( \begin{smallmatrix} A_{11}  &amp; A_{12} \\ A_{21} &amp; A_{22} \end{smallmatrix} \bigr)\)</span> is a 2-by-2 matrix, and the function <span class="arithmatex">\(f\)</span>: <span class="arithmatex">\(\mathbb{R^{2\times 2}}\rightarrow \mathbb{R}\)</span> is given by</p>
<div class="arithmatex">\[
f(A)=\frac{3}{2}A_{11}+5A_{12}^2+A_{21}A_{22}
\]</div>
<p>Here, <span class="arithmatex">\(A_{ij}\)</span> denotes the <span class="arithmatex">\((i,j)\)</span> entry of the matrix <span class="arithmatex">\(A\)</span>. We then have</p>
<div class="arithmatex">\[
\nabla _Af(A)=\begin{bmatrix} 
\frac{3}{2} &amp; 10A_{12}\\\\
A_{22} &amp; A_{21}
\end{bmatrix}
\]</div>
<p>&ensp; We also introduce the <strong>trace</strong> opertator, written by "tr.". For an <span class="arithmatex">\(\text{n-by-n}\)</span> (square) matrix A, the trace of A is defined to be the sum of its diagonal entries:</p>
<div class="arithmatex">\[
\operatorname{tr}A=\sum_{i=1}^nA_{ii}
\]</div>
<p>If <span class="arithmatex">\(a\)</span> is a real number (i.e., a 1-by-1 matrix), then <span class="arithmatex">\(\operatorname{tr} a = a\)</span>. (If you haven't seen this "opertator notation" before, you should think of the trace of <span class="arithmatex">\(A\)</span> as <span class="arithmatex">\(\operatorname{tr}(A)\)</span>, or as application of the "trace" function to the matrix <span class="arithmatex">\(A\)</span>. It's more commonly written without the parentheses, however.ï¼‰
&ensp; The trace opertator has the property that for two matrices <span class="arithmatex">\(A\)</span> and <span class="arithmatex">\(B\)</span> such that <span class="arithmatex">\(AB\)</span> is square, we have that <span class="arithmatex">\(\operatorname{tr}(AB)=\operatorname{tr}(BA)\)</span>. <a href="../../math in ML/2. M derivation/#25">è¯æ˜è¯·æŸ¥çœ‹æœºå™¨å­¦ä¹ ä¸­çš„æ•°å­¦çŸ¥è¯†ä¸­å…³äºè¿¹çš„äº¤æ¢å¾‹çš„è¯æ˜ã€‚</a> As corollaries of this, we also have, e.g.,</p>
<div class="arithmatex">\[ \operatorname{tr}(ABC)=\operatorname{tr}(CAB)=\operatorname{tr}(BCA)\]</div>
<div class="arithmatex">\[ \operatorname{tr}(ABCD)=\operatorname{tr}(DABC)=\operatorname{tr}(CDAB)=\operatorname{tr}(BCDA)\]</div>
<p>The following properties of the trace operator are also easily verified. Here, <span class="arithmatex">\(A\)</span> and <span class="arithmatex">\(B\)</span> are square matrices, and <span class="arithmatex">\(a\)</span> is a real number:</p>
<div class="arithmatex">\[ \operatorname{tr}(A) = \operatorname{tr}(A^T)\]</div>
<div class="arithmatex">\[ \operatorname{tr}(A+B) = \operatorname{tr}(A)+\operatorname{tr}(B)\]</div>
<div class="arithmatex">\[ \operatorname{tr}(aA) = a \operatorname{tr}(A)\]</div>
<p>&ensp; We now state without proof some facts of matrix derivatives (we wonâ€™t need some of these until later this quarter). Equation (4) applies only to non-singular square matrices A, where |A| denotes the determinant of A. We have:</p>
<div class="arithmatex">\[ \nabla_A \operatorname{tr}(AB)=B^T\\\\ \tag{1}\]</div>
<div class="arithmatex">\[ \nabla_{A^T}f(A) = \big(\nabla_Af(A)\big)^T \\\\\tag{2}\]</div>
<div class="arithmatex">\[ \nabla_A \operatorname{tr}ABA^TC=CAB+C^TAB^T \\\\\tag{3} \]</div>
<div class="arithmatex">\[\nabla_A|A|=|A|(A^{-1})^T\\\\\tag{4}\]</div>
<hr />
<p>å´æ©è¾¾è€å¸ˆä¸ç»™ä½ ä»¬è¯æ˜ï¼Œæˆ‘æ¥ç»™ä½ ä»¬è¯æ˜<img alt="ğŸ˜" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/1f60e.svg" title=":sunglasses:" /></p>
<p>è¯·åœ¨çœ‹ä¸‹é¢æ¨å¯¼ä¹‹å‰, åŠ¡å¿…å…ˆçœ‹æ‡‚æˆ‘è¿™ä¸ªçŸ¥è¯†åº“ä¸­<strong>æœºå™¨å­¦ä¹ ä¸­çš„æ•°å­¦çŸ¥è¯†</strong>&ensp;---&ensp;( <strong>ä¸€. çŸ©é˜µæ±‚å¯¼æœ¬è´¨ &amp;äºŒ. çŸ©é˜µæ±‚å¯¼</strong>)ã€‚</p>
<p><img alt="2_7_1" src="../../assets/images/2_7_1.png" /></p>
<p>I. <span class="arithmatex">\(\nabla_A \operatorname{tr}(AB)=B^T\)</span></p>
<p><strong>è¯æ˜:</strong></p>
<p>ç”± <a href="../../math in ML/2. M derivation/#24">äºŒ.çŸ©é˜µæ±‚å¯¼ä¸­---(6)å¼çš„è¯æ˜</a> æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š</p>
<p>å¯¹äºä¸¤ä¸ªé˜¶æ•°éƒ½æ˜¯ <span class="arithmatex">\(m \times n\)</span> çš„çŸ©é˜µ <span class="arithmatex">\(C_{m \times n}, D_{m \times n}\)</span> å…¶ä¸­<strong>ä¸€ä¸ªçŸ©é˜µä¹˜ä»¥ï¼ˆå·¦ä¹˜å³ä¹˜éƒ½å¯ä»¥ï¼‰å¦ä¸€ä¸ªçŸ©é˜µçš„ <mark>è½¬ç½®</mark> çš„è¿¹ï¼Œæœ¬è´¨æ˜¯ <span class="arithmatex">\(C_{m \times n}, D_{m \times n}\)</span> ä¸¤ä¸ªçŸ©é˜µå¯¹åº”ä½ç½®çš„å…ƒç´ ç›¸ä¹˜å¹¶ç›¸åŠ </strong>ã€‚</p>
<p>æ‰€ä»¥è¿™é‡Œ <span class="arithmatex">\(\operatorname{tr}(AB)\)</span> ç›¸å½“äºå°±æ˜¯ <span class="arithmatex">\(A\)</span> å’Œ <span class="arithmatex">\(B^T\)</span>  æ¯ä¸€ä¸ªä½ç½®å¯¹åº”å…ƒç´  <mark>ç›¸ä¹˜å¹¶ç›¸åŠ </mark> ã€‚
å…¶ä¸­, <span class="arithmatex">\(A_{m \times n}, B_{n \times m}\)</span>ã€‚</p>
<p>æ¥ç€, ç”± <a href="../../math in ML/1. M derivation essence/#23_1">äºŒ.çŸ©é˜µæ±‚å¯¼æœ¬è´¨---(11)å¼</a> æˆ‘ä»¬å¯ä»¥çŸ¥é“:</p>
<p>è¿™é‡Œæ±‚ <span class="arithmatex">\(\nabla_A \operatorname{tr}(AB)\)</span> ç›¸å½“äº <span class="arithmatex">\(\operatorname{tr}(AB)\)</span> æŒ‰ç…§ <span class="arithmatex">\(A\)</span> çŸ©é˜µåˆ†å¸ƒçš„æ¯ä¸ªä½ç½®å…ƒç´ æ±‚åå¯¼ã€‚</p>
<p>æ‰€ä»¥, ç»¼ä¸Šæ‰€è¿°, <span class="arithmatex">\(\nabla_A \operatorname{tr}(AB)=B^T\)</span>ã€‚</p>
<p><strong>è¯æ¯•ã€‚</strong></p>
<p>II. <span class="arithmatex">\(\nabla_{A^T}f(A) = \big(\nabla_Af(A)\big)^T\)</span></p>
<p><strong>è¯æ˜:</strong></p>
<p>ç”± <a href="../../math in ML/1. M derivation essence/#23_1">äºŒ.çŸ©é˜µæ±‚å¯¼æœ¬è´¨---(11)å¼</a> å¯çŸ¥:</p>
<div class="arithmatex">\[
\begin{align}
\nabla_{A^T}f(A) &amp;=
\begin{bmatrix} \frac{\partial f}{\partial a_{11}} &amp; \cdots  &amp; \frac{\partial f}{\partial a_{m1}} 
\\ \vdots &amp; \ddots &amp; \vdots 
\\ \frac{\partial f}{\partial x_{1n}} &amp; \cdots &amp; \frac{\partial f}{\partial x_{mn}} \\
\end{bmatrix}\\\\
 &amp; = \begin{bmatrix} \frac{\partial f}{\partial a_{11}} &amp; \cdots  &amp; \frac{\partial f}{\partial a_{1n}} 
\\ \vdots &amp; \ddots &amp; \vdots 
\\ \frac{\partial f}{\partial x_{m1}} &amp; \cdots &amp; \frac{\partial f}{\partial x_{mn}} \\
\end{bmatrix}\\\\
 &amp; = \big(\nabla_Af(A)\big)^T
\end{align}
\]</div>
<p><strong>è¯æ¯•ã€‚</strong></p>
<p>III. <span class="arithmatex">\(\nabla_A \operatorname{tr}ABA^TC=CAB+C^TAB^T\)</span></p>
<p><strong>è¯æ˜:</strong></p>
<p>é¦–å…ˆ, æˆ‘ä»¬è¦æ˜ç¡®è¿™é‡Œçš„ <span class="arithmatex">\(ABA^TC\)</span> æ˜¯å…³äº <span class="arithmatex">\(A\)</span> çŸ©é˜µçš„å®å€¼æ ‡é‡å‡½æ•°, æ‰€ä»¥, æˆ‘ä»¬å¯ä»¥ä»¤ <span class="arithmatex">\(f(A)=ABA^TC\)</span>ã€‚</p>
<div class="admonition note">
<p><strong>æ³¨æ„:</strong> è¿™é‡Œçš„æ ‡è®°, ç”±äº <span class="arithmatex">\(A\)</span> å…¶å®æ˜¯çŸ©é˜µå˜å…ƒ, åº”è¯¥æ ‡è®°ä¸º <span class="arithmatex">\(f(\pmb A)=\pmb A B \pmb A^TC\)</span>, æ‰€ä»¥åé¢çš„æ¨å¯¼è¿‡ç¨‹,æˆ‘ä»¬ä¸¥è°¨ä¸€äº›, å°†çŸ©é˜µå˜å…ƒ <span class="arithmatex">\(A\)</span> æ ‡è®°ä¸º <span class="arithmatex">\(\pmb A\)</span>ã€‚</p>
</div>
<p>ä»”ç»†æƒ³ä½ ä¼šå‘ç°ï¼Œå¯¹äºå®å€¼æ ‡é‡å‡½æ•° <span class="arithmatex">\(f (\pmb{A})\)</span>, <span class="arithmatex">\(\operatorname{tr}\big( f(\pmb A) \big)=f(\pmb A)\)</span> , <span class="arithmatex">\(\mathbb{d}f(\pmb A)=\operatorname{tr}\big( \mathbb{d}f(\pmb A) \big)\)</span></p>
<p>æ‰€ä»¥æœ‰ <span class="arithmatex">\(\mathbb{d}f(\pmb A)=\mathbb{d}\big(\operatorname{tr}f(\pmb A)\big)=\operatorname{tr}\big( \mathbb{d}f(\pmb A) \big)\)</span> ã€‚</p>
<p>ç”± <a href="../../math in ML/2. M derivation/#32_1">äºŒ.çŸ©é˜µæ±‚å¯¼æœ¬è´¨---(24)å¼</a> å³:</p>
<div class="arithmatex">\[
\mathbb{d}f(\pmb{X})= \operatorname{tr}\Big(\frac{\partial f(\pmb{X})}{\partial \pmb{X}^T}\mathbb{d}\pmb{X}\Big)
\]</div>
<p>æˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªçŸ©é˜µå˜å…ƒçš„å®å€¼æ ‡é‡å‡½æ•°çš„å…¨å¾®åˆ†å†™æˆä¸Šå¼ï¼Œæˆ‘ä»¬å°±æ‰¾åˆ°äº†çŸ©é˜µæ±‚å¯¼çš„ç»“æœ, ä¹Ÿå³: </p>
<div class="arithmatex">\[
\mathbb{d}f(\pmb{A})= \operatorname{tr}\Big(\frac{\partial f(\pmb{A})}{\partial \pmb{A}^T}\mathbb{d}\pmb{A}\Big)\\\\
\tag{II.1}
\]</div>
<p>ç”±æˆ‘ä»¬è¯æ˜çš„ II. <span class="arithmatex">\(\nabla_{A^T}f(A) = \big(\nabla_Af(A)\big)^T\)</span>å¾—:</p>
<div class="arithmatex">\[
\frac{\partial f(\pmb{A})}{\partial \pmb{A}^T} = \nabla _{\pmb A^T}f(\pmb A)=\big(\nabla _{\pmb A}f(\pmb A)\big)^T
\]</div>
<p>æ‰€ä»¥æˆ‘ä»¬è¦æ±‚çš„:</p>
<div class="arithmatex">\[
\nabla _{\pmb A}f(\pmb A)=\Big(\frac{\partial f(\pmb{A})}{\partial \pmb{A}^T}\Big)^T \\\\
\tag{II.2}
\]</div>
<p>æœ€ç»ˆæˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯è½¬åŒ–ä¸ºæ±‚ <span class="arithmatex">\(\mathbb{d}f(\pmb{A})\)</span> çš„å…¨å¾®åˆ†, ä¸‹é¢å¼€å§‹æ¨å¯¼ï¼š</p>
<div class="arithmatex">\[
\begin{aligned}
\mathbb{d}f(\pmb{A}) &amp; = \mathbb{d}\pmb A B \pmb A^TC \\\\
 &amp; = \mathbb{d}\operatorname{tr}(\pmb A B \pmb A^TC)\\\\
 &amp; = \mathbb{d}\operatorname{tr}(C \pmb A B \pmb A^T)\\\\
 &amp; = \operatorname{tr}\mathbb{d}(C \pmb A B \pmb A^T)\\\\
 &amp; = \operatorname{tr}\Big(\mathbb{d}(C \pmb A) B \pmb A^T +  C \pmb A \mathbb{d}(B \pmb A^T)\Big)\\\\
 &amp; = \operatorname{tr}\Big(C(\mathbb{d}\pmb A) B \pmb A^T +  C \pmb A B \mathbb{d}\pmb A^T\Big)\\\\
 &amp; = \operatorname{tr}\Big(B \pmb A^T C\mathbb{d}\pmb A \Big) + \operatorname{tr}\Big( C \pmb A B \mathbb{d}\pmb A^T\Big)\\\\
 &amp; = \operatorname{tr}\Big(B \pmb A^T C\mathbb{d}\pmb A \Big) + \operatorname{tr}\Big( C \pmb A B (\mathbb{d}\pmb A)^T\Big)\\\\
 &amp; = \operatorname{tr}\Big(B \pmb A^T C\mathbb{d}\pmb A \Big) + \operatorname{tr}\Big(\mathbb{d}\pmb A (B^T \pmb A^T C^T )\Big)\\\\
 &amp; = \operatorname{tr}\Big(B \pmb A^T C\mathbb{d}\pmb A \Big) + \operatorname{tr}\Big( B^T\pmb A^T C^T  \mathbb{d}\pmb A\Big)\\\\
 &amp; = \operatorname{tr}\Big[(B \pmb A^T C + B^T\pmb A^T C^T) \mathbb{d}\pmb A\Big]\\\\
\end{aligned}
\]</div>
<blockquote>
<p>æ•°å­—æ˜¯æ­¥éª¤ æ±‰å­—æ˜¯æ¯ä¸€æ­¥ä¾æ® <br>
01 -&gt; 02 å®å€¼æ ‡é‡å‡½æ•°çš„æ€§è´¨ <br>
02 -&gt; 03 è¿¹çš„äº¤æ¢å¾‹ <br>
03 -&gt; 04 å®å€¼æ ‡é‡å‡½æ•°çš„æ€§è´¨ <br>
04 -&gt; 05 çŸ©é˜µå¾®åˆ†çš„ä¹˜ç§¯æ³•åˆ™ <br>
05 -&gt; 06 å¤¹å±‚é¥¼ <br>
06 -&gt; 07 è¿¹çš„çº¿æ€§æ³•åˆ™, è¿¹çš„äº¤æ¢å¾‹ <br>
07 -&gt; 08 çŸ©é˜µå¾®åˆ†çš„è½¬ç½®æ³•åˆ™ <br>
08 -&gt; 09 è½¬ç½®çš„è¿¹ç­‰äºåŸçŸ©é˜µçš„è¿¹ <br>
09 -&gt; 10 è¿¹çš„äº¤æ¢å¾‹ <br>
10 -&gt; 11 è¿¹çš„çº¿æ€§æ³•åˆ™ <br></p>
</blockquote>
<p>ç»“åˆå‰é¢çš„ <span class="arithmatex">\((II.1)\)</span> å¼å¯å¾—:</p>
<div class="arithmatex">\[
\frac{\partial f(\pmb{A})}{\partial \pmb{A}^T}=B \pmb A^T C + B^T\pmb A^T C^T
\]</div>
<p>å†ç»“åˆå‰é¢çš„ <span class="arithmatex">\((II.2)\)</span> å¼å¯å¾—:</p>
<div class="arithmatex">\[
\begin{aligned}
\nabla _{\pmb A}f(\pmb A) &amp; = \Big(\frac{\partial f(\pmb{A})}{\partial \pmb{A}^T}\Big)^T \\\\
&amp; = (B \pmb A^T C + B^T\pmb A^T C^T)^T\\\\
&amp; = C^T \pmb A B^T + C \pmb A B 
\end{aligned}
\]</div>
<p><strong>è¯æ¯•ã€‚</strong></p>
<p>IV. <span class="arithmatex">\(\nabla_A|A|=|A|(A^{-1})^T\\\\\)</span></p>
<p><strong>è¯æ˜:</strong></p>
<p>ç”± <a href="../../math in ML/2. M derivation/#322">çŸ©é˜µè¡Œåˆ—å¼å¾®åˆ† å³(25.2.1)å¼</a>çš„è¯æ˜å¯çŸ¥:</p>
<div class="arithmatex">\[
\mathbb{d} |\pmb A| = \operatorname{tr}(|\pmb A|\pmb A^{-1}\mathbb{d}\pmb A)
\]</div>
<p>å†ç”± <a href="../../math in ML/2. M derivation/#32_1">äºŒ.çŸ©é˜µæ±‚å¯¼æœ¬è´¨---(24)å¼</a>å¯å¾—ï¼š</p>
<div class="arithmatex">\[
\frac{\partial |\pmb A|}{\partial \pmb A^T}=|\pmb A|\pmb A^{-1}
\]</div>
<p>å› æ­¤,</p>
<div class="arithmatex">\[
\begin{aligned}
\nabla _{\pmb A}|\pmb A| &amp; = (\frac{\partial |\pmb A|}{\partial \pmb A^T})^T \\\\
&amp;=(|\pmb A|\pmb A^{-1})^T\\\\
&amp;=|\pmb A|(\pmb A^{-1})^T
\end{aligned}
\]</div>
<p><strong>è¯æ¯•ã€‚</strong></p>
<p>è‡³æ­¤, å´æ©è¾¾è€å¸ˆçœç•¥çš„è¯æ˜, å…¨éƒ¨è¯æ˜å®Œæ¯•ã€‚ä¸‹é¢ç»§ç»­è®°ç¬”è®°ã€‚</p>
<hr />
<p>To make our martix notation more concrete, let us now explain in detail the meaning of the first of these equations. Suppose we have some fixed matrix <span class="arithmatex">\(B \in \mathbb{R}^{n\times m}\)</span> . We can then define a function <span class="arithmatex">\(f :\mathbb{R}^{m\times n}\rightarrow \mathbb{R}\)</span> according to <span class="arithmatex">\(f(A)=AB\)</span>. Note that this definition makes sense, because if <span class="arithmatex">\(A \in \mathbb{R}^{m\times n}\)</span>, then <span class="arithmatex">\(AB\)</span> is a square matrix, and we can apply the trace operator to it; thus, <span class="arithmatex">\(f\)</span> does indeed map from <span class="arithmatex">\(\mathbb{R}^{m\times n}\)</span> to <span class="arithmatex">\(\mathbb{R}\)</span>. We can then apply our definition of matrix derivatives to find <span class="arithmatex">\(\nabla _Af(A)\)</span>, which will itself by an m-by-n matrix. Equation (1) above states that the <span class="arithmatex">\((i,j)\)</span> entry of this matrix will given by the <span class="arithmatex">\((i,j)\)</span>-entry of <span class="arithmatex">\(B^T\)</span> , or equivalently, by <span class="arithmatex">\(B_{j,i}\)</span> .</p>
<p>&ensp; The proofs of Equation (1-3) are reasonably simply, and are left as an exercise to the reader. Equation (4) can be derived using adjoint representation of the inverse of a martix.</p>
<h3 id="72-least-squares-revisited">7.2 Least squares revisited</h3>
<p>Armed with the tools of matrix derivatives, let us now proceed to find in closed-form the value of <span class="arithmatex">\(\theta\)</span> that minimizes <span class="arithmatex">\(J(\theta)\)</span>. We begin by re-writing <span class="arithmatex">\(J\)</span> in matrix-vectorial notation.</p>
<p>&ensp;Giving a training set, define <strong>the design matrix</strong> <span class="arithmatex">\(X\)</span> to be the m-by-n matrix (actually m-by-n+1, if we include the intercept term) that contains the training examples' input values in its row:</p>
<div class="arithmatex">\[
X = \begin{bmatrix} --- &amp; (x^{(1)})^T &amp; --- \\\\ --- &amp; (x^{(2)})^T &amp;  ---
\\\\ &amp; \vdots &amp;
\\\\ --- &amp; (x^{(m)})^T &amp; ---
\end{bmatrix}
\]</div>
<p>Also, let <span class="arithmatex">\(\vec{y}\)</span> be the m-dimensional vector containing all the target values from the training set:</p>
<div class="arithmatex">\[
\vec{y}=\begin{bmatrix} 
y^{(1)}\\\\
y^{(2)}\\\\
\vdots\\\\
y^{(m)}
\end{bmatrix}
\]</div>
<p>Now, since <span class="arithmatex">\(h_\theta\big(x^{(i)}\big)=(x^{(i)})^T\theta\)</span>, we can easily verify that</p>
<div class="arithmatex">\[
\begin{aligned}
X\theta-\vec{y} &amp;= 
\begin{bmatrix} (x^{(1)})^T\theta \\\\  \vdots  \\\\
(x^{(m)})^T\theta
\end{bmatrix} - \begin{bmatrix}  y^{(1)}\\\\
\vdots\\\\
y^{(m)}
\end{bmatrix}\\\\
&amp; = \begin{bmatrix}
(x^{(1)})^T\theta- y^{(1)} \\\\
  \vdots \\\\
(x^{(m)})^T\theta- y^{(m)} 
\end{bmatrix}
\end{aligned}
\]</div>
<p>Thus, using the fact for a vector <span class="arithmatex">\(z\)</span> , we have that <span class="arithmatex">\(z^Tz=\sum_{i}z_i^2\)</span> .</p>
<div class="arithmatex">\[
\begin{aligned}
\frac{1}{2}(X\theta-\vec{y})^T(X\theta-\vec{y})&amp;=\frac{1}{2}\sum_{i=1}^m\Big(h_\theta(x^{(i)})- y^{(i)} \Big)^2\\\\
&amp;=J(\theta)
\end{aligned}
\]</div>
<p>Finally , to minimize <span class="arithmatex">\(J\)</span> , lets find its derivatives with respect to <span class="arithmatex">\(\theta\)</span> . Combining Equations (2) and (3) , we find that</p>
<div class="arithmatex">\[
\nabla _{A^T}\operatorname{tr}(ABA^TC)=B^TA^TC^T+BA^TC \\\\
\tag{5}
\]</div>
<p>Hence,</p>
<div class="arithmatex">\[
\begin{aligned}
\nabla _\theta J(\theta) &amp; = \nabla _\theta \frac{1}{2}(X\theta-\vec{y})^T(X\theta-\vec{y}) \\\\
&amp; = \frac{1}{2} \nabla _\theta(\theta^TX^TX\theta-\theta^TX^T \vec{y}-\vec{y}^TX \theta+\vec{y}^T \vec{y})\\\\
&amp; = \frac{1}{2} \nabla _\theta \operatorname{tr}(\theta^TX^TX\theta-\theta^TX^T \vec{y}-\vec{y}^TX \theta+\vec{y}^T \vec{y})\\\\
&amp; = \frac{1}{2} \nabla _\theta\Big(\operatorname{tr}(\theta^TX^TX\theta)-2\operatorname{tr}(\vec{y}^TX \theta)\Big)\\\\
&amp; = \frac{1}{2}(X^TX \theta+X^TX \theta-2X^T \vec{y})\\\\
&amp; = X^TX \theta-X^T \vec{y}
\end{aligned}
\]</div>
<p>In the third step, we used the fact that the trace if a real number is just the real number; the fourth step used the fact that <span class="arithmatex">\(\operatorname{tr}(A)=\operatorname{tr}(A^T)\)</span> , and the fifth step used Equation (5) with <span class="arithmatex">\(A^T=\theta\)</span>, <span class="arithmatex">\(B=B^T=X^TX\)</span> , and <span class="arithmatex">\(C=I\)</span>, and Equation (1). To minimize <span class="arithmatex">\(J\)</span> , we set its derivatives to zero, and obtain the normal equations:</p>
<div class="arithmatex">\[
X^TX \theta=X^T \vec{y}
\]</div>
<p>Thus, the value of <span class="arithmatex">\(\theta\)</span> that minimize <span class="arithmatex">\(J(\theta)\)</span> is given in closed form by the equation</p>
<div class="arithmatex">\[
\theta = (X^TX)^{-1}X^T \vec{y}
\]</div>
<h2 id="8">8. æ­£è§„æ–¹ç¨‹åŠä¸å¯é€†æ€§</h2>
<div class="admonition note">
<p>å‚è€ƒè§†é¢‘: 4 - 7 - Normal Equation Noninvertibility (Optional) (6 min).mkv</p>
</div>
<p>åœ¨è¿™æ®µè§†é¢‘ä¸­è°ˆè°ˆæ­£è§„æ–¹ç¨‹ ( <strong>normal equation</strong> )ï¼Œä»¥åŠå®ƒä»¬çš„ä¸å¯é€†æ€§ã€‚</p>
<p>æˆ‘ä»¬è¦è®²çš„é—®é¢˜å¦‚ä¸‹ï¼š<span class="arithmatex">\(\theta ={{\left( {X^{T}}X \right)}^{-1}}{X^{T}}y\)</span> å½“è®¡ç®— <span class="arithmatex">\(\theta\)</span>=<code>inv(X'X ) X'y</code> ï¼Œé‚£å¯¹äºçŸ©é˜µ <span class="arithmatex">\(X'X\)</span> çš„ç»“æœæ˜¯ä¸å¯é€†çš„æƒ…å†µå’‹åŠå‘¢?</p>
<p>æˆ‘ä»¬éƒ½çŸ¥é“ï¼Œæœ‰äº›çŸ©é˜µå¯é€†(<strong>invertible</strong>)ï¼Œè€Œæœ‰äº›çŸ©é˜µä¸å¯é€†(<strong>non-invertible</strong>)ã€‚æˆ‘ä»¬ç§°é‚£äº›ä¸å¯é€†çŸ©é˜µä¸ºå¥‡å¼‚(<strong>singular</strong>)æˆ–é€€åŒ–(<strong>dgenerate</strong>)çŸ©é˜µã€‚</p>
<p>é¦–å…ˆ, è¯´ä¸€ä¸‹  <strong><span class="arithmatex">\(\pmb X'\pmb X\)</span> ä¸å¯é€†çš„åŸå› </strong>ã€‚</p>
<ul>
<li>
<ol>
<li><strong>ç‰¹å¾å€¼çº¿æ€§ç›¸å…³</strong></li>
</ol>
<p>ä¾‹å¦‚ï¼Œåœ¨é¢„æµ‹ä½æˆ¿ä»·æ ¼æ—¶ï¼Œå¦‚æœ<span class="arithmatex">\({x_{1}}\)</span>æ˜¯ä»¥è‹±å°ºä¸ºå°ºå¯¸è§„æ ¼è®¡ç®—çš„æˆ¿å­ï¼Œ<span class="arithmatex">\({x_{2}}\)</span>æ˜¯ä»¥å¹³æ–¹ç±³ä¸ºå°ºå¯¸è§„æ ¼è®¡ç®—çš„æˆ¿å­ï¼ŒåŒæ—¶ï¼Œä½ ä¹ŸçŸ¥é“1ç±³ç­‰äº3.28è‹±å°º ( å››èˆäº”å…¥åˆ°ä¸¤ä½å°æ•° )ï¼Œè¿™æ ·ï¼Œä½ çš„è¿™ä¸¤ä¸ªç‰¹å¾å€¼å°†å§‹ç»ˆæ»¡è¶³çº¦æŸï¼š<span class="arithmatex">\({x_{1}}={x_{2}}*{{\left( 3.28 \right)}^{2}}\)</span>ã€‚ å®é™…ä¸Šï¼Œå¦‚æœä½ ç”¨è¿™æ ·çš„ä¸€ä¸ªçº¿æ€§æ–¹ç¨‹ï¼Œæ¥å±•ç¤ºé‚£ä¸¤ä¸ªç›¸å…³è”çš„ç‰¹å¾å€¼ï¼ŒçŸ©é˜µ<span class="arithmatex">\(X'X\)</span>å°†æ˜¯ä¸å¯é€†çš„ã€‚</p>
</li>
<li>
<ol>
<li><strong>ç‰¹å¾å€¼çš„æ•°é‡å°äºè®­ç»ƒé›†çš„æ•°é‡</strong></li>
</ol>
<p>å…·ä½“åœ°è¯´ï¼Œåœ¨<span class="arithmatex">\(m\)</span>å°äºæˆ–ç­‰äºnçš„æ—¶å€™ï¼Œä¾‹å¦‚ï¼Œæœ‰<span class="arithmatex">\(m\)</span>ç­‰äº10ä¸ªçš„è®­ç»ƒæ ·æœ¬ä¹Ÿæœ‰<span class="arithmatex">\(n\)</span>ç­‰äº100çš„ç‰¹å¾æ•°é‡ã€‚è¦æ‰¾åˆ°é€‚åˆçš„<span class="arithmatex">\((n +1)\)</span> ç»´å‚æ•°çŸ¢é‡<span class="arithmatex">\(\theta\)</span>ï¼Œè¿™å°†ä¼šå˜æˆä¸€ä¸ª101ç»´çš„çŸ¢é‡ï¼Œå°è¯•ä»10ä¸ªè®­ç»ƒæ ·æœ¬ä¸­æ‰¾åˆ°æ»¡è¶³101ä¸ªå‚æ•°çš„å€¼ï¼Œè¿™å·¥ä½œå¯èƒ½ä¼šè®©ä½ èŠ±ä¸Šä¸€é˜µå­æ—¶é—´ï¼Œä½†è¿™å¹¶ä¸æ€»æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ã€‚å› ä¸ºï¼Œæ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°ä½ åªæœ‰10ä¸ªæ ·æœ¬ï¼Œä»¥é€‚åº”è¿™100æˆ–101ä¸ªå‚æ•°ï¼Œæ•°æ®è¿˜æ˜¯æœ‰äº›å°‘ã€‚<strong>è¿™ç›¸å½“äºè¯´æ˜¯å¤šå…ƒæ–¹ç¨‹ç»„ä¸­æœªçŸ¥æ•°çš„ä¸ªæ•°è¿œå¤§äºæ–¹ç¨‹çš„ä¸ªæ•°ã€‚</strong></p>
</li>
</ul>
<p>ç¨åæˆ‘ä»¬å°†çœ‹åˆ°ï¼Œ<strong>å¦‚ä½•ä½¿ç”¨å°æ•°æ®æ ·æœ¬ä»¥å¾—åˆ°è¿™100æˆ–101ä¸ªå‚æ•°</strong>ï¼Œ<strong>é€šå¸¸ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨</strong>ä¸€ç§å«åš<strong>æ­£åˆ™åŒ–</strong>çš„çº¿æ€§ä»£æ•°æ–¹æ³•ï¼Œ<strong>é€šè¿‡åˆ é™¤æŸäº›ç‰¹å¾æˆ–è€…æ˜¯ä½¿ç”¨æŸäº›æŠ€æœ¯ï¼Œæ¥è§£å†³å½“<span class="arithmatex">\(m\)</span>æ¯”<span class="arithmatex">\(n\)</span>å°çš„æ—¶å€™çš„é—®é¢˜</strong>ã€‚å³ä½¿ä½ æœ‰ä¸€ä¸ªç›¸å¯¹è¾ƒå°çš„è®­ç»ƒé›†ï¼Œä¹Ÿå¯ä½¿ç”¨å¾ˆå¤šçš„ç‰¹å¾æ¥æ‰¾åˆ°å¾ˆå¤šåˆé€‚çš„å‚æ•°ã€‚</p>
<p>æ€»ä¹‹å½“ä½ å‘ç°çš„çŸ©é˜µ<span class="arithmatex">\(X'X\)</span>çš„ç»“æœæ˜¯å¥‡å¼‚çŸ©é˜µï¼Œæˆ–è€…æ‰¾åˆ°çš„å…¶å®ƒçŸ©é˜µæ˜¯ä¸å¯é€†çš„ï¼Œæˆ‘ä¼šå»ºè®®ä½ è¿™ä¹ˆåšã€‚</p>
<p>é¦–å…ˆï¼Œ<strong>çœ‹ç‰¹å¾å€¼é‡Œæ˜¯å¦æœ‰ä¸€äº›å¤šä½™çš„ç‰¹å¾</strong>ï¼Œåƒè¿™äº›<span class="arithmatex">\({x_{1}}\)</span>å’Œ<span class="arithmatex">\({x_{2}}\)</span>æ˜¯<strong>çº¿æ€§ç›¸å…³</strong>çš„ï¼Œäº’ä¸ºçº¿æ€§å‡½æ•°ã€‚åŒæ—¶ï¼Œå½“æœ‰ä¸€äº›å¤šä½™çš„ç‰¹å¾æ—¶ï¼Œå¯ä»¥<strong>åˆ é™¤</strong>è¿™ä¸¤ä¸ªé‡å¤ç‰¹å¾é‡Œçš„<strong>å…¶ä¸­ä¸€ä¸ª</strong>ï¼Œæ— é¡»ä¸¤ä¸ªç‰¹å¾åŒæ—¶ä¿ç•™ï¼Œå°†è§£å†³ä¸å¯é€†æ€§çš„é—®é¢˜ã€‚å› æ­¤ï¼Œé¦–å…ˆåº”è¯¥é€šè¿‡è§‚å¯Ÿæ‰€æœ‰ç‰¹å¾æ£€æŸ¥æ˜¯å¦æœ‰å¤šä½™çš„ç‰¹å¾ï¼Œå¦‚æœæœ‰å¤šä½™çš„å°±åˆ é™¤æ‰ï¼Œç›´åˆ°ä»–ä»¬ä¸å†æ˜¯å¤šä½™çš„ä¸ºæ­¢ï¼Œå¦‚æœ<strong>ç‰¹å¾æ•°é‡</strong>å®åœ¨<strong>å¤ªå¤š</strong>ï¼Œæˆ‘ä¼š<strong>ç”¨è¾ƒå°‘çš„ç‰¹å¾</strong>æ¥<strong>åæ˜ å°½å¯èƒ½å¤šå†…å®¹</strong>ï¼Œ<strong>å¦åˆ™</strong>æˆ‘ä¼šè€ƒè™‘<strong>ä½¿ç”¨æ­£è§„åŒ–æ–¹æ³•</strong>ã€‚</p>
<p>å¦‚æœçŸ©é˜µ<span class="arithmatex">\(X'X\)</span>æ˜¯ä¸å¯é€†çš„ï¼Œï¼ˆé€šå¸¸æ¥è¯´ï¼Œä¸ä¼šå‡ºç°è¿™ç§æƒ…å†µï¼‰ï¼Œå¦‚æœåœ¨<strong>Octave</strong>é‡Œï¼Œå¯ä»¥ç”¨ä¼ªé€†å‡½æ•°<code>pinv()</code> æ¥å®ç°ã€‚è¿™ç§ä½¿ç”¨ä¸åŒçš„çº¿æ€§ä»£æ•°åº“çš„æ–¹æ³•è¢«ç§°ä¸ºä¼ªé€†ã€‚å³ä½¿<span class="arithmatex">\(X'X\)</span>çš„ç»“æœæ˜¯ä¸å¯é€†çš„ï¼Œä½†ç®—æ³•æ‰§è¡Œçš„æµç¨‹æ˜¯æ­£ç¡®çš„ã€‚æ€»ä¹‹ï¼Œå‡ºç°ä¸å¯é€†çŸ©é˜µçš„æƒ…å†µæå°‘å‘ç”Ÿï¼Œæ‰€ä»¥åœ¨å¤§å¤šæ•°å®ç°çº¿æ€§å›å½’ä¸­ï¼Œå‡ºç°ä¸å¯é€†çš„é—®é¢˜ä¸åº”è¯¥è¿‡å¤šçš„å…³æ³¨<span class="arithmatex">\({X^{T}}X\)</span>æ˜¯ä¸å¯é€†çš„ã€‚</p>
<h2 id="_1">ä¹ é¢˜ &amp;&amp; å‚è€ƒç­”æ¡ˆ</h2>
<h3 id="_2">ç¬¬ä¸€é¢˜</h3>
<p>å‡è®¾m=4ä¸ªå­¦ç”Ÿä¸Šäº†ä¸€èŠ‚è¯¾, æœ‰æœŸä¸­è€ƒè¯•å’ŒæœŸæœ«è€ƒè¯•ã€‚ä½ å·²ç»æ”¶é›†äº†ä»–ä»¬åœ¨ä¸¤æ¬¡è€ƒè¯•ä¸­çš„åˆ†æ•°æ•°æ®é›†ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<table>
<thead>
<tr>
<th>æœŸä¸­å¾—åˆ†</th>
<th>(æœŸä¸­å¾—åˆ†)^2</th>
<th>æœŸæœ«å¾—åˆ†</th>
</tr>
</thead>
<tbody>
<tr>
<td>89</td>
<td>7921</td>
<td>96</td>
</tr>
<tr>
<td>72</td>
<td>5184</td>
<td>74</td>
</tr>
<tr>
<td>94</td>
<td>8836</td>
<td>87</td>
</tr>
<tr>
<td>69</td>
<td>4761</td>
<td>78</td>
</tr>
</tbody>
</table>
<p>ä½ æƒ³ç”¨å¤šé¡¹å¼å›å½’æ¥é¢„æµ‹ä¸€ä¸ªå­¦ç”Ÿçš„æœŸä¸­è€ƒè¯•æˆç»©ã€‚å…·ä½“åœ°
è¯´, å‡è®¾ä½ æƒ³æ‹Ÿåˆä¸€ä¸ª <span class="arithmatex">\(h_ \theta (x) = \theta _0+\theta _1x_1++\theta _2x_1\)</span> çš„æ¨¡å‹, å…¶ä¸­x1æ˜¯æœŸä¸­å¾—åˆ†, x2æ˜¯ï¼ˆæœŸä¸­å¾—åˆ†ï¼‰^2ã€‚æ­¤å¤–, ä½ è®¡åˆ’åŒæ—¶ä½¿ç”¨ç‰¹å¾ç¼©æ”¾ï¼ˆé™¤ä»¥ç‰¹å¾çš„â€œæœ€å¤§å€¼-æœ€å°å€¼â€æˆ–èŒƒå›´ï¼‰å’Œå‡å€¼å½’ä¸€åŒ–ã€‚</p>
<p>é‚£ä¹ˆæ ‡å‡†åŒ–åçš„ <span class="arithmatex">\(x_2^{(4)}\)</span> ç‰¹å¾å€¼æ˜¯å¤šå°‘ï¼Ÿï¼ˆæç¤ºï¼šæœŸä¸­=89ï¼ŒæœŸæœ«=96æ˜¯è®­ç»ƒç¤ºä¾‹1ï¼‰</p>
<h3 id="_3">ç¬¬äºŒé¢˜</h3>
<p>ç”¨ <span class="arithmatex">\(\alpha=0.3\)</span> è¿›è¡Œ15æ¬¡æ¢¯åº¦ä¸‹é™è¿­ä»£, æ¯æ¬¡è¿­ä»£ <span class="arithmatex">\(j(\theta)\)</span> åè®¡ç®—ã€‚ä½ ä¼šå‘ç° <span class="arithmatex">\(j(\theta)\)</span> çš„å€¼ä¸‹é™ç¼“æ…¢, å¹¶ä¸”åœ¨15æ¬¡è¿­ä»£åä»åœ¨ä¸‹é™ã€‚åŸºäºæ­¤, ä»¥ä¸‹å“ªä¸ªç»“è®ºä¼¼ä¹æœ€å¯ä¿¡ï¼Ÿ</p>
<p>A.  <span class="arithmatex">\(\alpha=0.3\)</span> æ˜¯å­¦ä¹ ç‡çš„æœ‰æ•ˆé€‰æ‹©ã€‚</p>
<p>B. ä¸å…¶ä½¿ç”¨  <span class="arithmatex">\(\alpha\)</span> å½“å‰å€¼, ä¸å¦‚å°è¯•æ›´å°çš„  <span class="arithmatex">\(\alpha\)</span> å€¼ï¼ˆæ¯”å¦‚  <span class="arithmatex">\(\alpha=0.1\)</span> ï¼‰</p>
<p>C. ä¸å…¶ä½¿ç”¨  <span class="arithmatex">\(\alpha\)</span> å½“å‰å€¼, ä¸å¦‚å°è¯•æ›´å¤§çš„  <span class="arithmatex">\(\alpha\)</span> å€¼ï¼ˆæ¯”å¦‚  <span class="arithmatex">\(\alpha=1.0\)</span> ï¼‰</p>
<h3 id="_4">ç¬¬ä¸‰é¢˜</h3>
<p>å‡è®¾æ‚¨æœ‰m=14ä¸ªè®­ç»ƒç¤ºä¾‹, æœ‰n=3ä¸ªç‰¹æ€§ï¼ˆä¸åŒ…æ‹¬éœ€è¦å¦å¤–æ·»åŠ çš„æ’ä¸º1çš„æˆªè·é¡¹ï¼‰, æ­£è§„æ–¹ç¨‹æ˜¯ <span class="arithmatex">\(\theta=(X^TX)^{-1}X^Ty\)</span>ã€‚å¯¹äºç»™å®šmå’Œnçš„å€¼, è¿™ä¸ªæ–¹ç¨‹ä¸­ <span class="arithmatex">\(\theta, X, y\)</span> çš„ç»´æ•°åˆ†åˆ«æ˜¯å¤šå°‘ï¼Ÿ</p>
<p>A. <span class="arithmatex">\(X \  14 \times 3, y \  14\times 1, \  \theta 3 \times 3\)</span></p>
<p>B. <span class="arithmatex">\(X \  14 \times 4, y \  14\times 1, \  \theta 4 \times 1\)</span></p>
<p>C. <span class="arithmatex">\(X \  14 \times 3, y \  14\times 1, \  \theta 3 \times 1\)</span></p>
<p>D. <span class="arithmatex">\(X \  14 \times 4, y \  14\times 4, \  \theta 4 \times 4\)</span></p>
<h3 id="_5">ç¬¬ å›› é¢˜</h3>
<p>å‡è®¾æ‚¨æœ‰ä¸€ä¸ªæ•°æ®é›†ï¼Œæ¯ä¸ªç¤ºä¾‹æœ‰m=1000000ä¸ªç¤ºä¾‹å’Œn=200000ä¸ªç‰¹æ€§ã€‚ä½ æƒ³ç”¨å¤šå…ƒçº¿æ€§å›å½’æ¥æ‹Ÿåˆå‚æ•° <span class="arithmatex">\(\theta\)</span> åˆ°æˆ‘ä»¬çš„æ•°æ®ã€‚ä½ æ›´åº”è¯¥ç”¨æ¢¯åº¦ä¸‹é™è¿˜æ˜¯æ­£è§„æ–¹ç¨‹ï¼Ÿ</p>
<p>A. æ¢¯åº¦ä¸‹é™ï¼Œå› ä¸ºæ­£è§„æ–¹ç¨‹ä¸­ <span class="arithmatex">\(\theta=(X^TX)^{-1}\)</span> ä¸­è®¡ç®—éå¸¸æ…¢</p>
<p>B. æ­£è§„æ–¹ç¨‹ï¼Œå› ä¸ºå®ƒæä¾›äº†ä¸€ç§ç›´æ¥æ±‚è§£çš„æœ‰æ•ˆæ–¹æ³•</p>
<p>C. æ¢¯åº¦ä¸‹é™ï¼Œå› ä¸ºå®ƒæ€»æ˜¯æ”¶æ•›åˆ°æœ€ä¼˜ <span class="arithmatex">\(\theta\)</span></p>
<p>D. æ­£è§„æ–¹ç¨‹ï¼Œå› ä¸ºæ¢¯åº¦ä¸‹é™å¯èƒ½æ— æ³•æ‰¾åˆ°æœ€ä¼˜ <span class="arithmatex">\(\theta\)</span></p>
<h3 id="_6">ç¬¬ äº” é¢˜</h3>
<p>ä»¥ä¸‹å“ªäº›æ˜¯ä½¿ç”¨ç‰¹å¾ç¼©æ”¾çš„åŸå› ï¼Ÿ</p>
<p>A. å®ƒå¯ä»¥é˜²æ­¢æ¢¯åº¦ä¸‹é™é™·å…¥å±€éƒ¨æœ€ä¼˜</p>
<p>B. å®ƒé€šè¿‡é™ä½æ¢¯åº¦ä¸‹é™çš„æ¯æ¬¡è¿­ä»£çš„è®¡ç®—æˆæœ¬æ¥åŠ é€Ÿæ¢¯åº¦ä¸‹é™</p>
<p>C. å®ƒé€šè¿‡å‡å°‘è¿­ä»£æ¬¡æ•°æ¥è·å¾—ä¸€ä¸ªå¥½çš„è§£ï¼Œä»è€ŒåŠ å¿«äº†æ¢¯åº¦ä¸‹é™çš„é€Ÿåº¦</p>
<p>D. å®ƒé˜²æ­¢çŸ©é˜µ <span class="arithmatex">\(X^TX\)</span>ï¼ˆç”¨äºæ­£è§„æ–¹ç¨‹ï¼‰ä¸å¯é€†ï¼ˆå¥‡å¼‚/é€€åŒ–ï¼‰</p>
<p><br/>
<br/>
<br/>
<br/>
<br/>
<br/></p>
<h3 id="_7">å‚è€ƒç­”æ¡ˆ</h3>
<p>ç¬¬ä¸€é¢˜ï¼š-0.47</p>
<p><br/>
ç¬¬äºŒé¢˜ï¼šC</p>
<p><br/></p>
<p>ç¬¬ä¸‰é¢˜ï¼šB</p>
<p><br/></p>
<p>ç¬¬å››é¢˜ï¼šA</p>
<p><br/></p>
<p>ç¬¬äº”é¢˜ï¼šC</p>
<h2 id="_8">ä¸Šæœºç»ƒä¹ </h2>
<p>In this part, you will implement linear regression with multiple variables to predict the prices of houses. Suppose you are selling your house and you want to know what a good market price would be. One way to do this is to first collect information on recent houses sold and make a model of housing prices.</p>
<p>&ensp; The file ex1data2.txt contains a training set of housing prices in Portland, Oregon. The first column is the size of the house (in square feet), the second column is the number of bedrooms, and the third column is the price of the house.</p>
<h3 id="1feature-normalization">1ã€Feature Normalization</h3>
<table class="highlighttable"><tr><th colspan="2" class="filename"><div class="highlight"><span class="filename">åšä¹‹å‰çœ‹ä¸€ä¸‹æ•°æ®çš„å¤§æ¦‚æ ·å­</span></div></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-3-1">1</a></span>
<span class="normal"><a href="#__codelineno-3-2">2</a></span>
<span class="normal"><a href="#__codelineno-3-3">3</a></span>
<span class="normal"><a href="#__codelineno-3-4">4</a></span>
<span class="normal"><a href="#__codelineno-3-5">5</a></span>
<span class="normal"><a href="#__codelineno-3-6">6</a></span>
<span class="normal"><a href="#__codelineno-3-7">7</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<a id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="c1"># path : æ•°æ®å­˜æ”¾çš„è·¯å¾„</span>
<a id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="n">path</span> <span class="o">=</span> <span class="s2">&quot;ex1data2.txt&quot;</span>
<a id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="c1"># names : æŒ‡å®šåˆ—å; head=None : åŸæ•°æ®æ²¡æœ‰åˆ—å</span>
<a id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;Size&quot;</span><span class="p">,</span> <span class="s2">&quot;Bedrooms&quot;</span><span class="p">,</span><span class="s2">&quot;Price&quot;</span><span class="p">])</span>
<a id="__codelineno-3-6" name="__codelineno-3-6"></a><span class="c1"># å±•ç¤ºæ•°æ®çš„åäº”è¡Œ</span>
<a id="__codelineno-3-7" name="__codelineno-3-7"></a><span class="n">data</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
<p>By looking at the values, note that house sizes are about 1000 times the number of bedrooms. When feature differ by orders of magnitude, first performing feature scaling can make gradient descent converge much more quickly.</p>
<ul>
<li>Substract the value of each feature from the dataset.</li>
<li>After substracting the mean, additionally scale (divide) the feature values by their repective "standar deviations".</li>
</ul>
<p>&ensp; The standard deviation is a way of measuring how much variation there is in the range of values of a particular feature (most data points will lie within <span class="arithmatex">\(\pm 2\)</span> standard deviation of the mean); this is an alternative to taking the range of values(max-min). </p>
<p>&ensp; You will do this for all the features and your code should work with datasets of all sizes (any number of features / examples). Note that each column of the matrix X corresponds to one feature.</p>
<table class="highlighttable"><tr><th colspan="2" class="filename"><div class="highlight"><span class="filename">å¯¹æ•°æ®æ ‡å‡†åŒ–å¹¶æ’å…¥x0</span></div></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-4-1">1</a></span>
<span class="normal"><a href="#__codelineno-4-2">2</a></span>
<span class="normal"><a href="#__codelineno-4-3">3</a></span>
<span class="normal"><a href="#__codelineno-4-4">4</a></span>
<span class="normal"><a href="#__codelineno-4-5">5</a></span>
<span class="normal"><a href="#__codelineno-4-6">6</a></span>
<span class="normal"><a href="#__codelineno-4-7">7</a></span>
<span class="normal"><a href="#__codelineno-4-8">8</a></span>
<span class="normal"><a href="#__codelineno-4-9">9</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="c1"># å¯¹æ•°æ®è¿›è¡Œç‰¹å¾-æ ‡å‡†åŒ–</span>
<a id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="c1"># æ³¨æ„pandasæŒ‰åˆ—åå–åˆ—æ˜¯ä¸¤ä¸ªä¸­æ‹¬å·</span>
<a id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="n">data2</span><span class="p">[[</span><span class="s2">&quot;Size&quot;</span><span class="p">,</span><span class="s2">&quot;Bedrooms&quot;</span><span class="p">]]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data2</span><span class="p">[[</span><span class="s2">&quot;Size&quot;</span><span class="p">,</span><span class="s2">&quot;Bedrooms&quot;</span><span class="p">]]</span><span class="o">-</span><span class="n">data2</span><span class="p">[[</span><span class="s2">&quot;Size&quot;</span><span class="p">,</span><span class="s2">&quot;Bedrooms&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span><span class="o">/</span><span class="n">data2</span><span class="p">[[</span><span class="s2">&quot;Size&quot;</span><span class="p">,</span><span class="s2">&quot;Bedrooms&quot;</span><span class="p">]]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
<a id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="c1"># æ„Ÿè§‰æŠŠæˆ¿ä»·ç¨å¾®ç¼©æ”¾ä¸€ä¸‹ï¼Œä¸ç„¶å¯¹æ¢¯åº¦å½±å“å¤ªå¤§</span>
<a id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="n">data2</span><span class="p">[[</span><span class="s2">&quot;Price&quot;</span><span class="p">]]</span><span class="o">=</span><span class="n">data2</span><span class="p">[[</span><span class="s2">&quot;Price&quot;</span><span class="p">]]</span><span class="o">/</span><span class="mi">100000</span>
<a id="__codelineno-4-6" name="__codelineno-4-6"></a>
<a id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="c1"># æ’å…¥x0</span>
<a id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="n">data2</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Ones&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="n">data2</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</code></pre></div>
</td></tr></table>
<h3 id="2gradient-descent">2ã€Gradient Descent</h3>
<p>Previously, you implemented gradient descent on a univariate regression problem. The only difference now is that there is one more feature in matrix X. The hypothesis function and the batch gradient descent update rule remain unchanged.</p>
<div class="admonition note">
<p class="admonition-title">Implement Note:</p>
<p>In the multivariate case, the cost function can also be written in the following vectorized form: <span class="arithmatex">\(J(\theta)=\frac{1}{2m}(X\theta-y)^T(X\theta-y)\)</span> 
where <span class="arithmatex">\(X=\bigl( \begin{bmatrix} --- &amp; (x^{(1)})^T &amp; --- \\\\ --- &amp; (x^{(2)})^T &amp; ---\\\\ &amp; \vdots &amp; \\\\
--- &amp; (x^{(m)})^T &amp; --- \end{bmatrix} \bigr)\)</span> <span class="arithmatex">\(y= \begin{bmatrix} y^{(1)} \\\\  y^{(2)} \\\\  \vdots \\\\ y^{(m)} \end{bmatrix}\)</span>.</p>
<p>The vectorized version is efficient when you are working with numerical cumputing tools like numpy. If you are an expert with matrix operations, you can prove to yourself that the two forms are equivalent.</p>
</div>
<table class="highlighttable"><tr><th colspan="2" class="filename"><div class="highlight"><span class="filename">è¿è¡Œå¤šå˜é‡æ¢¯åº¦ä¸‹é™</span></div></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-5-1"> 1</a></span>
<span class="normal"><a href="#__codelineno-5-2"> 2</a></span>
<span class="normal"><a href="#__codelineno-5-3"> 3</a></span>
<span class="normal"><a href="#__codelineno-5-4"> 4</a></span>
<span class="normal"><a href="#__codelineno-5-5"> 5</a></span>
<span class="normal"><a href="#__codelineno-5-6"> 6</a></span>
<span class="normal"><a href="#__codelineno-5-7"> 7</a></span>
<span class="normal"><a href="#__codelineno-5-8"> 8</a></span>
<span class="normal"><a href="#__codelineno-5-9"> 9</a></span>
<span class="normal"><a href="#__codelineno-5-10">10</a></span>
<span class="normal"><a href="#__codelineno-5-11">11</a></span>
<span class="normal"><a href="#__codelineno-5-12">12</a></span>
<span class="normal"><a href="#__codelineno-5-13">13</a></span>
<span class="normal"><a href="#__codelineno-5-14">14</a></span>
<span class="normal"><a href="#__codelineno-5-15">15</a></span>
<span class="normal"><a href="#__codelineno-5-16">16</a></span>
<span class="normal"><a href="#__codelineno-5-17">17</a></span>
<span class="normal"><a href="#__codelineno-5-18">18</a></span>
<span class="normal"><a href="#__codelineno-5-19">19</a></span>
<span class="normal"><a href="#__codelineno-5-20">20</a></span>
<span class="normal"><a href="#__codelineno-5-21">21</a></span>
<span class="normal"><a href="#__codelineno-5-22">22</a></span>
<span class="normal"><a href="#__codelineno-5-23">23</a></span>
<span class="normal"><a href="#__codelineno-5-24">24</a></span>
<span class="normal"><a href="#__codelineno-5-25">25</a></span>
<span class="normal"><a href="#__codelineno-5-26">26</a></span>
<span class="normal"><a href="#__codelineno-5-27">27</a></span>
<span class="normal"><a href="#__codelineno-5-28">28</a></span>
<span class="normal"><a href="#__codelineno-5-29">29</a></span>
<span class="normal"><a href="#__codelineno-5-30">30</a></span>
<span class="normal"><a href="#__codelineno-5-31">31</a></span>
<span class="normal"><a href="#__codelineno-5-32">32</a></span>
<span class="normal"><a href="#__codelineno-5-33">33</a></span>
<span class="normal"><a href="#__codelineno-5-34">34</a></span>
<span class="normal"><a href="#__codelineno-5-35">35</a></span>
<span class="normal"><a href="#__codelineno-5-36">36</a></span>
<span class="normal"><a href="#__codelineno-5-37">37</a></span>
<span class="normal"><a href="#__codelineno-5-38">38</a></span>
<span class="normal"><a href="#__codelineno-5-39">39</a></span>
<span class="normal"><a href="#__codelineno-5-40">40</a></span>
<span class="normal"><a href="#__codelineno-5-41">41</a></span>
<span class="normal"><a href="#__codelineno-5-42">42</a></span>
<span class="normal"><a href="#__codelineno-5-43">43</a></span>
<span class="normal"><a href="#__codelineno-5-44">44</a></span>
<span class="normal"><a href="#__codelineno-5-45">45</a></span>
<span class="normal"><a href="#__codelineno-5-46">46</a></span>
<span class="normal"><a href="#__codelineno-5-47">47</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="c1"># è·å–æ•°æ®çš„æ€»åˆ—æ•°</span>
<a id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="n">cols</span> <span class="o">=</span> <span class="n">data2</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<a id="__codelineno-5-4" name="__codelineno-5-4"></a>
<a id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="c1"># å°†æ•°æ®æ‹†åˆ†å¹¶è½¬ä¸ºndarryåˆ†åˆ«æ”¾åˆ°X,yä¸­</span>
<a id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="n">cols</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">cols</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<a id="__codelineno-5-8" name="__codelineno-5-8"></a>
<a id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="c1"># ä¸­é—´çœ‹ä¸€ä¸‹Xï¼Œyä»¥åŠXï¼Œyçš„ç»´åº¦æ˜¯å¦æ­£ç¡®</span>
<a id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="c1"># X.shape,y.shape</span>
<a id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="c1"># X, y</span>
<a id="__codelineno-5-12" name="__codelineno-5-12"></a>
<a id="__codelineno-5-13" name="__codelineno-5-13"></a><span class="c1"># åˆå§‹åŒ–theta, å­¦ä¹ ç‡alphaï¼Œè¿­ä»£æ¬¡æ•°iters</span>
<a id="__codelineno-5-14" name="__codelineno-5-14"></a><span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">([</span><span class="mi">3</span><span class="p">,])</span>
<a id="__codelineno-5-15" name="__codelineno-5-15"></a><span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.01</span>
<a id="__codelineno-5-16" name="__codelineno-5-16"></a><span class="n">iters</span> <span class="o">=</span> <span class="mi">1000</span>
<a id="__codelineno-5-17" name="__codelineno-5-17"></a>
<a id="__codelineno-5-18" name="__codelineno-5-18"></a><span class="c1"># X.shape,y.shape,theta.shape</span>
<a id="__codelineno-5-19" name="__codelineno-5-19"></a>
<a id="__codelineno-5-20" name="__codelineno-5-20"></a><span class="c1"># å®šä¹‰ä»£ä»·å‡½æ•°å¹¶è®¡ç®—</span>
<a id="__codelineno-5-21" name="__codelineno-5-21"></a><span class="k">def</span> <span class="nf">computeCost</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
<a id="__codelineno-5-22" name="__codelineno-5-22"></a>    <span class="n">m</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<a id="__codelineno-5-23" name="__codelineno-5-23"></a>    <span class="c1"># print((np.dot(X,theta)-y).shape)</span>
<a id="__codelineno-5-24" name="__codelineno-5-24"></a>    <span class="n">inner</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="p">))</span>
<a id="__codelineno-5-25" name="__codelineno-5-25"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">inner</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">m</span><span class="p">)</span>
<a id="__codelineno-5-26" name="__codelineno-5-26"></a>
<a id="__codelineno-5-27" name="__codelineno-5-27"></a><span class="c1"># å®šä¹‰æ¢¯åº¦ä¸‹é™ç®—æ³•</span>
<a id="__codelineno-5-28" name="__codelineno-5-28"></a><span class="k">def</span> <span class="nf">gradientDescent</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">iterations</span><span class="p">):</span>
<a id="__codelineno-5-29" name="__codelineno-5-29"></a>    <span class="n">m</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># m: æ ·æœ¬çš„æ€»ä¸ªæ•°</span>
<a id="__codelineno-5-30" name="__codelineno-5-30"></a>    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>  <span class="c1"># n: thetaçš„æ€»ä¸ªæ•°</span>
<a id="__codelineno-5-31" name="__codelineno-5-31"></a>    <span class="c1"># ç”¨ä¸€ä¸ªå‘é‡æ¥è®°å½•è¿­ä»£è¿‡ç¨‹ä¸­æ‰€æœ‰çš„costå€¼</span>
<a id="__codelineno-5-32" name="__codelineno-5-32"></a>    <span class="n">costs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">iterations</span><span class="p">)</span>
<a id="__codelineno-5-33" name="__codelineno-5-33"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations</span><span class="p">):</span>
<a id="__codelineno-5-34" name="__codelineno-5-34"></a>        <span class="n">costs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">computeCost</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
<a id="__codelineno-5-35" name="__codelineno-5-35"></a>        <span class="c1"># thetaæ˜¯å‡ ä¸ªå°±è¦æ›´æ–°å‡ ä¸ª</span>
<a id="__codelineno-5-36" name="__codelineno-5-36"></a>        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<a id="__codelineno-5-37" name="__codelineno-5-37"></a>            <span class="n">theta</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">alpha</span> <span class="o">*</span> \
<a id="__codelineno-5-38" name="__codelineno-5-38"></a>                <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">m</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span><span class="o">-</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">X</span><span class="p">[:,</span> <span class="n">j</span><span class="p">])</span>
<a id="__codelineno-5-39" name="__codelineno-5-39"></a>
<a id="__codelineno-5-40" name="__codelineno-5-40"></a>    <span class="k">return</span> <span class="n">theta</span><span class="p">,</span> <span class="n">costs</span>
<a id="__codelineno-5-41" name="__codelineno-5-41"></a>
<a id="__codelineno-5-42" name="__codelineno-5-42"></a>
<a id="__codelineno-5-43" name="__codelineno-5-43"></a><span class="c1"># è¿è¡Œæ¢¯åº¦ä¸‹é™ï¼Œåˆ†åˆ«æ¥æ”¶æ›´æ–°åçš„thetaå€¼å’Œæ¯ä¸€æ­¥è¿­ä»£çš„costå€¼</span>
<a id="__codelineno-5-44" name="__codelineno-5-44"></a><span class="n">theta_hat</span><span class="p">,</span> <span class="n">costs</span> <span class="o">=</span> <span class="n">gradientDescent</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">iters</span><span class="p">)</span>
<a id="__codelineno-5-45" name="__codelineno-5-45"></a>
<a id="__codelineno-5-46" name="__codelineno-5-46"></a><span class="c1"># get the cost (error) of the model</span>
<a id="__codelineno-5-47" name="__codelineno-5-47"></a><span class="n">costs</span><span class="p">[</span><span class="n">iters</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">theta_hat</span>
</code></pre></div>
</td></tr></table>
<p>è¾“å‡º
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="p">(</span><span class="mf">0.20435384903675252</span><span class="p">,</span> <span class="n">array</span><span class="p">([</span> <span class="mf">3.40397964</span><span class="p">,</span>  <span class="mf">1.09859063</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05879178</span><span class="p">]))</span>
</code></pre></div></p>
<h4 id="21-selecting-learning-rates">2.1 Selecting learning rates</h4>
<p>In this part of the exercise, you will get to try out different learning rates for the dataset and find a learning rate that converages quickly.</p>
<p>&ensp; We recommend trying values of the <strong>learning rate</strong> <span class="arithmatex">\(\alpha\)</span> on a log-scale, at multiplicative steps of about 3 times the previous value (i.e., <strong>0.3, 0.1, 0.03, 0.01</strong> and so on). You may also want to adjust the number of iterations you are running if that will help you see the overall trend in the curve.</p>
<p>&ensp; Notice the changes in the convergence curves as the learning rate changes. With a small learning rate, you should find that gradient descent takes a very long time to converge to the optimal value. Conversely, with a large learning rate, gradient descent might not converge or might even diverge!</p>
<p><img alt="Fig3_Convergence_of_gradient_descent with an appropriate learning rate" src="../../assets/images/Fig3_Convergence_of_gradient_descent.png" /></p>
<h3 id="3noramal-equation">3ã€Noramal Equation</h3>
<p>In the lecture videos, you learned that the closed-form solution to linear regression is</p>
<div class="arithmatex">\[
\theta = (X^TX)^{-1}X^Ty
\]</div>
<p>&ensp; Using this formula does not require any feature scaling, and you will get an exact solution in one calculation: there is no â€œloop until convergenceâ€ like in gradient descent.</p>
<p><strong>å†æ¬¡æé†’ï¼š</strong>
<strong>æ¢¯åº¦ä¸‹é™</strong>ï¼šéœ€è¦é€‰æ‹©å­¦ä¹ ç‡ <span class="arithmatex">\(\alpha\)</span>ï¼Œéœ€è¦å¤šæ¬¡è¿­ä»£ï¼Œå½“ç‰¹å¾æ•°é‡nå¤§æ—¶ä¹Ÿèƒ½è¾ƒå¥½é€‚ç”¨ï¼Œé€‚ç”¨äºå„ç§ç±»å‹çš„æ¨¡å‹</p>
<p><strong>æ­£è§„æ–¹ç¨‹</strong>ï¼šä¸éœ€è¦é€‰æ‹©å­¦ä¹ ç‡ <span class="arithmatex">\(\alpha\)</span>ï¼Œä¸€æ¬¡è®¡ç®—å¾—å‡ºï¼Œéœ€è¦è®¡ç®— <span class="arithmatex">\(X^TX\)</span>ï¼Œå¦‚æœç‰¹å¾æ•°é‡nè¾ƒå¤§åˆ™è¿ç®—ä»£ä»·å¤§ï¼Œå› ä¸ºçŸ©é˜µé€†çš„è®¡ç®—æ—¶é—´å¤æ‚åº¦ä¸ºğ‘‚(ğ‘›3)ï¼Œ<strong>é€šå¸¸æ¥è¯´å½“ğ‘›å°äº10000 æ—¶</strong>è¿˜æ˜¯å¯ä»¥æ¥å—çš„ï¼Œåªé€‚ç”¨äº<strong>çº¿æ€§æ¨¡å‹</strong>ï¼Œä¸é€‚åˆé€»è¾‘å›å½’æ¨¡å‹ç­‰å…¶ä»–æ¨¡å‹ã€‚</p>
<table class="highlighttable"><tr><th colspan="2" class="filename"><div class="highlight"><span class="filename">æ­£è§„æ–¹ç¨‹è®¡ç®—theta</span></div></th></tr><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"><a href="#__codelineno-7-1">1</a></span>
<span class="normal"><a href="#__codelineno-7-2">2</a></span>
<span class="normal"><a href="#__codelineno-7-3">3</a></span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="c1"># åˆ©ç”¨å…¬å¼ä¸€æ­¥è®¡ç®—å‡ºå‚æ•°theta</span>
<a id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="n">theta_ne</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="nd">@X</span><span class="p">)</span><span class="nd">@X</span><span class="o">.</span><span class="n">T</span><span class="nd">@y</span> <span class="c1">#X.T@Xç­‰ä»·äºX.T.dot(X)</span>
<a id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="n">theta_ne</span>
</code></pre></div>
</td></tr></table>
<p><strong>è¾“å‡º</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="n">array</span><span class="p">([</span> <span class="mf">3.4041266</span> <span class="p">,</span>  <span class="mf">1.1063105</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.06649474</span><span class="p">])</span>
</code></pre></div>
<p>æˆ‘ä»¬ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•è®¡ç®—çš„thetaä¸ºï¼š
[ 3.40397964,  1.09859063, -0.05879178]</p>
<p>ä¸¤è€…ç›¸å·®ä¸æ˜¯ç‰¹åˆ«å¤§ï¼Œè¯´æ˜æˆ‘ä»¬æ¢¯åº¦ä¸‹é™æ¨¡å‹è¿˜æ˜¯æ¯”è¾ƒå‡†ç¡®çš„ï¼Œå“ˆå“ˆå“ˆã€‚è‡³æ­¤ï¼Œæˆ‘å·²ç»æŒæ¡äº†ä¸¤ä¸ªç®—æ³•ï¼Œæ¢¯åº¦ä¸‹é™æ¨¡å‹å’Œæ­£è§„æ–¹ç¨‹æ±‚è§£çº¿æ€§å›å½’æ¨¡å‹ã€‚æˆ‘çœŸæ£’ï¼Œæ˜å¤©å¼€å§‹å­¦ä¹ æ–°çš„é€»è¾‘å›å½’æ¨¡å‹ï¼ŒåŠ æ²¹ï¼ï¼ï¼</p>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            å›åˆ°é¡µé¢é¡¶éƒ¨
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="é¡µè„š">
      
        
        <a href="../1.%20linear%20regression-1%20v/" class="md-footer__link md-footer__link--prev" aria-label="ä¸Šä¸€é¡µ: ä¸€. å•å˜é‡çº¿æ€§å›å½’" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                ä¸Šä¸€é¡µ
              </span>
              ä¸€. å•å˜é‡çº¿æ€§å›å½’
            </div>
          </div>
        </a>
      
      
        
        <a href="../../math%20in%20ML/" class="md-footer__link md-footer__link--next" aria-label="ä¸‹ä¸€é¡µ: å‰è¨€å’Œç›®å½•" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                ä¸‹ä¸€é¡µ
              </span>
              å‰è¨€å’Œç›®å½•
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.top"], "search": "../../assets/javascripts/workers/search.5e67fbfe.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c44cc438.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>