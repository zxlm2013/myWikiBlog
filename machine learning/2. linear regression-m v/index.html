
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.0, mkdocs-material-8.2.8">
    
    
      
        <title>äºŒ. å¤šå˜é‡çº¿æ€§å›å½’ - å¤§ç™½çš„çŸ¥è¯†åº“</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.644de097.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1" class="md-skip">
          è·³è½¬è‡³
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="é¡µçœ‰">
    <a href="../.." title="å¤§ç™½çš„çŸ¥è¯†åº“" class="md-header__button md-logo" aria-label="å¤§ç™½çš„çŸ¥è¯†åº“" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            å¤§ç™½çš„çŸ¥è¯†åº“
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              äºŒ. å¤šå˜é‡çº¿æ€§å›å½’
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="æœç´¢" placeholder="æœç´¢" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="æŸ¥æ‰¾">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="æ¸…ç©ºå½“å‰å†…å®¹" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            æ­£åœ¨åˆå§‹åŒ–æœç´¢å¼•æ“
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="æ ‡ç­¾" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      é¦–é¡µ
    </a>
  </li>

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        æœºå™¨å­¦ä¹ 
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../math%20in%20ML/" class="md-tabs__link">
        æœºå™¨å­¦ä¹ ä¸­çš„æ•°å­¦çŸ¥è¯†
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="å¯¼èˆªæ " data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="å¤§ç™½çš„çŸ¥è¯†åº“" class="md-nav__button md-logo" aria-label="å¤§ç™½çš„çŸ¥è¯†åº“" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    å¤§ç™½çš„çŸ¥è¯†åº“
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        é¦–é¡µ
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          æœºå™¨å­¦ä¹ 
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="æœºå™¨å­¦ä¹ " data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          æœºå™¨å­¦ä¹ 
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        å‰è¨€å’Œç›®å½•
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../1.%20linear%20regression-1%20v/" class="md-nav__link">
        ä¸€. å•å˜é‡çº¿æ€§å›å½’
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          äºŒ. å¤šå˜é‡çº¿æ€§å›å½’
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        äºŒ. å¤šå˜é‡çº¿æ€§å›å½’
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="ç›®å½•">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ç›®å½•
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1. å¤šç»´ç‰¹å¾
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. å¤šå˜é‡æ¢¯åº¦ä¸‹é™
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-" class="md-nav__link">
    3. æ¢¯åº¦ä¸‹é™æ³• - ç‰¹å¾ç¼©æ”¾
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-" class="md-nav__link">
    4. æ¢¯åº¦ä¸‹é™æ³• - å­¦ä¹ ç‡
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5. ç‰¹å¾å’Œå¤šé¡¹å¼å›å½’
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    6. æ­£è§„æ–¹ç¨‹
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-the-normal-equations" class="md-nav__link">
    7. The normal equations
  </a>
  
    <nav class="md-nav" aria-label="7. The normal equations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-matrix-derivatives" class="md-nav__link">
    7.1 Matrix derivatives
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          æœºå™¨å­¦ä¹ ä¸­çš„æ•°å­¦çŸ¥è¯†
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="æœºå™¨å­¦ä¹ ä¸­çš„æ•°å­¦çŸ¥è¯†" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          æœºå™¨å­¦ä¹ ä¸­çš„æ•°å­¦çŸ¥è¯†
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../math%20in%20ML/" class="md-nav__link">
        å‰è¨€å’Œç›®å½•
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../math%20in%20ML/1.%20M%20derivation%20essence/" class="md-nav__link">
        ä¸€. çŸ©é˜µæ±‚å¯¼æœ¬è´¨
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../math%20in%20ML/2.%20M%20derivation/" class="md-nav__link">
        äºŒ. çŸ©é˜µæ±‚å¯¼
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="ç›®å½•">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ç›®å½•
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    1. å¤šç»´ç‰¹å¾
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    2. å¤šå˜é‡æ¢¯åº¦ä¸‹é™
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-" class="md-nav__link">
    3. æ¢¯åº¦ä¸‹é™æ³• - ç‰¹å¾ç¼©æ”¾
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-" class="md-nav__link">
    4. æ¢¯åº¦ä¸‹é™æ³• - å­¦ä¹ ç‡
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5" class="md-nav__link">
    5. ç‰¹å¾å’Œå¤šé¡¹å¼å›å½’
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6" class="md-nav__link">
    6. æ­£è§„æ–¹ç¨‹
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-the-normal-equations" class="md-nav__link">
    7. The normal equations
  </a>
  
    <nav class="md-nav" aria-label="7. The normal equations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-matrix-derivatives" class="md-nav__link">
    7.1 Matrix derivatives
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


  <h1>äºŒ. å¤šå˜é‡çº¿æ€§å›å½’</h1>

<h2 id="1">1. å¤šç»´ç‰¹å¾</h2>
<div class="admonition info">
<p>å‚è€ƒè§†é¢‘:
4 - 1 - Multiple Features (8 min).mkv</p>
</div>
<p>ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬æ¢è®¨äº†å•å˜é‡/ç‰¹å¾çš„å›å½’æ¨¡å‹ï¼Œç°åœ¨æˆ‘ä»¬å¯¹æˆ¿ä»·æ¨¡å‹å¢åŠ æ›´å¤šçš„ç‰¹å¾ï¼Œä¾‹å¦‚æˆ¿é—´æ•°æ¥¼å±‚ç­‰ï¼Œæ„æˆä¸€ä¸ªå«æœ‰å¤šä¸ªå˜é‡çš„æ¨¡å‹ï¼Œæ¨¡å‹ä¸­çš„ç‰¹å¾ä¸º<span class="arithmatex">\(\left( {x_{1}},{x_{2}},...,{x_{n}} \right)\)</span>ã€‚</p>
<table>
<thead>
<tr>
<th align="center">Size (feet2)</th>
<th align="center">Number   of bedrooms</th>
<th align="center">Number   of floors</th>
<th align="center">Age of home (years)</th>
<th align="center">Price   ($1000)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center">2104</td>
<td align="center">5</td>
<td align="center">1</td>
<td align="center">45</td>
<td align="center">460</td>
</tr>
<tr>
<td align="center">1416</td>
<td align="center">3</td>
<td align="center">2</td>
<td align="center">40</td>
<td align="center">232</td>
</tr>
<tr>
<td align="center">1534</td>
<td align="center">3</td>
<td align="center">2</td>
<td align="center">30</td>
<td align="center">315</td>
</tr>
<tr>
<td align="center">852</td>
<td align="center">2</td>
<td align="center">1</td>
<td align="center">36</td>
<td align="center">178</td>
</tr>
<tr>
<td align="center">â€¦</td>
<td align="center">â€¦</td>
<td align="center">â€¦</td>
<td align="center">â€¦</td>
<td align="center">â€¦</td>
</tr>
</tbody>
</table>
<p>å¢æ·»æ›´å¤šç‰¹å¾åï¼Œæˆ‘ä»¬å¼•å…¥ä¸€ç³»åˆ—æ–°çš„æ³¨é‡Šï¼š</p>
<p><span class="arithmatex">\(n\)</span> ä»£è¡¨ç‰¹å¾çš„æ•°é‡</p>
<p><span class="arithmatex">\({x^{\left( i \right)}}\)</span> ä»£è¡¨ç¬¬ <span class="arithmatex">\(i\)</span> ä¸ªè®­ç»ƒå®ä¾‹ï¼Œæ˜¯ç‰¹å¾çŸ©é˜µä¸­çš„ç¬¬<span class="arithmatex">\(i\)</span>è¡Œï¼Œæ˜¯ä¸€ä¸ª<strong>å‘é‡</strong>ï¼ˆ<strong>vector</strong>ï¼‰ã€‚</p>
<p>æ¯”æ–¹è¯´ï¼Œä¸Šå›¾çš„</p>
<p><span class="arithmatex">\({x}^{(2)}\text{=}\begin{bmatrix} 1416\\\ 3\\\ 2\\\ 40 \end{bmatrix}\)</span>ï¼Œ</p>
<p><span class="arithmatex">\({x}_{j}^{\left( i \right)}\)</span>ä»£è¡¨ç‰¹å¾çŸ©é˜µä¸­ç¬¬ <span class="arithmatex">\(i\)</span> è¡Œçš„ç¬¬ <span class="arithmatex">\(j\)</span> ä¸ªç‰¹å¾ï¼Œä¹Ÿå°±æ˜¯ç¬¬ <span class="arithmatex">\(i\)</span> ä¸ªè®­ç»ƒå®ä¾‹çš„ç¬¬ <span class="arithmatex">\(j\)</span> ä¸ªç‰¹å¾ã€‚</p>
<p>å¦‚ä¸Šå›¾çš„<span class="arithmatex">\(x_{2}^{\left( 2 \right)}=3,x_{3}^{\left( 2 \right)}=2\)</span>ï¼Œ</p>
<p>æ”¯æŒå¤šå˜é‡çš„å‡è®¾ <span class="arithmatex">\(h\)</span> è¡¨ç¤ºä¸ºï¼š<span class="arithmatex">\(h_{\theta}\left( x \right)={\theta_{0}}+{\theta_{1}}{x_{1}}+{\theta_{2}}{x_{2}}+...+{\theta_{n}}{x_{n}}\)</span>ï¼Œ</p>
<p>è¿™ä¸ªå…¬å¼ä¸­æœ‰<span class="arithmatex">\(n+1\)</span>ä¸ªå‚æ•°å’Œ<span class="arithmatex">\(n\)</span>ä¸ªå˜é‡ï¼Œä¸ºäº†ä½¿å¾—å…¬å¼èƒ½å¤Ÿç®€åŒ–ä¸€äº›ï¼Œå¼•å…¥<span class="arithmatex">\(x_{0}=1\)</span>ï¼Œåˆ™å…¬å¼è½¬åŒ–ä¸ºï¼š<span class="arithmatex">\(h_{\theta} \left( x \right)={\theta_{0}}{x_{0}}+{\theta_{1}}{x_{1}}+{\theta_{2}}{x_{2}}+...+{\theta_{n}}{x_{n}}\)</span></p>
<p><img alt="2_1_1_theta_T_X" src="../../assets/images/2_1_1_theta_T_X.png" /></p>
<p>æ­¤æ—¶æ¨¡å‹ä¸­çš„å‚æ•°æ˜¯ä¸€ä¸ª<span class="arithmatex">\(n+1\)</span>ç»´çš„å‘é‡ï¼Œä»»ä½•ä¸€ä¸ªè®­ç»ƒå®ä¾‹ä¹Ÿéƒ½æ˜¯<span class="arithmatex">\(n+1\)</span>ç»´çš„å‘é‡ï¼Œç‰¹å¾çŸ©é˜µ<span class="arithmatex">\(X\)</span>çš„ç»´åº¦æ˜¯ <span class="arithmatex">\(m*(n+1)\)</span>ã€‚ å› æ­¤å…¬å¼å¯ä»¥ç®€åŒ–ä¸ºï¼š<span class="arithmatex">\(h_{\theta} \left( x \right)={\theta^{T}}X\)</span>ï¼Œå…¶ä¸­ä¸Šæ ‡  <span class="arithmatex">\(T\)</span> ä»£è¡¨çŸ©é˜µè½¬ç½®ã€‚</p>
<p>æ³¨æ„ï¼š
ä»ä¸Šå›¾å¯çŸ¥, <span class="arithmatex">\(\theta\)</span>, <span class="arithmatex">\(X\)</span> æˆ‘ä»¬æ˜¯ç”¨<strong>åˆ—å‘é‡</strong>æ¥æ ‡è®°ã€‚è®¡ç®— <span class="arithmatex">\(h_{\theta}\left( x \right)={\theta_{0}}+{\theta_{1}}{x_{1}}+{\theta_{2}}{x_{2}}+...+{\theta_{n}}{x_{n}}\)</span> çš„æ—¶å€™, å¯ä»¥å°† <span class="arithmatex">\(h\)</span> è¡¨ç¤ºä¸º <span class="arithmatex">\(\theta^TX.\)</span></p>
<h2 id="2">2. å¤šå˜é‡æ¢¯åº¦ä¸‹é™</h2>
<div class="admonition info">
<p>å‚è€ƒè§†é¢‘:
4 - 2 - Gradient Descent for Multiple Variables (5 min).mkv</p>
</div>
<p>å¿«é€Ÿå›é¡¾æˆ‘ä»¬çš„è®°å·ï¼Œå¹¶ç”¨å‘é‡ç®€åŒ–ã€‚</p>
<p>Hypothesis: <span class="arithmatex">\(h_\theta(x)=\theta_0+\theta_1x+\theta_2x+...+\theta_nx\)</span></p>
<p>ç®€è®°ä¸ºï¼š <span class="arithmatex">\(h_\theta(x)=\theta^TX\)</span></p>
<p>Parameters: <span class="arithmatex">\(\theta_0,\theta_1,\theta_2,...\theta_n\)</span></p>
<p>ç®€è®°ä¸ºï¼š<span class="arithmatex">\(\theta\)</span>, <span class="arithmatex">\(n+1\ dimension\ vector\)</span></p>
<p>Cost Function: </p>
<div class="arithmatex">\[
J(\theta_0,\theta_1,\ \theta_2,...\theta_n)=\frac {1} {2m}\sum\limits_{i=1}^{m}(h_\theta(x^{(i)})-y^{(i)})^2
\]</div>
<p>ç®€è®°ä¸ºï¼š</p>
<div class="arithmatex">\[
J(\theta)=\frac {1} {2m}\sum\limits_{i=1}^{m}(h_\theta(x^{(i)})-y^{(i)})^2
\]</div>
<p>Gradient descent:
<strong>Repeat {</strong></p>
<p>â€‹                <span class="arithmatex">\({\theta_{j}}:={\theta_{j}}-\alpha\frac{\partial}{\partial\theta_j}J(\theta_0,...\theta_n)\)</span></p>
<p>â€‹               <strong>}</strong> (simultaneously update for every j=0, 1, 2, ..., n)
ç®€è®°ä¸ºï¼šæŠŠä¸Šé¢çš„<span class="arithmatex">\(J(\theta_0,...\theta_n)\)</span>æ¢æˆ<span class="arithmatex">\(J(\theta)\)</span></p>
<p><img alt="2_2_1_gradient_descent_v2" src="../../assets/images/2_2_1_gradient_descent_v2.png" /></p>
<p>ä¸å•å˜é‡çº¿æ€§å›å½’ç±»ä¼¼ï¼Œåœ¨å¤šå˜é‡çº¿æ€§å›å½’ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿæ„å»ºä¸€ä¸ªä»£ä»·å‡½æ•°ï¼Œåˆ™è¿™ä¸ªä»£ä»·å‡½æ•°æ˜¯æ‰€æœ‰å»ºæ¨¡è¯¯å·®çš„å¹³æ–¹å’Œï¼Œå³ï¼š<span class="arithmatex">\(J\left( {\theta_{0}},{\theta_{1}}...{\theta_{n}} \right)=\frac{1}{2m}\sum\limits_{i=1}^{m}{{{\left( h_{\theta} \left({x}^{\left( i \right)} \right)-{y}^{\left( i \right)} \right)}^{2}}}\)</span> ï¼Œ</p>
<p>å…¶ä¸­ï¼š<span class="arithmatex">\(h_{\theta}\left( x \right)=\theta^{T}X={\theta_{0}}+{\theta_{1}}{x_{1}}+{\theta_{2}}{x_{2}}+...+{\theta_{n}}{x_{n}}\)</span> ï¼Œ</p>
<p>æˆ‘ä»¬çš„ç›®æ ‡å’Œå•å˜é‡çº¿æ€§å›å½’é—®é¢˜ä¸­ä¸€æ ·ï¼Œæ˜¯è¦æ‰¾å‡ºä½¿å¾—ä»£ä»·å‡½æ•°æœ€å°çš„ä¸€ç³»åˆ—å‚æ•°ã€‚
å¤šå˜é‡çº¿æ€§å›å½’çš„æ‰¹é‡æ¢¯åº¦ä¸‹é™ç®—æ³•ä¸ºï¼š</p>
<p>å½“<span class="arithmatex">\(n&gt;=1\)</span>æ—¶ï¼Œ
<span class="arithmatex">\({{\theta }_{0}}:={{\theta }_{0}}-a\frac{1}{m}\sum\limits_{i=1}^{m}{({{h}_{\theta }}({{x}^{(i)}})-{{y}^{(i)}})}x_{0}^{(i)}\)</span></p>
<p><span class="arithmatex">\({{\theta }_{1}}:={{\theta }_{1}}-a\frac{1}{m}\sum\limits_{i=1}^{m}{({{h}_{\theta }}({{x}^{(i)}})-{{y}^{(i)}})}x_{1}^{(i)}\)</span></p>
<p><span class="arithmatex">\({{\theta }_{2}}:={{\theta }_{2}}-a\frac{1}{m}\sum\limits_{i=1}^{m}{({{h}_{\theta }}({{x}^{(i)}})-{{y}^{(i)}})}x_{2}^{(i)}\)</span></p>
<p>...</p>
<p><span class="arithmatex">\({{\theta }_{n}}:={{\theta }_{n}}-a\frac{1}{m}\sum\limits_{i=1}^{m}{({{h}_{\theta }}({{x}^{(i)}})-{{y}^{(i)}})}x_{n}^{(i)}\)</span></p>
<p>æˆ‘ä»¬å¼€å§‹éšæœºé€‰æ‹©ä¸€ç³»åˆ—çš„å‚æ•°å€¼ï¼Œè®¡ç®—æ‰€æœ‰çš„é¢„æµ‹ç»“æœåï¼Œå†ç»™æ‰€æœ‰çš„å‚æ•°ä¸€ä¸ªæ–°çš„å€¼ï¼Œå¦‚æ­¤å¾ªç¯ç›´åˆ°æ”¶æ•›ã€‚</p>
<p>ä»£ç ç¤ºä¾‹ï¼š</p>
<p>è®¡ç®—ä»£ä»·å‡½æ•°
<span class="arithmatex">\(J\left( \theta  \right)=\frac{1}{2m}\sum\limits_{i=1}^{m}{{{\left( {h_{\theta}}\left( {x^{(i)}} \right)-{y^{(i)}} \right)}^{2}}}\)</span>
å…¶ä¸­ï¼š<span class="arithmatex">\({h_{\theta}}\left( x \right)={\theta^{T}}X={\theta_{0}}{x_{0}}+{\theta_{1}}{x_{1}}+{\theta_{2}}{x_{2}}+...+{\theta_{n}}{x_{n}}\)</span></p>
<p><strong>Python</strong> ä»£ç ï¼š</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="k">def</span> <span class="nf">computeCost</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">theta</span><span class="p">):</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>    <span class="n">inner</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(((</span><span class="n">X</span> <span class="o">*</span> <span class="n">theta</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">-</span> <span class="n">y</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">inner</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="p">))</span>
</code></pre></div>
<hr>

<p>ä¸‹é¢ï¼Œæˆ‘ä»¬å¼€å§‹æ¨å¯¼<span class="arithmatex">\(\frac{\partial}{\partial\theta}J(\theta)\)</span>ã€‚è¿™é‡Œä¸ºäº†æ™®éæ€§ï¼Œè¿˜åŸäº† <span class="arithmatex">\(\theta\)</span> çš„æ™®éæƒ…å†µï¼Œä¹Ÿå³æœ‰nä¸ª <span class="arithmatex">\(\theta\)</span> çš„æƒ…å†µã€‚</p>
<p>Hypothesis:         <span class="arithmatex">\(h_\theta(x)=\theta^Tx=\theta_0x_0+\theta_1x_1+\theta_2x_2+...+\theta_nx_n\)</span></p>
<p>Parameters:         <span class="arithmatex">\(\theta_0,\theta_1,...,\theta_n\)</span></p>
<p>Cost function: </p>
<div class="arithmatex">\[
J(\theta_0,\theta_1,...,\theta_n)=\frac {1} {2m}\sum\limits_{i=1}^{m}(h_\theta(x^{(i)})-y^{(i)})^2
\]</div>
<p>Gradient descent:
Repeat{
$$
\theta_j :=\theta_j-\alpha\frac{\partial}{\partial \theta_j}J(\theta_0,\theta_1,...,\theta_n)
$$
â€‹        }ï¼ˆsimultaneously update for every j=0, 1, 2, ..., n)ï¼‰</p>
<p>æ¨å¯¼ï¼š <span class="arithmatex">\(\frac{\partial}{\partial \theta_j}J(\theta_0,\theta_1,...,\theta_n)=?\)</span></p>
<p>Let's first work it for the case if we have only one training example <span class="arithmatex">\((x,y)\)</span>, so that we can neglect the sum in the definition <span class="arithmatex">\(J\)</span>. We have:
$$
\begin{split}
\frac{\partial}{\partial \theta_j}J(\theta_0,\theta_1,...,\theta_n) &amp; =  \frac {1} {2}\frac{\partial}{\partial \theta_j}\Big(h_\theta(x)-y\Big)^2 \\
 &amp; = 2\cdot\frac{1}{2}\cdot(h_\theta(x)-y)\cdot\frac{\partial}{\partial \theta_j}(h_\theta(x)-y) \\
 &amp; = (h_\theta(x)-y)\cdot\frac{\partial}{\partial \theta_j}(\theta_0x_0+\theta_1x_1+\theta_2x_2+...+\theta_nx_n) \\
 &amp; = (h_\theta(x)-y)\cdot x_j
\end{split}
$$</p>
<h2 id="3-">3. æ¢¯åº¦ä¸‹é™æ³• - ç‰¹å¾ç¼©æ”¾</h2>
<div class="admonition info">
<p>å‚è€ƒè§†é¢‘:
4 - 3 - Gradient Descent in Practice I - Feature Scaling (9 min).mkv</p>
</div>
<p>åœ¨æˆ‘ä»¬é¢å¯¹å¤šç»´ç‰¹å¾é—®é¢˜çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦ä¿è¯è¿™äº›ç‰¹å¾éƒ½å…·æœ‰ç›¸è¿‘çš„å°ºåº¦ï¼Œè¿™å°†å¸®åŠ©æ¢¯åº¦ä¸‹é™ç®—æ³•æ›´å¿«åœ°æ”¶æ•›ã€‚</p>
<p>ä»¥æˆ¿ä»·é—®é¢˜ä¸ºä¾‹ï¼Œå‡è®¾æˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ªç‰¹å¾ï¼Œæˆ¿å±‹çš„å°ºå¯¸å’Œæˆ¿é—´çš„æ•°é‡ï¼Œå°ºå¯¸çš„å€¼ä¸º 0-2000å¹³æ–¹è‹±å°ºï¼Œè€Œæˆ¿é—´æ•°é‡çš„å€¼åˆ™æ˜¯0-5ï¼Œä»¥ä¸¤ä¸ªå‚æ•°åˆ†åˆ«ä¸ºæ¨ªçºµåæ ‡ï¼Œç»˜åˆ¶ä»£ä»·å‡½æ•°çš„ç­‰é«˜çº¿å›¾èƒ½ï¼Œçœ‹å‡ºå›¾åƒä¼šæ˜¾å¾—å¾ˆæ‰ï¼Œæ¢¯åº¦ä¸‹é™ç®—æ³•éœ€è¦éå¸¸å¤šæ¬¡çš„è¿­ä»£æ‰èƒ½æ”¶æ•›ã€‚
è§£å†³çš„æ–¹æ³•æ˜¯å°è¯•å°†æ‰€æœ‰ç‰¹å¾çš„å°ºåº¦éƒ½å°½é‡ç¼©æ”¾åˆ°-1åˆ°1ä¹‹é—´ã€‚å¦‚å›¾ï¼š</p>
<p><img alt="2_3_1_feature_scaling" src="../../assets/images/2_3_1_feature_scaling.png" /></p>
<p>è§†é¢‘é‡Œå´æ©è¾¾è€å¸ˆçš„æ–¹æ³•æ˜¯ä»¤ï¼š<span class="arithmatex">\({{x}_{n}}=\frac{{{x}_{n}}-mean}{{max(x)-min(x)}}\)</span>, å…¶ä¸­ <span class="arithmatex">\(mean\)</span>æ˜¯å¹³å‡å€¼ï¼Œ<span class="arithmatex">\(max(x)-min(x)\)</span>åˆ†åˆ«æ˜¯æœ€å¤§å€¼å’Œæœ€å°å€¼ã€‚</p>
<p>æ›´é€šç”¨çš„æ˜¯ä»¤ï¼š<span class="arithmatex">\({{x}_{n}}=\frac{{{x}_{n}}-{mean}}{\sigma}\)</span>ï¼Œå…¶ä¸­ <span class="arithmatex">\(mean\)</span>æ˜¯å¹³å‡å€¼ï¼Œ<span class="arithmatex">\(\sigma\)</span>æ˜¯æ ‡å‡†å·®ã€‚</p>
<p>pythoné‡Œçš„apiï¼š</p>
<ul>
<li>
<p><strong>sklearn.preprocessing.StandardScaler()</strong></p>
<ul>
<li>å¤„ç†ä¹‹åæ¯åˆ—æ¥è¯´<strong>æ‰€æœ‰æ•°æ®éƒ½èšé›†åœ¨å‡å€¼0é™„è¿‘æ ‡å‡†å·®å·®ä¸º1</strong></li>
<li><strong>StandardScaler.fit_transform(X)</strong><ul>
<li>X:numpy arrayæ ¼å¼çš„æ•°æ®[n_samples,n_features]</li>
</ul>
</li>
<li>è¿”å›å€¼ï¼šè½¬æ¢åçš„å½¢çŠ¶ç›¸åŒçš„array</li>
</ul>
</li>
</ul>
<p>éƒ¨åˆ†å‚è€ƒä»£ç ï¼š
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_boston</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="k">def</span> <span class="nf">linear_model1</span><span class="p">():</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a>    <span class="c1"># 1.è·å–æ•°æ®</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a>    <span class="n">boston</span> <span class="o">=</span> <span class="n">load_boston</span><span class="p">()</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a>    <span class="c1"># 2. æ•°æ®é›†åˆ’åˆ†</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a>    <span class="n">x_train</span><span class="p">,</span> <span class="n">x_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a>        <span class="n">boston</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">boston</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a>
<a id="__codelineno-1-16" name="__codelineno-1-16" href="#__codelineno-1-16"></a>    <span class="c1"># 3. ç‰¹å¾å·¥ç¨‹-æ ‡å‡†åŒ–</span>
<a id="__codelineno-1-17" name="__codelineno-1-17" href="#__codelineno-1-17"></a>    <span class="n">transfer</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<a id="__codelineno-1-18" name="__codelineno-1-18" href="#__codelineno-1-18"></a>    <span class="n">x_train</span> <span class="o">=</span> <span class="n">transfer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
<a id="__codelineno-1-19" name="__codelineno-1-19" href="#__codelineno-1-19"></a>    <span class="n">x_test</span> <span class="o">=</span> <span class="n">transfer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">x_test</span><span class="p">)</span>
</code></pre></div></p>
<h2 id="4-">4. æ¢¯åº¦ä¸‹é™æ³• - å­¦ä¹ ç‡</h2>
<div class="admonition info">
<p>å‚è€ƒè§†é¢‘:
4 - 4 - Gradient Descent in Practice II - Learning Rate (9 min).mkv</p>
</div>
<p>æ¢¯åº¦ä¸‹é™ç®—æ³•æ”¶æ•›æ‰€éœ€è¦çš„è¿­ä»£æ¬¡æ•°æ ¹æ®æ¨¡å‹çš„ä¸åŒè€Œä¸åŒï¼Œæˆ‘ä»¬ä¸èƒ½æå‰é¢„çŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥ç»˜åˆ¶è¿­ä»£æ¬¡æ•°å’Œä»£ä»·å‡½æ•°çš„å›¾è¡¨æ¥è§‚æµ‹ç®—æ³•åœ¨ä½•æ—¶è¶‹äºæ”¶æ•›ã€‚</p>
<p><img alt="2_4_1_J_iterations" src="../../assets/images/2_4_1_J_iterations.png" /></p>
<p>ä¹Ÿæœ‰ä¸€äº›è‡ªåŠ¨æµ‹è¯•æ˜¯å¦æ”¶æ•›çš„æ–¹æ³•ï¼Œä¾‹å¦‚å°†ä»£ä»·å‡½æ•°çš„å˜åŒ–å€¼ä¸æŸä¸ªé˜€å€¼ï¼ˆä¾‹å¦‚0.001ï¼‰è¿›è¡Œæ¯”è¾ƒï¼Œä½†é€šå¸¸çœ‹å·¦ä¸Šæ–¹è¿™æ ·çš„å›¾è¡¨æ›´å¥½ã€‚</p>
<p>ä¸æ­£ç¡®çš„å­¦ä¹ ç‡ï¼Œä¼šäº§ç”Ÿå·¦ä¾§ä¸Šä¸‹ä¸¤ä¸ªå›¾åƒã€‚
<img alt="2_4_2_no_proper_alpha" src="../../assets/images/2_4_2_no_proper_alpha.png" /></p>
<p>æ¢¯åº¦ä¸‹é™ç®—æ³•çš„æ¯æ¬¡è¿­ä»£å—åˆ°å­¦ä¹ ç‡çš„å½±å“ï¼Œå¦‚æœå­¦ä¹ ç‡ <span class="arithmatex">\(\alpha\)</span> è¿‡å°ï¼Œåˆ™è¾¾åˆ°æ”¶æ•›æ‰€éœ€çš„è¿­ä»£æ¬¡æ•°ä¼šéå¸¸é«˜ï¼›å¦‚æœå­¦ä¹ ç‡ <span class="arithmatex">\(\alpha\)</span> è¿‡å¤§ï¼Œæ¯æ¬¡è¿­ä»£å¯èƒ½ä¸ä¼šå‡å°ä»£ä»·å‡½æ•°ï¼Œå¯èƒ½ä¼šè¶Šè¿‡å±€éƒ¨æœ€å°å€¼å¯¼è‡´æ— æ³•æ”¶æ•›ã€‚</p>
<p>é€šå¸¸å¯ä»¥è€ƒè™‘å°è¯•äº›å­¦ä¹ ç‡ï¼š</p>
<p><span class="arithmatex">\(\alpha= 0.001, 0.003, 0.01, 0.03, 0.1, 0.3, 1, 3, 10\)</span></p>
<h2 id="5">5. ç‰¹å¾å’Œå¤šé¡¹å¼å›å½’</h2>
<div class="admonition info">
<p>å‚è€ƒè§†é¢‘:
4 - 5 - Features and Polynomial Regression (8 min).mkv</p>
</div>
<p>å¦‚æˆ¿ä»·é¢„æµ‹é—®é¢˜ï¼Œ</p>
<p><img alt="2_5_1_house" src="../../assets/images/2_5_1_house.png" /></p>
<p><span class="arithmatex">\(h_{\theta}\left( x \right)={\theta_{0}}+{\theta_{1}}\times{frontage}+{\theta_{2}}\times{depth}\)</span> </p>
<p>å½“æˆ‘ä»¬çœŸæ­£åº”ç”¨çº¿æ€§å›å½’æ¨¡å‹çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›é€ è‡ªå·±çš„ç‰¹å¾å³ï¼š
<span class="arithmatex">\({x_{1}}=frontage\)</span>ï¼ˆä¸´è¡—å®½åº¦ï¼‰ï¼Œ<span class="arithmatex">\({x_{2}}=depth\)</span>ï¼ˆçºµå‘æ·±åº¦ï¼‰ï¼Œ<span class="arithmatex">\(x=frontage*depth=area\)</span>ï¼ˆé¢ç§¯ï¼‰ï¼Œ
åˆ™ï¼š<span class="arithmatex">\({h_{\theta}}\left( x \right)={\theta_{0}}+{\theta_{1}}x\)</span>ã€‚</p>
<p><img alt="2_5_2_polynomial_regression" src="../../assets/images/2_5_2_polynomial_regression.png" /></p>
<p>çº¿æ€§å›å½’å¹¶ä¸é€‚ç”¨äºæ‰€æœ‰æ•°æ®ï¼Œæœ‰æ—¶æˆ‘ä»¬éœ€è¦å…¶ä»–æ¨¡å‹æ¥é€‚åº”æˆ‘ä»¬çš„æ•°æ®ï¼Œæ¯”å¦‚ä¸€ä¸ªäºŒæ¬¡æ–¹æ¨¡å‹ï¼š<span class="arithmatex">\(h_{\theta}\left( x \right)={\theta_{0}}+{\theta_{1}}{x_{1}}+{\theta_{2}}{x_{2}^2}\)</span>
 æˆ–è€…ä¸‰æ¬¡æ–¹æ¨¡å‹ï¼š <span class="arithmatex">\(h_{\theta}\left( x \right)={\theta_{0}}+{\theta_{1}}{x_{1}}+{\theta_{2}}{x_{2}^2}+{\theta_{3}}{x_{3}^3}\)</span> </p>
<p>ä»ä¸Šé¢å›¾å³ä¾§ï¼Œå¯ä»¥çœ‹å‡ºå¦‚æœæˆ‘ä»¬é‡‡ç”¨å¤šé¡¹å¼å›å½’æ¨¡å‹ï¼Œåœ¨è¿è¡Œæ¢¯åº¦ä¸‹é™ç®—æ³•å‰ç‰¹å¾ç¼©æ”¾çš„é‡è¦æ€§äº†ã€‚</p>
<p>é€šå¸¸æˆ‘ä»¬éœ€è¦å…ˆè§‚å¯Ÿæ•°æ®ç„¶åå†å†³å®šå‡†å¤‡å°è¯•æ€æ ·çš„æ¨¡å‹ã€‚ å¦å¤–ï¼Œæˆ‘ä»¬å¯ä»¥ä»¤ï¼š</p>
<p><span class="arithmatex">\({{x}_{2}}=x_{2}^{2},{{x}_{3}}=x_{3}^{3}\)</span>ï¼Œä»è€Œå°†æ¨¡å‹è½¬åŒ–ä¸ºçº¿æ€§å›å½’æ¨¡å‹ã€‚</p>
<p>æ ¹æ®å‡½æ•°å›¾å½¢ç‰¹æ€§ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥ä½¿ï¼š</p>
<p><span class="arithmatex">\({{{h}}_{\theta}}(x)={{\theta }_{0}}\text{+}{{\theta }_{1}}(size)+{{\theta}_{2}}{{(size)}^{2}}\)</span></p>
<p>æˆ–è€…:</p>
<p><span class="arithmatex">\({{{h}}_{\theta}}(x)={{\theta }_{0}}\text{+}{{\theta }_{1}}(size)+{{\theta }_{2}}\sqrt{size}\)</span></p>
<p><img alt="2_5_3_choice_of_X" src="../../assets/images/2_5_3_choice_of_X.png" /></p>
<h2 id="6">6. æ­£è§„æ–¹ç¨‹</h2>
<div class="admonition info">
<p>å‚è€ƒè§†é¢‘:
4 - 6 - Normal Equation (16 min).mkv</p>
</div>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬éƒ½åœ¨ä½¿ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼Œä½†æ˜¯å¯¹äºæŸäº›çº¿æ€§å›å½’é—®é¢˜ï¼Œæ­£è§„æ–¹ç¨‹æ–¹æ³•æ˜¯æ›´å¥½çš„è§£å†³æ–¹æ¡ˆã€‚å¦‚ï¼š</p>
<p><img alt="2_6_1" src="../../assets/images/2_6_1.png" /></p>
<p>æ­£è§„æ–¹ç¨‹æ˜¯é€šè¿‡æ±‚è§£ä¸‹é¢çš„æ–¹ç¨‹æ¥æ‰¾å‡ºä½¿å¾—ä»£ä»·å‡½æ•°æœ€å°çš„å‚æ•°çš„ï¼š<span class="arithmatex">\(\frac{\partial}{\partial{\theta_{j}}}J\left( {\theta_{j}} \right)=0\)</span> ã€‚
 å‡è®¾æˆ‘ä»¬çš„è®­ç»ƒé›†ç‰¹å¾çŸ©é˜µä¸º <span class="arithmatex">\(X\)</span>ï¼ˆåŒ…å«äº† <span class="arithmatex">\({{x}_{0}}=1\)</span>ï¼‰å¹¶ä¸”æˆ‘ä»¬çš„è®­ç»ƒé›†ç»“æœä¸ºå‘é‡ <span class="arithmatex">\(y\)</span>ï¼Œåˆ™åˆ©ç”¨æ­£è§„æ–¹ç¨‹è§£å‡ºå‘é‡ <span class="arithmatex">\(\theta ={{\left( {X^T}X \right)}^{-1}}{X^{T}}y\)</span> ã€‚</p>
<p>ä»¥ä¸‹é¢è¡¨æ ¼æ•°æ®ä¸ºä¾‹ <span class="arithmatex">\(m=4\)</span>ï¼š</p>
<table>
<thead>
<tr>
<th><span class="arithmatex">\(x_0\)</span></th>
<th>Size (feet2)</th>
<th>Number   of bedrooms</th>
<th>Number   of floors</th>
<th>Age of home (years)</th>
<th>Price   ($1000)</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>2104</td>
<td>5</td>
<td>1</td>
<td>45</td>
<td>460</td>
</tr>
<tr>
<td>1</td>
<td>1416</td>
<td>3</td>
<td>2</td>
<td>40</td>
<td>232</td>
</tr>
<tr>
<td>1</td>
<td>1534</td>
<td>3</td>
<td>2</td>
<td>30</td>
<td>315</td>
</tr>
<tr>
<td>1</td>
<td>852</td>
<td>2</td>
<td>1</td>
<td>36</td>
<td>178</td>
</tr>
</tbody>
</table>
<p><span class="arithmatex">\(X\ \text{=}\begin{bmatrix}1 &amp; 2104 &amp; 5 &amp; 1 &amp; 45\\1 &amp; 1416 &amp; 3 &amp; 2 &amp; 40\\ 1 &amp;1534 &amp; 3 &amp; 2 &amp; 30\\ 1 &amp; 852 &amp; 2 &amp; 1 &amp; 36\end{bmatrix}\)</span>ï¼Œ<span class="arithmatex">\(y\ \text{=}\begin{bmatrix} 460\\232\\315\\178\end{bmatrix}\)</span></p>
<p><span class="arithmatex">\(Xç»´åº¦ï¼š(m,n+1),\ yçš„ç»´åº¦ï¼š(m,1)\)</span></p>
<p>è¿™æ—¶å€™æ±‚è§£ <span class="arithmatex">\(\theta\)</span> åªéœ€ä¸€æ­¥:  <span class="arithmatex">\(\theta ={{\left( {X^T}X \right)}^{-1}}{X^{T}}y\)</span>ã€‚</p>
<p>å°†ä¸Šé¢çš„ä¾‹å­æ¨å¹¿åˆ°ä¸€èˆ¬æƒ…å†µ</p>
<p><img alt="2_6_2" src="../../assets/images/2_6_2.png" /></p>
<p>æ³¨ï¼šå¯¹äºé‚£äº›ä¸å¯é€†çš„çŸ©é˜µï¼ˆé€šå¸¸æ˜¯å› ä¸ºç‰¹å¾ä¹‹é—´ä¸ç‹¬ç«‹ï¼Œå¦‚åŒæ—¶åŒ…å«è‹±å°ºä¸ºå•ä½çš„å°ºå¯¸å’Œç±³ä¸ºå•ä½çš„å°ºå¯¸ä¸¤ä¸ªç‰¹å¾ï¼Œä¹Ÿæœ‰å¯èƒ½æ˜¯ç‰¹å¾æ•°é‡å¤§äºè®­ç»ƒé›†çš„æ•°é‡ï¼‰ï¼Œæ­£è§„æ–¹ç¨‹æ–¹æ³•æ˜¯ä¸èƒ½ç”¨çš„ã€‚
åƒä¸‡è¦æ³¨æ„è¿™é‡Œçš„è®¾è®¡çŸ©é˜µXå®ƒçš„æ„æˆï¼Œè®¾è®¡å®Œæˆåï¼Œå‡è®¾å‡½æ•°å¯ä»¥å‘é‡åŒ–ä¸º <span class="arithmatex">\(h_\theta(x)=X\theta\)</span></p>
<p>æ¢¯åº¦ä¸‹é™ä¸æ­£è§„æ–¹ç¨‹çš„æ¯”è¾ƒï¼š</p>
<table>
<thead>
<tr>
<th>æ¢¯åº¦ä¸‹é™</th>
<th>æ­£è§„æ–¹ç¨‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>éœ€è¦é€‰æ‹©å­¦ä¹ ç‡<span class="arithmatex">\(\alpha\)</span></td>
<td>ä¸éœ€è¦</td>
</tr>
<tr>
<td>éœ€è¦å¤šæ¬¡è¿­ä»£</td>
<td>ä¸€æ¬¡è¿ç®—å¾—å‡º</td>
</tr>
<tr>
<td>å½“ç‰¹å¾æ•°é‡<span class="arithmatex">\(n\)</span>å¤§æ—¶ä¹Ÿèƒ½è¾ƒå¥½é€‚ç”¨</td>
<td>éœ€è¦è®¡ç®—<span class="arithmatex">\({{\left( {{X}^{T}}X \right)}^{-1}}\)</span> å¦‚æœç‰¹å¾æ•°é‡nè¾ƒå¤§åˆ™è¿ç®—ä»£ä»·å¤§ï¼Œå› ä¸ºçŸ©é˜µé€†çš„è®¡ç®—æ—¶é—´å¤æ‚åº¦ä¸º<span class="arithmatex">\(O\left( {{n}^{3}} \right)\)</span>ï¼Œé€šå¸¸æ¥è¯´å½“<span class="arithmatex">\(n\)</span>å°äº10000 æ—¶è¿˜æ˜¯å¯ä»¥æ¥å—çš„</td>
</tr>
<tr>
<td>é€‚ç”¨äºå„ç§ç±»å‹çš„æ¨¡å‹</td>
<td>åªé€‚ç”¨äºçº¿æ€§æ¨¡å‹ï¼Œä¸é€‚åˆé€»è¾‘å›å½’æ¨¡å‹ç­‰å…¶ä»–æ¨¡å‹</td>
</tr>
</tbody>
</table>
<p>æ€»ç»“ä¸€ä¸‹ï¼Œåªè¦ç‰¹å¾å˜é‡çš„æ•°ç›®å¹¶ä¸å¤§ï¼Œæ ‡å‡†æ–¹ç¨‹æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„è®¡ç®—å‚æ•°$\theta $çš„æ›¿ä»£æ–¹æ³•ã€‚å…·ä½“åœ°è¯´ï¼Œ<strong>åªè¦ç‰¹å¾å˜é‡æ•°é‡å°äºä¸€ä¸‡ï¼Œæˆ‘é€šå¸¸ä½¿ç”¨æ­£è§„æ–¹ç¨‹æ³•ï¼Œè€Œä¸ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•ã€‚</strong></p>
<p>éšç€æˆ‘ä»¬è¦è®²çš„å­¦ä¹ ç®—æ³•è¶Šæ¥è¶Šå¤æ‚ï¼Œä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬è®²åˆ°åˆ†ç±»ç®—æ³•ï¼Œåƒé€»è¾‘å›å½’ç®—æ³•ï¼Œæˆ‘ä»¬ä¼šçœ‹åˆ°ï¼Œå®é™…ä¸Šå¯¹äºé‚£äº›ç®—æ³•ï¼Œå¹¶ä¸èƒ½ä½¿ç”¨æ ‡å‡†æ–¹ç¨‹æ³•ã€‚å¯¹äºé‚£äº›æ›´å¤æ‚çš„å­¦ä¹ ç®—æ³•ï¼Œæˆ‘ä»¬å°†ä¸å¾—ä¸ä»ç„¶ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ³•ã€‚å› æ­¤ï¼Œæ¢¯åº¦ä¸‹é™æ³•æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„ç®—æ³•ï¼Œå¯ä»¥ç”¨åœ¨æœ‰å¤§é‡ç‰¹å¾å˜é‡çš„çº¿æ€§å›å½’é—®é¢˜ã€‚æˆ–è€…æˆ‘ä»¬ä»¥ååœ¨è¯¾ç¨‹ä¸­ï¼Œä¼šè®²åˆ°çš„ä¸€äº›å…¶ä»–çš„ç®—æ³•ï¼Œå› ä¸ºæ ‡å‡†æ–¹ç¨‹æ³•ä¸é€‚åˆæˆ–è€…ä¸èƒ½ç”¨åœ¨å®ƒä»¬ä¸Šã€‚ä½†å¯¹äºè¿™ä¸ªç‰¹å®šçš„çº¿æ€§å›å½’æ¨¡å‹ï¼Œæ ‡å‡†æ–¹ç¨‹æ³•æ˜¯ä¸€ä¸ªæ¯”æ¢¯åº¦ä¸‹é™æ³•æ›´å¿«çš„æ›¿ä»£ç®—æ³•ã€‚æ‰€ä»¥ï¼Œæ ¹æ®å…·ä½“çš„é—®é¢˜ï¼Œä»¥åŠä½ çš„ç‰¹å¾å˜é‡çš„æ•°é‡ï¼Œè¿™ä¸¤ç§ç®—æ³•éƒ½æ˜¯å€¼å¾—å­¦ä¹ çš„ã€‚</p>
<p>æ­£è§„æ–¹ç¨‹çš„<strong>python</strong>å®ç°ï¼š</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a> <span class="k">def</span> <span class="nf">normalEqn</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>   <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">T</span><span class="nd">@X</span><span class="p">)</span><span class="nd">@X</span><span class="o">.</span><span class="n">T</span><span class="nd">@y</span> <span class="c1">#X.T@Xç­‰ä»·äºX.T.dot(X)</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>   <span class="k">return</span> <span class="n">theta</span>
</code></pre></div>
<p><br>
<br>
<br></p>
<div class="admonition info">
<p><strong>ä»¥ä¸‹æ˜¯æ­£è§„æ–¹ç¨‹è‹±æ–‡ç‰ˆ(æœ‰è¯¦ç»†æ¨å¯¼-è‡ªå·±åŠ ä¸Šçš„)ï¼Œå…¶ä»–å†…å®¹æ¥æºäº2006å¹´éº»çœç†å·¥cs 2009æœºå™¨å­¦ä¹ çš„noteã€‚</strong></p>
</div>
<h2 id="7-the-normal-equations">7. The normal equations</h2>
<!--
ä¸‹é¢è¿™ä¸ªcssç”¨äºæ§åˆ¶pæ ‡ç­¾çš„ä¸¤ç«¯å¯¹é½
-->
<style type="text/css">
p {
    text-align: justify;  /*æ–‡æœ¬ä¸¤ç«¯å¯¹é½*/
}
</style>

<p>Gradient descent gives one way of minimizing <span class="arithmatex">\(J\)</span>. Lets discuss a second way of doing so, this time performing the minimization explicitly and without resorting to an iterative algorithm. In this method, we will minimize <span class="arithmatex">\(J\)</span> by explicitly taking its derivatives with respect to the <span class="arithmatex">\(Î¸_j's\)</span>, and setting them to zero. To enable us to do this without having to write reams of algebra and pages full of matrices of derivatives, lets introduce some notation for doing calculus with matrices. </p>
<h3 id="71-matrix-derivatives">7.1 Matrix derivatives</h3>
<p>For a function <span class="arithmatex">\(f\)</span> : <span class="arithmatex">\(\mathbb{R^{m\times n}} \rightarrow \mathbb{R}\)</span> mapping from <span class="arithmatex">\(\text{m-by-n}\)</span> matrices to the real numbers, we define the derivative of f with respect to A to be:</p>
<div class="arithmatex">\[
\nabla _Af(A)=\begin{bmatrix} \frac{\partial f}{\partial A_{11}} &amp; \cdots  &amp; \frac{\partial f}{\partial A_{1n}} \\\\ 
\vdots  &amp; \ddots &amp; \vdots \\\\
\frac{\partial f}{\partial A_{m1}} &amp; \cdots  &amp; \frac{\partial f}{\partial A_{mn}}\end{bmatrix}
\]</div>
<p>Thus, the gradient <span class="arithmatex">\(\nabla _Af(A)\)</span> is itself an <span class="arithmatex">\(\text{m-by-n}\)</span>  matrix, whose <span class="arithmatex">\((i,j)\)</span>-element is <span class="arithmatex">\(\frac{\partial f}{\partial A_{ij}}\)</span>. For example, suppose <span class="arithmatex">\(A =\bigl( \begin{smallmatrix} A_{11}  &amp; A_{12} \\ A_{21} &amp; A_{22} \end{smallmatrix} \bigr)\)</span> is a 2-by-2 matrix, and the function <span class="arithmatex">\(f\)</span>: <span class="arithmatex">\(\mathbb{R^{2\times 2}}\rightarrow \mathbb{R}\)</span> is given by</p>
<div class="arithmatex">\[
f(A)=\frac{3}{2}A_{11}+5A_{12}^2+A_{21}A_{22}
\]</div>
<p>Here, <span class="arithmatex">\(A_{ij}\)</span> denotes the <span class="arithmatex">\((i,j)\)</span> entry of the matrix <span class="arithmatex">\(A\)</span>. We then have</p>
<div class="arithmatex">\[
\nabla _Af(A)=\begin{bmatrix} 
\frac{3}{2} &amp; 10A_{12}\\\\
A_{22} &amp; A_{21}
\end{bmatrix}
\]</div>
<p>&ensp; We also introduce the <strong>trace</strong> opertator, written by "tr.". For an <span class="arithmatex">\(\text{n-by-n}\)</span> (square) matrix A, the trace of A is defined to be the sum of its diagonal entries:</p>
<div class="arithmatex">\[
\operatorname{tr}A=\sum_{i=1}^nA_{ii}
\]</div>
<p>If <span class="arithmatex">\(a\)</span> is a real number (i.e., a 1-by-1 matrix), then <span class="arithmatex">\(\operatorname{tr} a = a\)</span>. (If you haven't seen this "opertator notation" before, you should think of the trace of <span class="arithmatex">\(A\)</span> as <span class="arithmatex">\(\operatorname{tr}(A)\)</span>, or as application of the "trace" function to the matrix <span class="arithmatex">\(A\)</span>. It's more commonly written without the parentheses, however.ï¼‰
&ensp; The trace opertator has the property that for two matrices <span class="arithmatex">\(A\)</span> and <span class="arithmatex">\(B\)</span> such that <span class="arithmatex">\(AB\)</span> is square, we have that <span class="arithmatex">\(\operatorname{tr}(AB)=\operatorname{tr}(BA)\)</span>. <a href="../../math in ML/2. M derivation/#25">è¯æ˜è¯·æŸ¥çœ‹æœºå™¨å­¦ä¹ ä¸­çš„æ•°å­¦çŸ¥è¯†ä¸­å…³äºè¿¹çš„äº¤æ¢å¾‹çš„è¯æ˜ã€‚</a> As corollaries of this, we also have, e.g.,</p>
<div class="arithmatex">\[ \operatorname{tr}(ABC)=\operatorname{tr}(CAB)=\operatorname{tr}(BCA)\]</div>
<div class="arithmatex">\[ \operatorname{tr}(ABCD)=\operatorname{tr}(DABC)=\operatorname{tr}(CDAB)=\operatorname{tr}(BCDA)\]</div>
<p>The following properties of the trace operator are also easily verified. Here, <span class="arithmatex">\(A\)</span> and <span class="arithmatex">\(B\)</span> are square matrices, and <span class="arithmatex">\(a\)</span> is a real number:</p>
<div class="arithmatex">\[ \operatorname{tr}(A) = \operatorname{tr}(A^T)\]</div>
<div class="arithmatex">\[ \operatorname{tr}(A+B) = \operatorname{tr}(A)+\operatorname{tr}(B)\]</div>
<div class="arithmatex">\[ \operatorname{tr}(aA) = a \operatorname{tr}(A)\]</div>
<p>&ensp; We now state without proof some facts of matrix derivatives (we wonâ€™t need some of these until later this quarter). Equation (4) applies only to non-singular square matrices A, where |A| denotes the determinant of A. We have:</p>
<div class="arithmatex">\[ \nabla_A \operatorname{tr}(AB)=B^T\\\\ \tag{1}\]</div>
<div class="arithmatex">\[ \nabla_{A^T}f(A) = \big(\nabla_Af(A)\big)^T \\\\\tag{2}\]</div>
<div class="arithmatex">\[ \nabla_A \operatorname{tr}ABA^TC=CAB+C^TAB^T \\\\\tag{3} \]</div>
<div class="arithmatex">\[\nabla_A|A|=|A|(A^{-1})^T\\\\\tag{4}\]</div>
<hr />
<p>å´æ©è¾¾è€å¸ˆä¸ç»™ä½ ä»¬è¯æ˜ï¼Œæˆ‘æ¥ç»™ä½ ä»¬è¯æ˜<img alt="ğŸ˜" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/1f60e.svg" title=":sunglasses:" /></p>
<p>è¯·åœ¨çœ‹ä¸‹é¢æ¨å¯¼ä¹‹å‰, åŠ¡å¿…å…ˆçœ‹æ‡‚æˆ‘è¿™ä¸ªçŸ¥è¯†åº“ä¸­<strong>æœºå™¨å­¦ä¹ ä¸­çš„æ•°å­¦çŸ¥è¯†</strong>&ensp;---&ensp;( <strong>ä¸€. çŸ©é˜µæ±‚å¯¼æœ¬è´¨ &amp;äºŒ. çŸ©é˜µæ±‚å¯¼</strong>)ã€‚</p>
<p><img alt="2_7_1" src="../../assets/images/2_7_1.png" /></p>
<p>I. <span class="arithmatex">\(\nabla_A \operatorname{tr}(AB)=B^T\)</span></p>
<p><strong>è¯æ˜:</strong></p>
<p>ç”± <a href="../../math in ML/2. M derivation/#24">äºŒ.çŸ©é˜µæ±‚å¯¼ä¸­---(6)å¼çš„è¯æ˜</a> æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š</p>
<p>å¯¹äºä¸¤ä¸ªé˜¶æ•°éƒ½æ˜¯ <span class="arithmatex">\(m \times n\)</span> çš„çŸ©é˜µ <span class="arithmatex">\(C_{m \times n}, D_{m \times n}\)</span> å…¶ä¸­<strong>ä¸€ä¸ªçŸ©é˜µä¹˜ä»¥ï¼ˆå·¦ä¹˜å³ä¹˜éƒ½å¯ä»¥ï¼‰å¦ä¸€ä¸ªçŸ©é˜µçš„ <mark>è½¬ç½®</mark> çš„è¿¹ï¼Œæœ¬è´¨æ˜¯ <span class="arithmatex">\(C_{m \times n}, D_{m \times n}\)</span> ä¸¤ä¸ªçŸ©é˜µå¯¹åº”ä½ç½®çš„å…ƒç´ ç›¸ä¹˜å¹¶ç›¸åŠ </strong>ã€‚</p>
<p>æ‰€ä»¥è¿™é‡Œ <span class="arithmatex">\(\operatorname{tr}(AB)\)</span> ç›¸å½“äºå°±æ˜¯ <span class="arithmatex">\(A\)</span> å’Œ <span class="arithmatex">\(B^T\)</span>  æ¯ä¸€ä¸ªä½ç½®å¯¹åº”å…ƒç´  <mark>ç›¸ä¹˜å¹¶ç›¸åŠ </mark> ã€‚
å…¶ä¸­, <span class="arithmatex">\(A_{m \times n}, B_{n \times m}\)</span>ã€‚</p>
<p>æ¥ç€, ç”± <a href="../../math in ML/1. M derivation essence/#23_1">äºŒ.çŸ©é˜µæ±‚å¯¼æœ¬è´¨---(11)å¼</a> æˆ‘ä»¬å¯ä»¥çŸ¥é“:</p>
<p>è¿™é‡Œæ±‚ <span class="arithmatex">\(\nabla_A \operatorname{tr}(AB)\)</span> ç›¸å½“äº <span class="arithmatex">\(\operatorname{tr}(AB)\)</span> æŒ‰ç…§ <span class="arithmatex">\(A\)</span> çŸ©é˜µåˆ†å¸ƒçš„æ¯ä¸ªä½ç½®å…ƒç´ æ±‚åå¯¼ã€‚</p>
<p>æ‰€ä»¥, ç»¼ä¸Šæ‰€è¿°, <span class="arithmatex">\(\nabla_A \operatorname{tr}(AB)=B^T\)</span>ã€‚</p>
<p><strong>è¯æ¯•ã€‚</strong></p>
<p>II. <span class="arithmatex">\(\nabla_{A^T}f(A) = \big(\nabla_Af(A)\big)^T\)</span></p>
<p><strong>è¯æ˜:</strong></p>
<p>ç”± <a href="../../math in ML/1. M derivation essence/#23_1">äºŒ.çŸ©é˜µæ±‚å¯¼æœ¬è´¨---(11)å¼</a> å¯çŸ¥:</p>
<div class="arithmatex">\[
\begin{align}
\nabla_{A^T}f(A) &amp;=
\begin{bmatrix} \frac{\partial f}{\partial a_{11}} &amp; \cdots  &amp; \frac{\partial f}{\partial a_{m1}} 
\\ \vdots &amp; \ddots &amp; \vdots 
\\ \frac{\partial f}{\partial x_{1n}} &amp; \cdots &amp; \frac{\partial f}{\partial x_{mn}} \\
\end{bmatrix}\\\\
 &amp; = \begin{bmatrix} \frac{\partial f}{\partial a_{11}} &amp; \cdots  &amp; \frac{\partial f}{\partial a_{1n}} 
\\ \vdots &amp; \ddots &amp; \vdots 
\\ \frac{\partial f}{\partial x_{m1}} &amp; \cdots &amp; \frac{\partial f}{\partial x_{mn}} \\
\end{bmatrix}\\\\
 &amp; = \big(\nabla_Af(A)\big)^T
\end{align}
\]</div>
<p><strong>è¯æ¯•ã€‚</strong></p>
<p>III. <span class="arithmatex">\(\nabla_A \operatorname{tr}ABA^TC=CAB+C^TAB^T\)</span></p>
<p><strong>è¯æ˜:</strong></p>
<p>é¦–å…ˆ, æˆ‘ä»¬è¦æ˜ç¡®è¿™é‡Œçš„ <span class="arithmatex">\(ABA^TC\)</span> æ˜¯å…³äº <span class="arithmatex">\(A\)</span> çŸ©é˜µçš„å®å€¼æ ‡é‡å‡½æ•°, æ‰€ä»¥, æˆ‘ä»¬å¯ä»¥ä»¤ <span class="arithmatex">\(f(A)=ABA^TC\)</span>ã€‚</p>
<div class="admonition note">
<p><strong>æ³¨æ„:</strong> è¿™é‡Œçš„æ ‡è®°, ç”±äº <span class="arithmatex">\(A\)</span> å…¶å®æ˜¯çŸ©é˜µå˜å…ƒ, åº”è¯¥æ ‡è®°ä¸º <span class="arithmatex">\(f(\pmb A)=\pmb A B \pmb A^TC\)</span>, æ‰€ä»¥åé¢çš„æ¨å¯¼è¿‡ç¨‹,æˆ‘ä»¬ä¸¥è°¨ä¸€äº›, å°†çŸ©é˜µå˜å…ƒ <span class="arithmatex">\(A\)</span> æ ‡è®°ä¸º <span class="arithmatex">\(\pmb A\)</span>ã€‚</p>
</div>
<p>ä»”ç»†æƒ³ä½ ä¼šå‘ç°ï¼Œå¯¹äºå®å€¼æ ‡é‡å‡½æ•° <span class="arithmatex">\(f (\pmb{A})\)</span>, <span class="arithmatex">\(\operatorname{tr}\big( f(\pmb A) \big)=f(\pmb A)\)</span> , <span class="arithmatex">\(\mathbb{d}f(\pmb A)=\operatorname{tr}\big( \mathbb{d}f(\pmb A) \big)\)</span></p>
<p>æ‰€ä»¥æœ‰ <span class="arithmatex">\(\mathbb{d}f(\pmb A)=\mathbb{d}\big(\operatorname{tr}f(\pmb A)\big)=\operatorname{tr}\big( \mathbb{d}f(\pmb A) \big)\)</span> ã€‚</p>
<p>ç”± <a href="../../math in ML/2. M derivation/#32_1">äºŒ.çŸ©é˜µæ±‚å¯¼æœ¬è´¨---(24)å¼</a> å³:</p>
<div class="arithmatex">\[
\mathbb{d}f(\pmb{X})= \operatorname{tr}\Big(\frac{\partial f(\pmb{X})}{\partial \pmb{X}^T}\mathbb{d}\pmb{X}\Big)
\]</div>
<p>æˆ‘ä»¬å¯ä»¥æŠŠä¸€ä¸ªçŸ©é˜µå˜å…ƒçš„å®å€¼æ ‡é‡å‡½æ•°çš„å…¨å¾®åˆ†å†™æˆä¸Šå¼ï¼Œæˆ‘ä»¬å°±æ‰¾åˆ°äº†çŸ©é˜µæ±‚å¯¼çš„ç»“æœ, ä¹Ÿå³: </p>
<div class="arithmatex">\[
\mathbb{d}f(\pmb{A})= \operatorname{tr}\Big(\frac{\partial f(\pmb{A})}{\partial \pmb{A}^T}\mathbb{d}\pmb{A}\Big)\\\\
\tag{II.1}
\]</div>
<p>ç”±æˆ‘ä»¬è¯æ˜çš„ II. <span class="arithmatex">\(\nabla_{A^T}f(A) = \big(\nabla_Af(A)\big)^T\)</span>å¾—:</p>
<div class="arithmatex">\[
\frac{\partial f(\pmb{A})}{\partial \pmb{A}^T} = \nabla _{\pmb A^T}f(\pmb A)=\big(\nabla _{\pmb A}f(\pmb A)\big)^T
\]</div>
<p>æ‰€ä»¥æˆ‘ä»¬è¦æ±‚çš„:</p>
<div class="arithmatex">\[
\nabla _{\pmb A}f(\pmb A)=\Big(\frac{\partial f(\pmb{A})}{\partial \pmb{A}^T}\Big)^T \\\\
\tag{II.2}
\]</div>
<p>æœ€ç»ˆæˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯è½¬åŒ–ä¸ºæ±‚ <span class="arithmatex">\(\mathbb{d}f(\pmb{A})\)</span> çš„å…¨å¾®åˆ†, ä¸‹é¢å¼€å§‹æ¨å¯¼ï¼š</p>
<div class="arithmatex">\[
\begin{aligned}
\mathbb{d}f(\pmb{A}) &amp; = \mathbb{d}\pmb A B \pmb A^TC \\\\
 &amp; = \mathbb{d}\operatorname{tr}(\pmb A B \pmb A^TC)\\\\
 &amp; = \mathbb{d}\operatorname{tr}(C \pmb A B \pmb A^T)\\\\
 &amp; = \operatorname{tr}\mathbb{d}(C \pmb A B \pmb A^T)\\\\
 &amp; = \operatorname{tr}\Big(\mathbb{d}(C \pmb A) B \pmb A^T +  C \pmb A \mathbb{d}(B \pmb A^T)\Big)\\\\
 &amp; = \operatorname{tr}\Big(C(\mathbb{d}\pmb A) B \pmb A^T +  C \pmb A B \mathbb{d}\pmb A^T\Big)\\\\
 &amp; = \operatorname{tr}\Big(B \pmb A^T C\mathbb{d}\pmb A \Big) + \operatorname{tr}\Big( C \pmb A B \mathbb{d}\pmb A^T\Big)\\\\
 &amp; = \operatorname{tr}\Big(B \pmb A^T C\mathbb{d}\pmb A \Big) + \operatorname{tr}\Big( C \pmb A B (\mathbb{d}\pmb A)^T\Big)\\\\
 &amp; = \operatorname{tr}\Big(B \pmb A^T C\mathbb{d}\pmb A \Big) + \operatorname{tr}\Big(\mathbb{d}\pmb A (B^T \pmb A^T C^T )\Big)\\\\
 &amp; = \operatorname{tr}\Big(B \pmb A^T C\mathbb{d}\pmb A \Big) + \operatorname{tr}\Big( B^T\pmb A^T C^T  \mathbb{d}\pmb A\Big)\\\\
 &amp; = \operatorname{tr}\Big[(B \pmb A^T C + B^T\pmb A^T C^T) \mathbb{d}\pmb A\Big]\\\\
\end{aligned}
\]</div>
<blockquote>
<p>æ•°å­—æ˜¯æ­¥éª¤ æ±‰å­—æ˜¯æ¯ä¸€æ­¥ä¾æ® <br>
01 -&gt; 02 å®å€¼æ ‡é‡å‡½æ•°çš„æ€§è´¨ <br>
02 -&gt; 03 è¿¹çš„äº¤æ¢å¾‹ <br>
03 -&gt; 04 å®å€¼æ ‡é‡å‡½æ•°çš„æ€§è´¨ <br>
04 -&gt; 05 çŸ©é˜µå¾®åˆ†çš„ä¹˜ç§¯æ³•åˆ™ <br>
05 -&gt; 06 å¤¹å±‚é¥¼ <br>
06 -&gt; 07 è¿¹çš„çº¿æ€§æ³•åˆ™, è¿¹çš„äº¤æ¢å¾‹ <br>
07 -&gt; 08 çŸ©é˜µå¾®åˆ†çš„è½¬ç½®æ³•åˆ™ <br>
08 -&gt; 09 è½¬ç½®çš„è¿¹ç­‰äºåŸçŸ©é˜µçš„è¿¹ <br>
09 -&gt; 10 è¿¹çš„äº¤æ¢å¾‹ <br>
10 -&gt; 11 è¿¹çš„çº¿æ€§æ³•åˆ™ <br></p>
</blockquote>
<p>ç»“åˆå‰é¢çš„ <span class="arithmatex">\((II.1)\)</span> å¼å¯å¾—:</p>
<div class="arithmatex">\[
\frac{\partial f(\pmb{A})}{\partial \pmb{A}^T}=B \pmb A^T C + B^T\pmb A^T C^T
\]</div>
<p>å†ç»“åˆå‰é¢çš„ <span class="arithmatex">\((II.1)\)</span> å¼å¯å¾—:</p>
<div class="arithmatex">\[
\begin{aligned}
\nabla _{\pmb A}f(\pmb A) &amp; = \Big(\frac{\partial f(\pmb{A})}{\partial \pmb{A}^T}\Big)^T \\\\
&amp; = (B \pmb A^T C + B^T\pmb A^T C^T)^T\\\\
&amp; = C^T \pmb A B^T + C \pmb A B 
\end{aligned}
\]</div>
<p><strong>è¯æ¯•ã€‚</strong></p>
<p>IV. <span class="arithmatex">\(\nabla_A|A|=|A|(A^{-1})^T\\\\\)</span></p>
<p><strong>è¯æ˜:</strong></p>
<p>ç”± <a href="../../math in ML/2. M derivation/#322">çŸ©é˜µè¡Œåˆ—å¼å¾®åˆ† å³(25.2.1)å¼</a>çš„è¯æ˜å¯çŸ¥:</p>
<div class="arithmatex">\[
\mathbb{d} |\pmb A| = \operatorname{tr}(|\pmb A|\pmb A^{-1}\mathbb{d}\pmb A)
\]</div>
<p>å†ç”± <a href="../../math in ML/2. M derivation/#32_1">äºŒ.çŸ©é˜µæ±‚å¯¼æœ¬è´¨---(24)å¼</a>å¯å¾—ï¼š</p>
<div class="arithmatex">\[
\frac{\partial |\pmb A|}{\partial \pmb A^T}=|\pmb A|\pmb A^{-1}
\]</div>
<p>å› æ­¤,</p>
<div class="arithmatex">\[
\begin{aligned}
\nabla _{\pmb A}|\pmb A| &amp; = (\frac{\partial |\pmb A|}{\partial \pmb A^T})^T \\\\
&amp;=(|\pmb A|\pmb A^{-1})^T\\\\
&amp;=|\pmb A|(\pmb A^{-1})^T
\end{aligned}
\]</div>
<p><strong>è¯æ¯•ã€‚</strong></p>

              
            </article>
          </div>
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" data-md-state="hidden">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg>
            å›åˆ°é¡µé¢é¡¶éƒ¨
          </a>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="é¡µè„š">
      
        
        <a href="../1.%20linear%20regression-1%20v/" class="md-footer__link md-footer__link--prev" aria-label="ä¸Šä¸€é¡µ: ä¸€. å•å˜é‡çº¿æ€§å›å½’" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                ä¸Šä¸€é¡µ
              </span>
              ä¸€. å•å˜é‡çº¿æ€§å›å½’
            </div>
          </div>
        </a>
      
      
        
        <a href="../../math%20in%20ML/" class="md-footer__link md-footer__link--next" aria-label="ä¸‹ä¸€é¡µ: å‰è¨€å’Œç›®å½•" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                ä¸‹ä¸€é¡µ
              </span>
              å‰è¨€å’Œç›®å½•
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.top"], "search": "../../assets/javascripts/workers/search.5e67fbfe.min.js", "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version.title": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.c44cc438.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>